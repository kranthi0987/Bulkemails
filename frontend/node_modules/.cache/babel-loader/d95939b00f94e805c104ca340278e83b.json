{"ast":null,"code":"/*!\n * FilePond 4.7.4\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) : typeof define === 'function' && define.amd ? define(['exports'], factory) : (global = global || self, factory(global.FilePond = {}));\n})(this, function (exports) {\n  'use strict';\n\n  var isNode = function isNode(value) {\n    return value instanceof HTMLElement;\n  };\n\n  var createStore = function createStore(initialState) {\n    var queries = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var actions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : []; // internal state\n\n    var state = Object.assign({}, initialState); // contains all actions for next frame, is clear when actions are requested\n\n    var actionQueue = [];\n    var dispatchQueue = []; // returns a duplicate of the current state\n\n    var getState = function getState() {\n      return Object.assign({}, state);\n    }; // returns a duplicate of the actions array and clears the actions array\n\n\n    var processActionQueue = function processActionQueue() {\n      // create copy of actions queue\n      var queue = [].concat(actionQueue); // clear actions queue (we don't want no double actions)\n\n      actionQueue.length = 0;\n      return queue;\n    }; // processes actions that might block the main UI thread\n\n\n    var processDispatchQueue = function processDispatchQueue() {\n      // create copy of actions queue\n      var queue = [].concat(dispatchQueue); // clear actions queue (we don't want no double actions)\n\n      dispatchQueue.length = 0; // now dispatch these actions\n\n      queue.forEach(function (_ref) {\n        var type = _ref.type,\n            data = _ref.data;\n        dispatch(type, data);\n      });\n    }; // adds a new action, calls its handler and\n\n\n    var dispatch = function dispatch(type, data, isBlocking) {\n      // is blocking action\n      if (isBlocking) {\n        dispatchQueue.push({\n          type: type,\n          data: data\n        });\n        return;\n      } // if this action has a handler, handle the action\n\n\n      if (actionHandlers[type]) {\n        actionHandlers[type](data);\n      } // now add action\n\n\n      actionQueue.push({\n        type: type,\n        data: data\n      });\n    };\n\n    var query = function query(str) {\n      var _queryHandles;\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return queryHandles[str] ? (_queryHandles = queryHandles)[str].apply(_queryHandles, args) : null;\n    };\n\n    var api = {\n      getState: getState,\n      processActionQueue: processActionQueue,\n      processDispatchQueue: processDispatchQueue,\n      dispatch: dispatch,\n      query: query\n    };\n    var queryHandles = {};\n    queries.forEach(function (query) {\n      queryHandles = Object.assign({}, query(state), {}, queryHandles);\n    });\n    var actionHandlers = {};\n    actions.forEach(function (action) {\n      actionHandlers = Object.assign({}, action(dispatch, query, state), {}, actionHandlers);\n    });\n    return api;\n  };\n\n  var defineProperty = function defineProperty(obj, property, definition) {\n    if (typeof definition === 'function') {\n      obj[property] = definition;\n      return;\n    }\n\n    Object.defineProperty(obj, property, Object.assign({}, definition));\n  };\n\n  var forin = function forin(obj, cb) {\n    for (var key in obj) {\n      if (!obj.hasOwnProperty(key)) {\n        continue;\n      }\n\n      cb(key, obj[key]);\n    }\n  };\n\n  var createObject = function createObject(definition) {\n    var obj = {};\n    forin(definition, function (property) {\n      defineProperty(obj, property, definition[property]);\n    });\n    return obj;\n  };\n\n  var attr = function attr(node, name) {\n    var value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n    if (value === null) {\n      return node.getAttribute(name) || node.hasAttribute(name);\n    }\n\n    node.setAttribute(name, value);\n  };\n\n  var ns = 'http://www.w3.org/2000/svg';\n  var svgElements = ['svg', 'path']; // only svg elements used\n\n  var isSVGElement = function isSVGElement(tag) {\n    return svgElements.includes(tag);\n  };\n\n  var createElement = function createElement(tag, className) {\n    var attributes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (typeof className === 'object') {\n      attributes = className;\n      className = null;\n    }\n\n    var element = isSVGElement(tag) ? document.createElementNS(ns, tag) : document.createElement(tag);\n\n    if (className) {\n      if (isSVGElement(tag)) {\n        attr(element, 'class', className);\n      } else {\n        element.className = className;\n      }\n    }\n\n    forin(attributes, function (name, value) {\n      attr(element, name, value);\n    });\n    return element;\n  };\n\n  var appendChild = function appendChild(parent) {\n    return function (child, index) {\n      if (typeof index !== 'undefined' && parent.children[index]) {\n        parent.insertBefore(child, parent.children[index]);\n      } else {\n        parent.appendChild(child);\n      }\n    };\n  };\n\n  var appendChildView = function appendChildView(parent, childViews) {\n    return function (view, index) {\n      if (typeof index !== 'undefined') {\n        childViews.splice(index, 0, view);\n      } else {\n        childViews.push(view);\n      }\n\n      return view;\n    };\n  };\n\n  var removeChildView = function removeChildView(parent, childViews) {\n    return function (view) {\n      // remove from child views\n      childViews.splice(childViews.indexOf(view), 1); // remove the element\n\n      if (view.element.parentNode) {\n        parent.removeChild(view.element);\n      }\n\n      return view;\n    };\n  };\n\n  var getViewRect = function getViewRect(elementRect, childViews, offset, scale) {\n    var left = offset[0] || elementRect.left;\n    var top = offset[1] || elementRect.top;\n    var right = left + elementRect.width;\n    var bottom = top + elementRect.height * (scale[1] || 1);\n    var rect = {\n      // the rectangle of the element itself\n      element: Object.assign({}, elementRect),\n      // the rectangle of the element expanded to contain its children, does not include any margins\n      inner: {\n        left: elementRect.left,\n        top: elementRect.top,\n        right: elementRect.right,\n        bottom: elementRect.bottom\n      },\n      // the rectangle of the element expanded to contain its children including own margin and child margins\n      // margins will be added after we've recalculated the size\n      outer: {\n        left: left,\n        top: top,\n        right: right,\n        bottom: bottom\n      }\n    }; // expand rect to fit all child rectangles\n\n    childViews.filter(function (childView) {\n      return !childView.isRectIgnored();\n    }).map(function (childView) {\n      return childView.rect;\n    }).forEach(function (childViewRect) {\n      expandRect(rect.inner, Object.assign({}, childViewRect.inner));\n      expandRect(rect.outer, Object.assign({}, childViewRect.outer));\n    }); // calculate inner width and height\n\n    calculateRectSize(rect.inner); // append additional margin (top and left margins are included in top and left automatically)\n\n    rect.outer.bottom += rect.element.marginBottom;\n    rect.outer.right += rect.element.marginRight; // calculate outer width and height\n\n    calculateRectSize(rect.outer);\n    return rect;\n  };\n\n  var expandRect = function expandRect(parent, child) {\n    // adjust for parent offset\n    child.top += parent.top;\n    child.right += parent.left;\n    child.bottom += parent.top;\n    child.left += parent.left;\n\n    if (child.bottom > parent.bottom) {\n      parent.bottom = child.bottom;\n    }\n\n    if (child.right > parent.right) {\n      parent.right = child.right;\n    }\n  };\n\n  var calculateRectSize = function calculateRectSize(rect) {\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n  };\n\n  var isNumber = function isNumber(value) {\n    return typeof value === 'number';\n  };\n  /**\n   * Determines if position is at destination\n   * @param position\n   * @param destination\n   * @param velocity\n   * @param errorMargin\n   * @returns {boolean}\n   */\n\n\n  var thereYet = function thereYet(position, destination, velocity) {\n    var errorMargin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.001;\n    return Math.abs(position - destination) < errorMargin && Math.abs(velocity) < errorMargin;\n  };\n  /**\n   * Spring animation\n   */\n\n\n  var spring = // default options\n  function spring() // method definition\n  {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$stiffness = _ref.stiffness,\n        stiffness = _ref$stiffness === void 0 ? 0.5 : _ref$stiffness,\n        _ref$damping = _ref.damping,\n        damping = _ref$damping === void 0 ? 0.75 : _ref$damping,\n        _ref$mass = _ref.mass,\n        mass = _ref$mass === void 0 ? 10 : _ref$mass;\n\n    var target = null;\n    var position = null;\n    var velocity = 0;\n    var resting = false; // updates spring state\n\n    var interpolate = function interpolate() {\n      // in rest, don't animate\n      if (resting) {\n        return;\n      } // need at least a target or position to do springy things\n\n\n      if (!(isNumber(target) && isNumber(position))) {\n        resting = true;\n        velocity = 0;\n        return;\n      } // calculate spring force\n\n\n      var f = -(position - target) * stiffness; // update velocity by adding force based on mass\n\n      velocity += f / mass; // update position by adding velocity\n\n      position += velocity; // slow down based on amount of damping\n\n      velocity *= damping; // we've arrived if we're near target and our velocity is near zero\n\n      if (thereYet(position, target, velocity)) {\n        position = target;\n        velocity = 0;\n        resting = true; // we done\n\n        api.onupdate(position);\n        api.oncomplete(position);\n      } else {\n        // progress update\n        api.onupdate(position);\n      }\n    };\n    /**\n     * Set new target value\n     * @param value\n     */\n\n\n    var setTarget = function setTarget(value) {\n      // if currently has no position, set target and position to this value\n      if (isNumber(value) && !isNumber(position)) {\n        position = value;\n      } // next target value will not be animated to\n\n\n      if (target === null) {\n        target = value;\n        position = value;\n      } // let start moving to target\n\n\n      target = value; // already at target\n\n      if (position === target || typeof target === 'undefined') {\n        // now resting as target is current position, stop moving\n        resting = true;\n        velocity = 0; // done!\n\n        api.onupdate(position);\n        api.oncomplete(position);\n        return;\n      }\n\n      resting = false;\n    }; // need 'api' to call onupdate callback\n\n\n    var api = createObject({\n      interpolate: interpolate,\n      target: {\n        set: setTarget,\n        get: function get() {\n          return target;\n        }\n      },\n      resting: {\n        get: function get() {\n          return resting;\n        }\n      },\n      onupdate: function onupdate(value) {},\n      oncomplete: function oncomplete(value) {}\n    });\n    return api;\n  };\n\n  var easeLinear = function easeLinear(t) {\n    return t;\n  };\n\n  var easeInOutQuad = function easeInOutQuad(t) {\n    return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n  };\n\n  var tween = // default values\n  function tween() // method definition\n  {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$duration = _ref.duration,\n        duration = _ref$duration === void 0 ? 500 : _ref$duration,\n        _ref$easing = _ref.easing,\n        easing = _ref$easing === void 0 ? easeInOutQuad : _ref$easing,\n        _ref$delay = _ref.delay,\n        delay = _ref$delay === void 0 ? 0 : _ref$delay;\n\n    var start = null;\n    var t;\n    var p;\n    var resting = true;\n    var reverse = false;\n    var target = null;\n\n    var interpolate = function interpolate(ts) {\n      if (resting || target === null) {\n        return;\n      }\n\n      if (start === null) {\n        start = ts;\n      }\n\n      if (ts - start < delay) {\n        return;\n      }\n\n      t = ts - start - delay;\n\n      if (t < duration) {\n        p = t / duration;\n        api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);\n      } else {\n        t = 1;\n        p = reverse ? 0 : 1;\n        api.onupdate(p * target);\n        api.oncomplete(p * target);\n        resting = true;\n      }\n    }; // need 'api' to call onupdate callback\n\n\n    var api = createObject({\n      interpolate: interpolate,\n      target: {\n        get: function get() {\n          return reverse ? 0 : target;\n        },\n        set: function set(value) {\n          // is initial value\n          if (target === null) {\n            target = value;\n            api.onupdate(value);\n            api.oncomplete(value);\n            return;\n          } // want to tween to a smaller value and have a current value\n\n\n          if (value < target) {\n            target = 1;\n            reverse = true;\n          } else {\n            // not tweening to a smaller value\n            reverse = false;\n            target = value;\n          } // let's go!\n\n\n          resting = false;\n          start = null;\n        }\n      },\n      resting: {\n        get: function get() {\n          return resting;\n        }\n      },\n      onupdate: function onupdate(value) {},\n      oncomplete: function oncomplete(value) {}\n    });\n    return api;\n  };\n\n  var animator = {\n    spring: spring,\n    tween: tween\n  };\n  /*\n                       { type: 'spring', stiffness: .5, damping: .75, mass: 10 };\n                       { translation: { type: 'spring', ... }, ... }\n                       { translation: { x: { type: 'spring', ... } } }\n                      */\n\n  var createAnimator = function createAnimator(definition, category, property) {\n    // default is single definition\n    // we check if transform is set, if so, we check if property is set\n    var def = definition[category] && typeof definition[category][property] === 'object' ? definition[category][property] : definition[category] || definition;\n    var type = typeof def === 'string' ? def : def.type;\n    var props = typeof def === 'object' ? Object.assign({}, def) : {};\n    return animator[type] ? animator[type](props) : null;\n  };\n\n  var addGetSet = function addGetSet(keys, obj, props) {\n    var overwrite = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    obj = Array.isArray(obj) ? obj : [obj];\n    obj.forEach(function (o) {\n      keys.forEach(function (key) {\n        var name = key;\n\n        var getter = function getter() {\n          return props[key];\n        };\n\n        var setter = function setter(value) {\n          return props[key] = value;\n        };\n\n        if (typeof key === 'object') {\n          name = key.key;\n          getter = key.getter || getter;\n          setter = key.setter || setter;\n        }\n\n        if (o[name] && !overwrite) {\n          return;\n        }\n\n        o[name] = {\n          get: getter,\n          set: setter\n        };\n      });\n    });\n  };\n\n  var isDefined = function isDefined(value) {\n    return value != null;\n  }; // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // setup animators\n\n\n  var animations = function animations(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewInternalAPI = _ref.viewInternalAPI,\n        viewExternalAPI = _ref.viewExternalAPI,\n        viewState = _ref.viewState; // initial properties\n\n    var initialProps = Object.assign({}, viewProps); // list of all active animations\n\n    var animations = []; // setup animators\n\n    forin(mixinConfig, function (property, animation) {\n      var animator = createAnimator(animation);\n\n      if (!animator) {\n        return;\n      } // when the animator updates, update the view state value\n\n\n      animator.onupdate = function (value) {\n        viewProps[property] = value;\n      }; // set animator target\n\n\n      animator.target = initialProps[property]; // when value is set, set the animator target value\n\n      var prop = {\n        key: property,\n        setter: function setter(value) {\n          // if already at target, we done!\n          if (animator.target === value) {\n            return;\n          }\n\n          animator.target = value;\n        },\n        getter: function getter() {\n          return viewProps[property];\n        }\n      }; // add getters and setters\n\n      addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true); // add it to the list for easy updating from the _write method\n\n      animations.push(animator);\n    }); // expose internal write api\n\n    return {\n      write: function write(ts) {\n        var resting = true;\n        animations.forEach(function (animation) {\n          if (!animation.resting) {\n            resting = false;\n          }\n\n          animation.interpolate(ts);\n        });\n        return resting;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var addEvent = function addEvent(element) {\n    return function (type, fn) {\n      element.addEventListener(type, fn);\n    };\n  };\n\n  var removeEvent = function removeEvent(element) {\n    return function (type, fn) {\n      element.removeEventListener(type, fn);\n    };\n  }; // mixin\n\n\n  var listeners = function listeners(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewInternalAPI = _ref.viewInternalAPI,\n        viewExternalAPI = _ref.viewExternalAPI,\n        viewState = _ref.viewState,\n        view = _ref.view;\n    var events = [];\n    var add = addEvent(view.element);\n    var remove = removeEvent(view.element);\n\n    viewExternalAPI.on = function (type, fn) {\n      events.push({\n        type: type,\n        fn: fn\n      });\n      add(type, fn);\n    };\n\n    viewExternalAPI.off = function (type, fn) {\n      events.splice(events.findIndex(function (event) {\n        return event.type === type && event.fn === fn;\n      }), 1);\n      remove(type, fn);\n    };\n\n    return {\n      write: function write() {\n        // not busy\n        return true;\n      },\n      destroy: function destroy() {\n        events.forEach(function (event) {\n          remove(event.type, event.fn);\n        });\n      }\n    };\n  }; // add to external api and link to props\n\n\n  var apis = function apis(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewExternalAPI = _ref.viewExternalAPI;\n    addGetSet(mixinConfig, viewExternalAPI, viewProps);\n  }; // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // set initial state based on props in viewProps\n  // apply as transforms each frame\n\n\n  var defaults = {\n    opacity: 1,\n    scaleX: 1,\n    scaleY: 1,\n    translateX: 0,\n    translateY: 0,\n    rotateX: 0,\n    rotateY: 0,\n    rotateZ: 0,\n    originX: 0,\n    originY: 0\n  };\n\n  var styles = function styles(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n        viewProps = _ref.viewProps,\n        viewInternalAPI = _ref.viewInternalAPI,\n        viewExternalAPI = _ref.viewExternalAPI,\n        view = _ref.view; // initial props\n\n    var initialProps = Object.assign({}, viewProps); // current props\n\n    var currentProps = {}; // we will add those properties to the external API and link them to the viewState\n\n    addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps); // override rect on internal and external rect getter so it takes in account transforms\n\n    var getOffset = function getOffset() {\n      return [viewProps['translateX'] || 0, viewProps['translateY'] || 0];\n    };\n\n    var getScale = function getScale() {\n      return [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];\n    };\n\n    var getRect = function getRect() {\n      return view.rect ? getViewRect(view.rect, view.childViews, getOffset(), getScale()) : null;\n    };\n\n    viewInternalAPI.rect = {\n      get: getRect\n    };\n    viewExternalAPI.rect = {\n      get: getRect\n    }; // apply view props\n\n    mixinConfig.forEach(function (key) {\n      viewProps[key] = typeof initialProps[key] === 'undefined' ? defaults[key] : initialProps[key];\n    }); // expose api\n\n    return {\n      write: function write() {\n        // see if props have changed\n        if (!propsHaveChanged(currentProps, viewProps)) {\n          return;\n        } // moves element to correct position on screen\n\n\n        applyStyles(view.element, viewProps); // store new transforms\n\n        Object.assign(currentProps, Object.assign({}, viewProps)); // no longer busy\n\n        return true;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var propsHaveChanged = function propsHaveChanged(currentProps, newProps) {\n    // different amount of keys\n    if (Object.keys(currentProps).length !== Object.keys(newProps).length) {\n      return true;\n    } // lets analyze the individual props\n\n\n    for (var prop in newProps) {\n      if (newProps[prop] !== currentProps[prop]) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var applyStyles = function applyStyles(element, _ref2) {\n    var opacity = _ref2.opacity,\n        perspective = _ref2.perspective,\n        translateX = _ref2.translateX,\n        translateY = _ref2.translateY,\n        scaleX = _ref2.scaleX,\n        scaleY = _ref2.scaleY,\n        rotateX = _ref2.rotateX,\n        rotateY = _ref2.rotateY,\n        rotateZ = _ref2.rotateZ,\n        originX = _ref2.originX,\n        originY = _ref2.originY,\n        width = _ref2.width,\n        height = _ref2.height;\n    var transforms = '';\n    var styles = ''; // handle transform origin\n\n    if (isDefined(originX) || isDefined(originY)) {\n      styles += 'transform-origin: ' + (originX || 0) + 'px ' + (originY || 0) + 'px;';\n    } // transform order is relevant\n    // 0. perspective\n\n\n    if (isDefined(perspective)) {\n      transforms += 'perspective(' + perspective + 'px) ';\n    } // 1. translate\n\n\n    if (isDefined(translateX) || isDefined(translateY)) {\n      transforms += 'translate3d(' + (translateX || 0) + 'px, ' + (translateY || 0) + 'px, 0) ';\n    } // 2. scale\n\n\n    if (isDefined(scaleX) || isDefined(scaleY)) {\n      transforms += 'scale3d(' + (isDefined(scaleX) ? scaleX : 1) + ', ' + (isDefined(scaleY) ? scaleY : 1) + ', 1) ';\n    } // 3. rotate\n\n\n    if (isDefined(rotateZ)) {\n      transforms += 'rotateZ(' + rotateZ + 'rad) ';\n    }\n\n    if (isDefined(rotateX)) {\n      transforms += 'rotateX(' + rotateX + 'rad) ';\n    }\n\n    if (isDefined(rotateY)) {\n      transforms += 'rotateY(' + rotateY + 'rad) ';\n    } // add transforms\n\n\n    if (transforms.length) {\n      styles += 'transform:' + transforms + ';';\n    } // add opacity\n\n\n    if (isDefined(opacity)) {\n      styles += 'opacity:' + opacity + ';'; // if we reach zero, we make the element inaccessible\n\n      if (opacity === 0) {\n        styles += 'visibility:hidden;';\n      } // if we're below 100% opacity this element can't be clicked\n\n\n      if (opacity < 1) {\n        styles += 'pointer-events:none;';\n      }\n    } // add height\n\n\n    if (isDefined(height)) {\n      styles += 'height:' + height + 'px;';\n    } // add width\n\n\n    if (isDefined(width)) {\n      styles += 'width:' + width + 'px;';\n    } // apply styles\n\n\n    var elementCurrentStyle = element.elementCurrentStyle || ''; // if new styles does not match current styles, lets update!\n\n    if (styles.length !== elementCurrentStyle.length || styles !== elementCurrentStyle) {\n      element.style.cssText = styles; // store current styles so we can compare them to new styles later on\n      // _not_ getting the style value is faster\n\n      element.elementCurrentStyle = styles;\n    }\n  };\n\n  var Mixins = {\n    styles: styles,\n    listeners: listeners,\n    animations: animations,\n    apis: apis\n  };\n\n  var updateRect = function updateRect() {\n    var rect = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var element = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var style = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (!element.layoutCalculated) {\n      rect.paddingTop = parseInt(style.paddingTop, 10) || 0;\n      rect.marginTop = parseInt(style.marginTop, 10) || 0;\n      rect.marginRight = parseInt(style.marginRight, 10) || 0;\n      rect.marginBottom = parseInt(style.marginBottom, 10) || 0;\n      rect.marginLeft = parseInt(style.marginLeft, 10) || 0;\n      element.layoutCalculated = true;\n    }\n\n    rect.left = element.offsetLeft || 0;\n    rect.top = element.offsetTop || 0;\n    rect.width = element.offsetWidth || 0;\n    rect.height = element.offsetHeight || 0;\n    rect.right = rect.left + rect.width;\n    rect.bottom = rect.top + rect.height;\n    rect.scrollTop = element.scrollTop;\n    rect.hidden = element.offsetParent === null;\n    return rect;\n  };\n\n  var createView = // default view definition\n  function createView() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$tag = _ref.tag,\n        tag = _ref$tag === void 0 ? 'div' : _ref$tag,\n        _ref$name = _ref.name,\n        name = _ref$name === void 0 ? null : _ref$name,\n        _ref$attributes = _ref.attributes,\n        attributes = _ref$attributes === void 0 ? {} : _ref$attributes,\n        _ref$read = _ref.read,\n        read = _ref$read === void 0 ? function () {} : _ref$read,\n        _ref$write = _ref.write,\n        write = _ref$write === void 0 ? function () {} : _ref$write,\n        _ref$create = _ref.create,\n        create = _ref$create === void 0 ? function () {} : _ref$create,\n        _ref$destroy = _ref.destroy,\n        destroy = _ref$destroy === void 0 ? function () {} : _ref$destroy,\n        _ref$filterFrameActio = _ref.filterFrameActionsForChild,\n        filterFrameActionsForChild = _ref$filterFrameActio === void 0 ? function (child, actions) {\n      return actions;\n    } : _ref$filterFrameActio,\n        _ref$didCreateView = _ref.didCreateView,\n        didCreateView = _ref$didCreateView === void 0 ? function () {} : _ref$didCreateView,\n        _ref$didWriteView = _ref.didWriteView,\n        didWriteView = _ref$didWriteView === void 0 ? function () {} : _ref$didWriteView,\n        _ref$ignoreRect = _ref.ignoreRect,\n        ignoreRect = _ref$ignoreRect === void 0 ? false : _ref$ignoreRect,\n        _ref$ignoreRectUpdate = _ref.ignoreRectUpdate,\n        ignoreRectUpdate = _ref$ignoreRectUpdate === void 0 ? false : _ref$ignoreRectUpdate,\n        _ref$mixins = _ref.mixins,\n        mixins = _ref$mixins === void 0 ? [] : _ref$mixins;\n\n    return function ( // each view requires reference to store\n    store) {\n      var props = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {}; // root element should not be changed\n\n      var element = createElement(tag, 'filepond--' + name, attributes); // style reference should also not be changed\n\n      var style = window.getComputedStyle(element, null); // element rectangle\n\n      var rect = updateRect();\n      var frameRect = null; // rest state\n\n      var isResting = false; // pretty self explanatory\n\n      var childViews = []; // loaded mixins\n\n      var activeMixins = []; // references to created children\n\n      var ref = {}; // state used for each instance\n\n      var state = {}; // list of writers that will be called to update this view\n\n      var writers = [write // default writer\n      ];\n      var readers = [read // default reader\n      ];\n      var destroyers = [destroy // default destroy\n      ]; // core view methods\n\n      var getElement = function getElement() {\n        return element;\n      };\n\n      var getChildViews = function getChildViews() {\n        return childViews.concat();\n      };\n\n      var getReference = function getReference() {\n        return ref;\n      };\n\n      var createChildView = function createChildView(store) {\n        return function (view, props) {\n          return view(store, props);\n        };\n      };\n\n      var getRect = function getRect() {\n        if (frameRect) {\n          return frameRect;\n        }\n\n        frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);\n        return frameRect;\n      };\n\n      var getStyle = function getStyle() {\n        return style;\n      };\n      /**\n       * Read data from DOM\n       * @private\n       */\n\n\n      var _read = function _read() {\n        frameRect = null; // read child views\n\n        childViews.forEach(function (child) {\n          return child._read();\n        });\n        var shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);\n\n        if (shouldUpdate) {\n          updateRect(rect, element, style);\n        } // readers\n\n\n        var api = {\n          root: internalAPI,\n          props: props,\n          rect: rect\n        };\n        readers.forEach(function (reader) {\n          return reader(api);\n        });\n      };\n      /**\n       * Write data to DOM\n       * @private\n       */\n\n\n      var _write = function _write(ts, frameActions, shouldOptimize) {\n        // if no actions, we assume that the view is resting\n        var resting = frameActions.length === 0; // writers\n\n        writers.forEach(function (writer) {\n          var writerResting = writer({\n            props: props,\n            root: internalAPI,\n            actions: frameActions,\n            timestamp: ts,\n            shouldOptimize: shouldOptimize\n          });\n\n          if (writerResting === false) {\n            resting = false;\n          }\n        }); // run mixins\n\n        activeMixins.forEach(function (mixin) {\n          // if one of the mixins is still busy after write operation, we are not resting\n          var mixinResting = mixin.write(ts);\n\n          if (mixinResting === false) {\n            resting = false;\n          }\n        }); // updates child views that are currently attached to the DOM\n\n        childViews.filter(function (child) {\n          return !!child.element.parentNode;\n        }).forEach(function (child) {\n          // if a child view is not resting, we are not resting\n          var childResting = child._write(ts, filterFrameActionsForChild(child, frameActions), shouldOptimize);\n\n          if (!childResting) {\n            resting = false;\n          }\n        }); // append new elements to DOM and update those\n\n        childViews //.filter(child => !child.element.parentNode)\n        .forEach(function (child, index) {\n          // skip\n          if (child.element.parentNode) {\n            return;\n          } // append to DOM\n\n\n          internalAPI.appendChild(child.element, index); // call read (need to know the size of these elements)\n\n          child._read(); // re-call write\n\n\n          child._write(ts, filterFrameActionsForChild(child, frameActions), shouldOptimize); // we just added somthing to the dom, no rest\n\n\n          resting = false;\n        }); // update resting state\n\n        isResting = resting;\n        didWriteView({\n          props: props,\n          root: internalAPI,\n          actions: frameActions,\n          timestamp: ts\n        }); // let parent know if we are resting\n\n        return resting;\n      };\n\n      var _destroy = function _destroy() {\n        activeMixins.forEach(function (mixin) {\n          return mixin.destroy();\n        });\n        destroyers.forEach(function (destroyer) {\n          destroyer({\n            root: internalAPI,\n            props: props\n          });\n        });\n        childViews.forEach(function (child) {\n          return child._destroy();\n        });\n      }; // sharedAPI\n\n\n      var sharedAPIDefinition = {\n        element: {\n          get: getElement\n        },\n        style: {\n          get: getStyle\n        },\n        childViews: {\n          get: getChildViews\n        }\n      }; // private API definition\n\n      var internalAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n        rect: {\n          get: getRect\n        },\n        // access to custom children references\n        ref: {\n          get: getReference\n        },\n        // dom modifiers\n        is: function is(needle) {\n          return name === needle;\n        },\n        appendChild: appendChild(element),\n        createChildView: createChildView(store),\n        linkView: function linkView(view) {\n          childViews.push(view);\n          return view;\n        },\n        unlinkView: function unlinkView(view) {\n          childViews.splice(childViews.indexOf(view), 1);\n        },\n        appendChildView: appendChildView(element, childViews),\n        removeChildView: removeChildView(element, childViews),\n        registerWriter: function registerWriter(writer) {\n          return writers.push(writer);\n        },\n        registerReader: function registerReader(reader) {\n          return readers.push(reader);\n        },\n        registerDestroyer: function registerDestroyer(destroyer) {\n          return destroyers.push(destroyer);\n        },\n        invalidateLayout: function invalidateLayout() {\n          return element.layoutCalculated = false;\n        },\n        // access to data store\n        dispatch: store.dispatch,\n        query: store.query\n      }); // public view API methods\n\n      var externalAPIDefinition = {\n        element: {\n          get: getElement\n        },\n        childViews: {\n          get: getChildViews\n        },\n        rect: {\n          get: getRect\n        },\n        resting: {\n          get: function get() {\n            return isResting;\n          }\n        },\n        isRectIgnored: function isRectIgnored() {\n          return ignoreRect;\n        },\n        _read: _read,\n        _write: _write,\n        _destroy: _destroy\n      }; // mixin API methods\n\n      var mixinAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n        rect: {\n          get: function get() {\n            return rect;\n          }\n        }\n      }); // add mixin functionality\n\n      Object.keys(mixins).sort(function (a, b) {\n        // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)\n        if (a === 'styles') {\n          return 1;\n        } else if (b === 'styles') {\n          return -1;\n        }\n\n        return 0;\n      }).forEach(function (key) {\n        var mixinAPI = Mixins[key]({\n          mixinConfig: mixins[key],\n          viewProps: props,\n          viewState: state,\n          viewInternalAPI: internalAPIDefinition,\n          viewExternalAPI: externalAPIDefinition,\n          view: createObject(mixinAPIDefinition)\n        });\n\n        if (mixinAPI) {\n          activeMixins.push(mixinAPI);\n        }\n      }); // construct private api\n\n      var internalAPI = createObject(internalAPIDefinition); // create the view\n\n      create({\n        root: internalAPI,\n        props: props\n      }); // append created child views to root node\n\n      var childCount = element.children.length; // need to know the current child count so appending happens in correct order\n\n      childViews.forEach(function (child, index) {\n        internalAPI.appendChild(child.element, childCount + index);\n      }); // call did create\n\n      didCreateView(internalAPI); // expose public api\n\n      return createObject(externalAPIDefinition);\n    };\n  };\n\n  var createPainter = function createPainter(read, write) {\n    var fps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 60;\n    var name = '__framePainter'; // set global painter\n\n    if (window[name]) {\n      window[name].readers.push(read);\n      window[name].writers.push(write);\n      return;\n    }\n\n    window[name] = {\n      readers: [read],\n      writers: [write]\n    };\n    var painter = window[name];\n    var interval = 1000 / fps;\n    var last = null;\n    var id = null;\n    var requestTick = null;\n    var cancelTick = null;\n\n    var setTimerType = function setTimerType() {\n      if (document.hidden) {\n        requestTick = function requestTick() {\n          return window.setTimeout(function () {\n            return tick(performance.now());\n          }, interval);\n        };\n\n        cancelTick = function cancelTick() {\n          return window.clearTimeout(id);\n        };\n      } else {\n        requestTick = function requestTick() {\n          return window.requestAnimationFrame(tick);\n        };\n\n        cancelTick = function cancelTick() {\n          return window.cancelAnimationFrame(id);\n        };\n      }\n    };\n\n    document.addEventListener('visibilitychange', function () {\n      if (cancelTick) cancelTick();\n      setTimerType();\n      tick(performance.now());\n    });\n\n    var tick = function tick(ts) {\n      // queue next tick\n      id = requestTick(tick); // limit fps\n\n      if (!last) {\n        last = ts;\n      }\n\n      var delta = ts - last;\n\n      if (delta <= interval) {\n        // skip frame\n        return;\n      } // align next frame\n\n\n      last = ts - delta % interval; // update view\n\n      painter.readers.forEach(function (read) {\n        return read();\n      });\n      painter.writers.forEach(function (write) {\n        return write(ts);\n      });\n    };\n\n    setTimerType();\n    tick(performance.now());\n    return {\n      pause: function pause() {\n        cancelTick(id);\n      }\n    };\n  };\n\n  var createRoute = function createRoute(routes, fn) {\n    return function (_ref) {\n      var root = _ref.root,\n          props = _ref.props,\n          _ref$actions = _ref.actions,\n          actions = _ref$actions === void 0 ? [] : _ref$actions,\n          timestamp = _ref.timestamp,\n          shouldOptimize = _ref.shouldOptimize;\n      actions.filter(function (action) {\n        return routes[action.type];\n      }).forEach(function (action) {\n        return routes[action.type]({\n          root: root,\n          props: props,\n          action: action.data,\n          timestamp: timestamp,\n          shouldOptimize: shouldOptimize\n        });\n      });\n\n      if (fn) {\n        fn({\n          root: root,\n          props: props,\n          actions: actions,\n          timestamp: timestamp,\n          shouldOptimize: shouldOptimize\n        });\n      }\n    };\n  };\n\n  var insertBefore = function insertBefore(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode);\n  };\n\n  var insertAfter = function insertAfter(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n  };\n\n  var isArray = function isArray(value) {\n    return Array.isArray(value);\n  };\n\n  var isEmpty = function isEmpty(value) {\n    return value == null;\n  };\n\n  var trim = function trim(str) {\n    return str.trim();\n  };\n\n  var toString = function toString(value) {\n    return '' + value;\n  };\n\n  var toArray = function toArray(value) {\n    var splitter = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ',';\n\n    if (isEmpty(value)) {\n      return [];\n    }\n\n    if (isArray(value)) {\n      return value;\n    }\n\n    return toString(value).split(splitter).map(trim).filter(function (str) {\n      return str.length;\n    });\n  };\n\n  var isBoolean = function isBoolean(value) {\n    return typeof value === 'boolean';\n  };\n\n  var toBoolean = function toBoolean(value) {\n    return isBoolean(value) ? value : value === 'true';\n  };\n\n  var isString = function isString(value) {\n    return typeof value === 'string';\n  };\n\n  var toNumber = function toNumber(value) {\n    return isNumber(value) ? value : isString(value) ? toString(value).replace(/[a-z]+/gi, '') : 0;\n  };\n\n  var toInt = function toInt(value) {\n    return parseInt(toNumber(value), 10);\n  };\n\n  var toFloat = function toFloat(value) {\n    return parseFloat(toNumber(value));\n  };\n\n  var isInt = function isInt(value) {\n    return isNumber(value) && isFinite(value) && Math.floor(value) === value;\n  };\n\n  var toBytes = function toBytes(value) {\n    // is in bytes\n    if (isInt(value)) {\n      return value;\n    } // is natural file size\n\n\n    var naturalFileSize = toString(value).trim(); // if is value in megabytes\n\n    if (/MB$/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();\n      return toInt(naturalFileSize) * 1000 * 1000;\n    } // if is value in kilobytes\n\n\n    if (/KB/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();\n      return toInt(naturalFileSize) * 1000;\n    }\n\n    return toInt(naturalFileSize);\n  };\n\n  var isFunction = function isFunction(value) {\n    return typeof value === 'function';\n  };\n\n  var toFunctionReference = function toFunctionReference(string) {\n    var ref = self;\n    var levels = string.split('.');\n    var level = null;\n\n    while (level = levels.shift()) {\n      ref = ref[level];\n\n      if (!ref) {\n        return null;\n      }\n    }\n\n    return ref;\n  };\n\n  var methods = {\n    process: 'POST',\n    patch: 'PATCH',\n    revert: 'DELETE',\n    fetch: 'GET',\n    restore: 'GET',\n    load: 'GET'\n  };\n\n  var createServerAPI = function createServerAPI(outline) {\n    var api = {};\n    api.url = isString(outline) ? outline : outline.url || '';\n    api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;\n    api.headers = outline.headers ? outline.headers : {};\n    forin(methods, function (key) {\n      api[key] = createAction(key, outline[key], methods[key], api.timeout, api.headers);\n    }); // special treatment for remove\n\n    api.remove = outline.remove || null; // remove generic headers from api object\n\n    delete api.headers;\n    return api;\n  };\n\n  var createAction = function createAction(name, outline, method, timeout, headers) {\n    // is explicitely set to null so disable\n    if (outline === null) {\n      return null;\n    } // if is custom function, done! Dev handles everything.\n\n\n    if (typeof outline === 'function') {\n      return outline;\n    } // build action object\n\n\n    var action = {\n      url: method === 'GET' || method === 'PATCH' ? '?' + name + '=' : '',\n      method: method,\n      headers: headers,\n      withCredentials: false,\n      timeout: timeout,\n      onload: null,\n      ondata: null,\n      onerror: null\n    }; // is a single url\n\n    if (isString(outline)) {\n      action.url = outline;\n      return action;\n    } // overwrite\n\n\n    Object.assign(action, outline); // see if should reformat headers;\n\n    if (isString(action.headers)) {\n      var parts = action.headers.split(/:(.+)/);\n      action.headers = {\n        header: parts[0],\n        value: parts[1]\n      };\n    } // if is bool withCredentials\n\n\n    action.withCredentials = toBoolean(action.withCredentials);\n    return action;\n  };\n\n  var toServerAPI = function toServerAPI(value) {\n    return createServerAPI(value);\n  };\n\n  var isNull = function isNull(value) {\n    return value === null;\n  };\n\n  var isObject = function isObject(value) {\n    return typeof value === 'object' && value !== null;\n  };\n\n  var isAPI = function isAPI(value) {\n    return isObject(value) && isString(value.url) && isObject(value.process) && isObject(value.revert) && isObject(value.restore) && isObject(value.fetch);\n  };\n\n  var getType = function getType(value) {\n    if (isArray(value)) {\n      return 'array';\n    }\n\n    if (isNull(value)) {\n      return 'null';\n    }\n\n    if (isInt(value)) {\n      return 'int';\n    }\n\n    if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {\n      return 'bytes';\n    }\n\n    if (isAPI(value)) {\n      return 'api';\n    }\n\n    return typeof value;\n  };\n\n  var replaceSingleQuotes = function replaceSingleQuotes(str) {\n    return str.replace(/{\\s*'/g, '{\"').replace(/'\\s*}/g, '\"}').replace(/'\\s*:/g, '\":').replace(/:\\s*'/g, ':\"').replace(/,\\s*'/g, ',\"').replace(/'\\s*,/g, '\",');\n  };\n\n  var conversionTable = {\n    array: toArray,\n    boolean: toBoolean,\n    int: function int(value) {\n      return getType(value) === 'bytes' ? toBytes(value) : toInt(value);\n    },\n    number: toFloat,\n    float: toFloat,\n    bytes: toBytes,\n    string: function string(value) {\n      return isFunction(value) ? value : toString(value);\n    },\n    function: function _function(value) {\n      return toFunctionReference(value);\n    },\n    serverapi: toServerAPI,\n    object: function object(value) {\n      try {\n        return JSON.parse(replaceSingleQuotes(value));\n      } catch (e) {\n        return null;\n      }\n    }\n  };\n\n  var convertTo = function convertTo(value, type) {\n    return conversionTable[type](value);\n  };\n\n  var getValueByType = function getValueByType(newValue, defaultValue, valueType) {\n    // can always assign default value\n    if (newValue === defaultValue) {\n      return newValue;\n    } // get the type of the new value\n\n\n    var newValueType = getType(newValue); // is valid type?\n\n    if (newValueType !== valueType) {\n      // is string input, let's attempt to convert\n      var convertedValue = convertTo(newValue, valueType); // what is the type now\n\n      newValueType = getType(convertedValue); // no valid conversions found\n\n      if (convertedValue === null) {\n        throw 'Trying to assign value with incorrect type to \"' + option + '\", allowed type: \"' + valueType + '\"';\n      } else {\n        newValue = convertedValue;\n      }\n    } // assign new value\n\n\n    return newValue;\n  };\n\n  var createOption = function createOption(defaultValue, valueType) {\n    var currentValue = defaultValue;\n    return {\n      enumerable: true,\n      get: function get() {\n        return currentValue;\n      },\n      set: function set(newValue) {\n        currentValue = getValueByType(newValue, defaultValue, valueType);\n      }\n    };\n  };\n\n  var createOptions = function createOptions(options) {\n    var obj = {};\n    forin(options, function (prop) {\n      var optionDefinition = options[prop];\n      obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);\n    });\n    return createObject(obj);\n  };\n\n  var createInitialState = function createInitialState(options) {\n    return {\n      // model\n      items: [],\n      // timeout used for calling update items\n      listUpdateTimeout: null,\n      // timeout used for stacking metadata updates\n      itemUpdateTimeout: null,\n      // queue of items waiting to be processed\n      processingQueue: [],\n      // options\n      options: createOptions(options)\n    };\n  };\n\n  var fromCamels = function fromCamels(string) {\n    var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string.split(/(?=[A-Z])/).map(function (part) {\n      return part.toLowerCase();\n    }).join(separator);\n  };\n\n  var createOptionAPI = function createOptionAPI(store, options) {\n    var obj = {};\n    forin(options, function (key) {\n      obj[key] = {\n        get: function get() {\n          return store.getState().options[key];\n        },\n        set: function set(value) {\n          store.dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        }\n      };\n    });\n    return obj;\n  };\n\n  var createOptionActions = function createOptionActions(options) {\n    return function (dispatch, query, state) {\n      var obj = {};\n      forin(options, function (key) {\n        var name = fromCamels(key, '_').toUpperCase();\n\n        obj['SET_' + name] = function (action) {\n          try {\n            state.options[key] = action.value;\n          } catch (e) {} // nope, failed\n          // we successfully set the value of this option\n\n\n          dispatch('DID_SET_' + name, {\n            value: state.options[key]\n          });\n        };\n      });\n      return obj;\n    };\n  };\n\n  var createOptionQueries = function createOptionQueries(options) {\n    return function (state) {\n      var obj = {};\n      forin(options, function (key) {\n        obj['GET_' + fromCamels(key, '_').toUpperCase()] = function (action) {\n          return state.options[key];\n        };\n      });\n      return obj;\n    };\n  };\n\n  var InteractionMethod = {\n    API: 1,\n    DROP: 2,\n    BROWSE: 3,\n    PASTE: 4,\n    NONE: 5\n  };\n\n  var getUniqueId = function getUniqueId() {\n    return Math.random().toString(36).substr(2, 9);\n  };\n\n  var arrayRemove = function arrayRemove(arr, index) {\n    return arr.splice(index, 1);\n  };\n\n  var on = function on() {\n    var listeners = [];\n\n    var off = function off(event, cb) {\n      arrayRemove(listeners, listeners.findIndex(function (listener) {\n        return listener.event === event && (listener.cb === cb || !cb);\n      }));\n    };\n\n    return {\n      fire: function fire(event) {\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n\n        listeners.filter(function (listener) {\n          return listener.event === event;\n        }).map(function (listener) {\n          return listener.cb;\n        }).forEach(function (cb) {\n          setTimeout(function () {\n            cb.apply(void 0, args);\n          }, 0);\n        });\n      },\n      on: function on(event, cb) {\n        listeners.push({\n          event: event,\n          cb: cb\n        });\n      },\n      onOnce: function onOnce(event, _cb) {\n        listeners.push({\n          event: event,\n          cb: function cb() {\n            off(event, _cb);\n\n            _cb.apply(void 0, arguments);\n          }\n        });\n      },\n      off: off\n    };\n  };\n\n  var copyObjectPropertiesToObject = function copyObjectPropertiesToObject(src, target, excluded) {\n    Object.getOwnPropertyNames(src).filter(function (property) {\n      return !excluded.includes(property);\n    }).forEach(function (key) {\n      return Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(src, key));\n    });\n  };\n\n  var PRIVATE = ['fire', 'process', 'revert', 'load', 'on', 'off', 'onOnce', 'retryLoad', 'extend', 'archive', 'archived', 'release', 'released', 'requestProcessing', 'freeze'];\n\n  var createItemAPI = function createItemAPI(item) {\n    var api = {};\n    copyObjectPropertiesToObject(item, api, PRIVATE);\n    return api;\n  };\n\n  var removeReleasedItems = function removeReleasedItems(items) {\n    items.forEach(function (item, index) {\n      if (item.released) {\n        arrayRemove(items, index);\n      }\n    });\n  };\n\n  var ItemStatus = {\n    INIT: 1,\n    IDLE: 2,\n    PROCESSING_QUEUED: 9,\n    PROCESSING: 3,\n    PROCESSING_COMPLETE: 5,\n    PROCESSING_ERROR: 6,\n    PROCESSING_REVERT_ERROR: 10,\n    LOADING: 7,\n    LOAD_ERROR: 8\n  };\n  var FileOrigin = {\n    INPUT: 1,\n    LIMBO: 2,\n    LOCAL: 3\n  };\n\n  var getNonNumeric = function getNonNumeric(str) {\n    return /[^0-9]+/.exec(str);\n  };\n\n  var getDecimalSeparator = function getDecimalSeparator() {\n    return getNonNumeric(1.1.toLocaleString())[0];\n  };\n\n  var getThousandsSeparator = function getThousandsSeparator() {\n    // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)\n    // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot\n    var decimalSeparator = getDecimalSeparator();\n    var thousandsStringWithSeparator = 1000.0.toLocaleString();\n    var thousandsStringWithoutSeparator = 1000.0.toString();\n\n    if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {\n      return getNonNumeric(thousandsStringWithSeparator)[0];\n    }\n\n    return decimalSeparator === '.' ? ',' : '.';\n  };\n\n  var Type = {\n    BOOLEAN: 'boolean',\n    INT: 'int',\n    NUMBER: 'number',\n    STRING: 'string',\n    ARRAY: 'array',\n    OBJECT: 'object',\n    FUNCTION: 'function',\n    ACTION: 'action',\n    SERVER_API: 'serverapi',\n    REGEX: 'regex'\n  }; // all registered filters\n\n  var filters = []; // loops over matching filters and passes options to each filter, returning the mapped results\n\n  var applyFilterChain = function applyFilterChain(key, value, utils) {\n    return new Promise(function (resolve, reject) {\n      // find matching filters for this key\n      var matchingFilters = filters.filter(function (f) {\n        return f.key === key;\n      }).map(function (f) {\n        return f.cb;\n      }); // resolve now\n\n      if (matchingFilters.length === 0) {\n        resolve(value);\n        return;\n      } // first filter to kick things of\n\n\n      var initialFilter = matchingFilters.shift(); // chain filters\n\n      matchingFilters.reduce( // loop over promises passing value to next promise\n      function (current, next) {\n        return current.then(function (value) {\n          return next(value, utils);\n        });\n      }, // call initial filter, will return a promise\n      initialFilter(value, utils) // all executed\n      ).then(function (value) {\n        return resolve(value);\n      }).catch(function (error) {\n        return reject(error);\n      });\n    });\n  };\n\n  var applyFilters = function applyFilters(key, value, utils) {\n    return filters.filter(function (f) {\n      return f.key === key;\n    }).map(function (f) {\n      return f.cb(value, utils);\n    });\n  }; // adds a new filter to the list\n\n\n  var addFilter = function addFilter(key, cb) {\n    return filters.push({\n      key: key,\n      cb: cb\n    });\n  };\n\n  var extendDefaultOptions = function extendDefaultOptions(additionalOptions) {\n    return Object.assign(defaultOptions, additionalOptions);\n  };\n\n  var getOptions = function getOptions() {\n    return Object.assign({}, defaultOptions);\n  };\n\n  var setOptions = function setOptions(opts) {\n    forin(opts, function (key, value) {\n      // key does not exist, so this option cannot be set\n      if (!defaultOptions[key]) {\n        return;\n      }\n\n      defaultOptions[key][0] = getValueByType(value, defaultOptions[key][0], defaultOptions[key][1]);\n    });\n  }; // default options on app\n\n\n  var defaultOptions = {\n    // the id to add to the root element\n    id: [null, Type.STRING],\n    // input field name to use\n    name: ['filepond', Type.STRING],\n    // disable the field\n    disabled: [false, Type.BOOLEAN],\n    // classname to put on wrapper\n    className: [null, Type.STRING],\n    // is the field required\n    required: [false, Type.BOOLEAN],\n    // Allow media capture when value is set\n    captureMethod: [null, Type.STRING],\n    // - \"camera\", \"microphone\" or \"camcorder\",\n    // - Does not work with multiple on apple devices\n    // - If set, acceptedFileTypes must be made to match with media wildcard \"image/*\", \"audio/*\" or \"video/*\"\n    // Feature toggles\n    allowDrop: [true, Type.BOOLEAN],\n    // Allow dropping of files\n    allowBrowse: [true, Type.BOOLEAN],\n    // Allow browsing the file system\n    allowPaste: [true, Type.BOOLEAN],\n    // Allow pasting files\n    allowMultiple: [false, Type.BOOLEAN],\n    // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)\n    allowReplace: [true, Type.BOOLEAN],\n    // Allow dropping a file on other file to replace it (only works when multiple is set to false)\n    allowRevert: [true, Type.BOOLEAN],\n    // Allows user to revert file upload\n    // Revert mode\n    forceRevert: [false, Type.BOOLEAN],\n    // Set to 'force' to require the file to be reverted before removal\n    // Input requirements\n    maxFiles: [null, Type.INT],\n    // Max number of files\n    checkValidity: [false, Type.BOOLEAN],\n    // Enables custom validity messages\n    // Where to put file\n    itemInsertLocationFreedom: [true, Type.BOOLEAN],\n    // Set to false to always add items to begin or end of list\n    itemInsertLocation: ['before', Type.STRING],\n    // Default index in list to add items that have been dropped at the top of the list\n    itemInsertInterval: [75, Type.INT],\n    // Drag 'n Drop related\n    dropOnPage: [false, Type.BOOLEAN],\n    // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)\n    dropOnElement: [true, Type.BOOLEAN],\n    // Drop needs to happen on element (set to false to also load drops outside of Up)\n    dropValidation: [false, Type.BOOLEAN],\n    // Enable or disable validating files on drop\n    ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],\n    // Upload related\n    instantUpload: [true, Type.BOOLEAN],\n    // Should upload files immidiately on drop\n    maxParallelUploads: [2, Type.INT],\n    // Maximum files to upload in parallel\n    // Chunks\n    chunkUploads: [false, Type.BOOLEAN],\n    // Enable chunked uploads\n    chunkForce: [false, Type.BOOLEAN],\n    // Force use of chunk uploads even for files smaller than chunk size\n    chunkSize: [5000000, Type.INT],\n    // Size of chunks (5MB default)\n    chunkRetryDelays: [[500, 1000, 3000], Type.Array],\n    // Amount of times to retry upload of a chunk when it fails\n    // The server api end points to use for uploading (see docs)\n    server: [null, Type.SERVER_API],\n    // Labels and status messages\n    labelDecimalSeparator: [getDecimalSeparator(), Type.STRING],\n    // Default is locale separator\n    labelThousandsSeparator: [getThousandsSeparator(), Type.STRING],\n    // Default is locale separator\n    labelIdle: ['Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>', Type.STRING],\n    labelInvalidField: ['Field contains invalid files', Type.STRING],\n    labelFileWaitingForSize: ['Waiting for size', Type.STRING],\n    labelFileSizeNotAvailable: ['Size not available', Type.STRING],\n    labelFileCountSingular: ['file in list', Type.STRING],\n    labelFileCountPlural: ['files in list', Type.STRING],\n    labelFileLoading: ['Loading', Type.STRING],\n    labelFileAdded: ['Added', Type.STRING],\n    // assistive only\n    labelFileLoadError: ['Error during load', Type.STRING],\n    labelFileRemoved: ['Removed', Type.STRING],\n    // assistive only\n    labelFileRemoveError: ['Error during remove', Type.STRING],\n    labelFileProcessing: ['Uploading', Type.STRING],\n    labelFileProcessingComplete: ['Upload complete', Type.STRING],\n    labelFileProcessingAborted: ['Upload cancelled', Type.STRING],\n    labelFileProcessingError: ['Error during upload', Type.STRING],\n    labelFileProcessingRevertError: ['Error during revert', Type.STRING],\n    labelTapToCancel: ['tap to cancel', Type.STRING],\n    labelTapToRetry: ['tap to retry', Type.STRING],\n    labelTapToUndo: ['tap to undo', Type.STRING],\n    labelButtonRemoveItem: ['Remove', Type.STRING],\n    labelButtonAbortItemLoad: ['Abort', Type.STRING],\n    labelButtonRetryItemLoad: ['Retry', Type.STRING],\n    labelButtonAbortItemProcessing: ['Cancel', Type.STRING],\n    labelButtonUndoItemProcessing: ['Undo', Type.STRING],\n    labelButtonRetryItemProcessing: ['Retry', Type.STRING],\n    labelButtonProcessItem: ['Upload', Type.STRING],\n    // make sure width and height plus viewpox are even numbers so icons are nicely centered\n    iconRemove: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconProcess: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z\" fill=\"currentColor\" fill-rule=\"evenodd\"/></svg>', Type.STRING],\n    iconRetry: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconUndo: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    iconDone: ['<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>', Type.STRING],\n    // event handlers\n    oninit: [null, Type.FUNCTION],\n    onwarning: [null, Type.FUNCTION],\n    onerror: [null, Type.FUNCTION],\n    onactivatefile: [null, Type.FUNCTION],\n    onaddfilestart: [null, Type.FUNCTION],\n    onaddfileprogress: [null, Type.FUNCTION],\n    onaddfile: [null, Type.FUNCTION],\n    onprocessfilestart: [null, Type.FUNCTION],\n    onprocessfileprogress: [null, Type.FUNCTION],\n    onprocessfileabort: [null, Type.FUNCTION],\n    onprocessfilerevert: [null, Type.FUNCTION],\n    onprocessfile: [null, Type.FUNCTION],\n    onprocessfiles: [null, Type.FUNCTION],\n    onremovefile: [null, Type.FUNCTION],\n    onpreparefile: [null, Type.FUNCTION],\n    onupdatefiles: [null, Type.FUNCTION],\n    // hooks\n    beforeDropFile: [null, Type.FUNCTION],\n    beforeAddFile: [null, Type.FUNCTION],\n    beforeRemoveFile: [null, Type.FUNCTION],\n    // styles\n    stylePanelLayout: [null, Type.STRING],\n    // null 'integrated', 'compact', 'circle'\n    stylePanelAspectRatio: [null, Type.STRING],\n    // null or '3:2' or 1\n    styleItemPanelAspectRatio: [null, Type.STRING],\n    styleButtonRemoveItemPosition: ['left', Type.STRING],\n    styleButtonProcessItemPosition: ['right', Type.STRING],\n    styleLoadIndicatorPosition: ['right', Type.STRING],\n    styleProgressIndicatorPosition: ['right', Type.STRING],\n    // custom initial files array\n    files: [[], Type.ARRAY]\n  };\n\n  var getItemByQuery = function getItemByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return items[0] || null;\n    } // query is index\n\n\n    if (isInt(query)) {\n      return items[query] || null;\n    } // if query is item, get the id\n\n\n    if (typeof query === 'object') {\n      query = query.id;\n    } // assume query is a string and return item by id\n\n\n    return items.find(function (item) {\n      return item.id === query;\n    }) || null;\n  };\n\n  var getNumericAspectRatioFromString = function getNumericAspectRatioFromString(aspectRatio) {\n    if (isEmpty(aspectRatio)) {\n      return aspectRatio;\n    }\n\n    if (/:/.test(aspectRatio)) {\n      var parts = aspectRatio.split(':');\n      return parts[1] / parts[0];\n    }\n\n    return parseFloat(aspectRatio);\n  };\n\n  var getActiveItems = function getActiveItems(items) {\n    return items.filter(function (item) {\n      return !item.archived;\n    });\n  };\n\n  var Status = {\n    EMPTY: 0,\n    IDLE: 1,\n    // waiting\n    ERROR: 2,\n    // a file is in error state\n    BUSY: 3,\n    // busy processing or loading\n    READY: 4 // all files uploaded\n\n  };\n  var ITEM_ERROR = [ItemStatus.LOAD_ERROR, ItemStatus.PROCESSING_ERROR, ItemStatus.PROCESSING_REVERT_ERROR];\n  var ITEM_BUSY = [ItemStatus.LOADING, ItemStatus.PROCESSING, ItemStatus.PROCESSING_QUEUED, ItemStatus.INIT];\n  var ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];\n\n  var isItemInErrorState = function isItemInErrorState(item) {\n    return ITEM_ERROR.includes(item.status);\n  };\n\n  var isItemInBusyState = function isItemInBusyState(item) {\n    return ITEM_BUSY.includes(item.status);\n  };\n\n  var isItemInReadyState = function isItemInReadyState(item) {\n    return ITEM_READY.includes(item.status);\n  };\n\n  var queries = function queries(state) {\n    return {\n      GET_STATUS: function GET_STATUS() {\n        var items = getActiveItems(state.items);\n        var EMPTY = Status.EMPTY,\n            ERROR = Status.ERROR,\n            BUSY = Status.BUSY,\n            IDLE = Status.IDLE,\n            READY = Status.READY;\n        if (items.length === 0) return EMPTY;\n        if (items.some(isItemInErrorState)) return ERROR;\n        if (items.some(isItemInBusyState)) return BUSY;\n        if (items.some(isItemInReadyState)) return READY;\n        return IDLE;\n      },\n      GET_ITEM: function GET_ITEM(query) {\n        return getItemByQuery(state.items, query);\n      },\n      GET_ACTIVE_ITEM: function GET_ACTIVE_ITEM(query) {\n        return getItemByQuery(getActiveItems(state.items), query);\n      },\n      GET_ACTIVE_ITEMS: function GET_ACTIVE_ITEMS() {\n        return getActiveItems(state.items);\n      },\n      GET_ITEMS: function GET_ITEMS() {\n        return state.items;\n      },\n      GET_ITEM_NAME: function GET_ITEM_NAME(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.filename : null;\n      },\n      GET_ITEM_SIZE: function GET_ITEM_SIZE(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.fileSize : null;\n      },\n      GET_STYLES: function GET_STYLES() {\n        return Object.keys(state.options).filter(function (key) {\n          return /^style/.test(key);\n        }).map(function (option) {\n          return {\n            name: option,\n            value: state.options[option]\n          };\n        });\n      },\n      GET_PANEL_ASPECT_RATIO: function GET_PANEL_ASPECT_RATIO() {\n        var isShapeCircle = /circle/.test(state.options.stylePanelLayout);\n        var aspectRatio = isShapeCircle ? 1 : getNumericAspectRatioFromString(state.options.stylePanelAspectRatio);\n        return aspectRatio;\n      },\n      GET_ITEM_PANEL_ASPECT_RATIO: function GET_ITEM_PANEL_ASPECT_RATIO() {\n        return state.options.styleItemPanelAspectRatio;\n      },\n      GET_ITEMS_BY_STATUS: function GET_ITEMS_BY_STATUS(status) {\n        return getActiveItems(state.items).filter(function (item) {\n          return item.status === status;\n        });\n      },\n      GET_TOTAL_ITEMS: function GET_TOTAL_ITEMS() {\n        return getActiveItems(state.items).length;\n      },\n      IS_ASYNC: function IS_ASYNC() {\n        return isObject(state.options.server) && (isObject(state.options.server.process) || isFunction(state.options.server.process));\n      }\n    };\n  };\n\n  var hasRoomForItem = function hasRoomForItem(state) {\n    var count = getActiveItems(state.items).length; // if cannot have multiple items, to add one item it should currently not contain items\n\n    if (!state.options.allowMultiple) {\n      return count === 0;\n    } // if allows multiple items, we check if a max item count has been set, if not, there's no limit\n\n\n    var maxFileCount = state.options.maxFiles;\n\n    if (maxFileCount === null) {\n      return true;\n    } // we check if the current count is smaller than the max count, if so, another file can still be added\n\n\n    if (count < maxFileCount) {\n      return true;\n    } // no more room for another file\n\n\n    return false;\n  };\n\n  var limit = function limit(value, min, max) {\n    return Math.max(Math.min(max, value), min);\n  };\n\n  var arrayInsert = function arrayInsert(arr, index, item) {\n    return arr.splice(index, 0, item);\n  };\n\n  var insertItem = function insertItem(items, item, index) {\n    if (isEmpty(item)) {\n      return null;\n    } // if index is undefined, append\n\n\n    if (typeof index === 'undefined') {\n      items.push(item);\n      return item;\n    } // limit the index to the size of the items array\n\n\n    index = limit(index, 0, items.length); // add item to array\n\n    arrayInsert(items, index, item); // expose\n\n    return item;\n  };\n\n  var isBase64DataURI = function isBase64DataURI(str) {\n    return /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i.test(str);\n  };\n\n  var getFilenameFromURL = function getFilenameFromURL(url) {\n    return url.split('/').pop().split('?').shift();\n  };\n\n  var getExtensionFromFilename = function getExtensionFromFilename(name) {\n    return name.split('.').pop();\n  };\n\n  var guesstimateExtension = function guesstimateExtension(type) {\n    // if no extension supplied, exit here\n    if (typeof type !== 'string') {\n      return '';\n    } // get subtype\n\n\n    var subtype = type.split('/').pop(); // is svg subtype\n\n    if (/svg/.test(subtype)) {\n      return 'svg';\n    }\n\n    if (/zip|compressed/.test(subtype)) {\n      return 'zip';\n    }\n\n    if (/plain/.test(subtype)) {\n      return 'txt';\n    }\n\n    if (/msword/.test(subtype)) {\n      return 'doc';\n    } // if is valid subtype\n\n\n    if (/[a-z]+/.test(subtype)) {\n      // always use jpg extension\n      if (subtype === 'jpeg') {\n        return 'jpg';\n      } // return subtype\n\n\n      return subtype;\n    }\n\n    return '';\n  };\n\n  var leftPad = function leftPad(value) {\n    var padding = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    return (padding + value).slice(-padding.length);\n  };\n\n  var getDateString = function getDateString() {\n    var date = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Date();\n    return date.getFullYear() + '-' + leftPad(date.getMonth() + 1, '00') + '-' + leftPad(date.getDate(), '00') + '_' + leftPad(date.getHours(), '00') + '-' + leftPad(date.getMinutes(), '00') + '-' + leftPad(date.getSeconds(), '00');\n  };\n\n  var getFileFromBlob = function getFileFromBlob(blob, filename) {\n    var type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var extension = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    var file = typeof type === 'string' ? blob.slice(0, blob.size, type) : blob.slice(0, blob.size, blob.type);\n    file.lastModifiedDate = new Date(); // if blob has name property, use as filename if no filename supplied\n\n    if (!isString(filename)) {\n      filename = getDateString();\n    } // if filename supplied but no extension and filename has extension\n\n\n    if (filename && extension === null && getExtensionFromFilename(filename)) {\n      file.name = filename;\n    } else {\n      extension = extension || guesstimateExtension(file.type);\n      file.name = filename + (extension ? '.' + extension : '');\n    }\n\n    return file;\n  };\n\n  var getBlobBuilder = function getBlobBuilder() {\n    return window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n  };\n\n  var createBlob = function createBlob(arrayBuffer, mimeType) {\n    var BB = getBlobBuilder();\n\n    if (BB) {\n      var bb = new BB();\n      bb.append(arrayBuffer);\n      return bb.getBlob(mimeType);\n    }\n\n    return new Blob([arrayBuffer], {\n      type: mimeType\n    });\n  };\n\n  var getBlobFromByteStringWithMimeType = function getBlobFromByteStringWithMimeType(byteString, mimeType) {\n    var ab = new ArrayBuffer(byteString.length);\n    var ia = new Uint8Array(ab);\n\n    for (var i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i);\n    }\n\n    return createBlob(ab, mimeType);\n  };\n\n  var getMimeTypeFromBase64DataURI = function getMimeTypeFromBase64DataURI(dataURI) {\n    return (/^data:(.+);/.exec(dataURI) || [])[1] || null;\n  };\n\n  var getBase64DataFromBase64DataURI = function getBase64DataFromBase64DataURI(dataURI) {\n    // get data part of string (remove data:image/jpeg...,)\n    var data = dataURI.split(',')[1]; // remove any whitespace as that causes InvalidCharacterError in IE\n\n    return data.replace(/\\s/g, '');\n  };\n\n  var getByteStringFromBase64DataURI = function getByteStringFromBase64DataURI(dataURI) {\n    return atob(getBase64DataFromBase64DataURI(dataURI));\n  };\n\n  var getBlobFromBase64DataURI = function getBlobFromBase64DataURI(dataURI) {\n    var mimeType = getMimeTypeFromBase64DataURI(dataURI);\n    var byteString = getByteStringFromBase64DataURI(dataURI);\n    return getBlobFromByteStringWithMimeType(byteString, mimeType);\n  };\n\n  var getFileFromBase64DataURI = function getFileFromBase64DataURI(dataURI, filename, extension) {\n    return getFileFromBlob(getBlobFromBase64DataURI(dataURI), filename, null, extension);\n  };\n\n  var getFileNameFromHeader = function getFileNameFromHeader(header) {\n    // test if is content disposition header, if not exit\n    if (!/^content-disposition:/i.test(header)) return null; // get filename parts\n\n    var matches = header.split(/filename=|filename\\*=.+''/).splice(1).map(function (name) {\n      return name.trim().replace(/^[\"']|[;\"']{0,2}$/g, '');\n    }).filter(function (name) {\n      return name.length;\n    });\n    return matches.length ? decodeURI(matches[matches.length - 1]) : null;\n  };\n\n  var getFileSizeFromHeader = function getFileSizeFromHeader(header) {\n    if (/content-length:/i.test(header)) {\n      var size = header.match(/[0-9]+/)[0];\n      return size ? parseInt(size, 10) : null;\n    }\n\n    return null;\n  };\n\n  var getTranfserIdFromHeader = function getTranfserIdFromHeader(header) {\n    if (/x-content-transfer-id:/i.test(header)) {\n      var id = (header.split(':')[1] || '').trim();\n      return id || null;\n    }\n\n    return null;\n  };\n\n  var getFileInfoFromHeaders = function getFileInfoFromHeaders(headers) {\n    var info = {\n      source: null,\n      name: null,\n      size: null\n    };\n    var rows = headers.split('\\n');\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = rows[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var header = _step.value;\n        var name = getFileNameFromHeader(header);\n\n        if (name) {\n          info.name = name;\n          continue;\n        }\n\n        var size = getFileSizeFromHeader(header);\n\n        if (size) {\n          info.size = size;\n          continue;\n        }\n\n        var source = getTranfserIdFromHeader(header);\n\n        if (source) {\n          info.source = source;\n          continue;\n        }\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return != null) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    return info;\n  };\n\n  var createFileLoader = function createFileLoader(fetchFn) {\n    var state = {\n      source: null,\n      complete: false,\n      progress: 0,\n      size: null,\n      timestamp: null,\n      duration: 0,\n      request: null\n    };\n\n    var getProgress = function getProgress() {\n      return state.progress;\n    };\n\n    var abort = function abort() {\n      if (state.request && state.request.abort) {\n        state.request.abort();\n      }\n    }; // load source\n\n\n    var load = function load() {\n      // get quick reference\n      var source = state.source;\n      api.fire('init', source); // Load Files\n\n      if (source instanceof File) {\n        api.fire('load', source);\n      } else if (source instanceof Blob) {\n        // Load blobs, set default name to current date\n        api.fire('load', getFileFromBlob(source, source.name));\n      } else if (isBase64DataURI(source)) {\n        // Load base 64, set default name to current date\n        api.fire('load', getFileFromBase64DataURI(source));\n      } else {\n        // Deal as if is external URL, let's load it!\n        loadURL(source);\n      }\n    }; // loads a url\n\n\n    var loadURL = function loadURL(url) {\n      // is remote url and no fetch method supplied\n      if (!fetchFn) {\n        api.fire('error', {\n          type: 'error',\n          body: \"Can't load URL\",\n          code: 400\n        });\n        return;\n      } // set request start\n\n\n      state.timestamp = Date.now(); // load file\n\n      state.request = fetchFn(url, function (response) {\n        // update duration\n        state.duration = Date.now() - state.timestamp; // done!\n\n        state.complete = true; // turn blob response into a file\n\n        if (response instanceof Blob) {\n          response = getFileFromBlob(response, response.name || getFilenameFromURL(url));\n        }\n\n        api.fire('load', response instanceof Blob ? response : response.body);\n      }, function (error) {\n        api.fire('error', typeof error === 'string' ? {\n          type: 'error',\n          code: 0,\n          body: error\n        } : error);\n      }, function (computable, current, total) {\n        // collected some meta data already\n        if (total) {\n          state.size = total;\n        } // update duration\n\n\n        state.duration = Date.now() - state.timestamp; // if we can't compute progress, we're not going to fire progress events\n\n        if (!computable) {\n          state.progress = null;\n          return;\n        } // update progress percentage\n\n\n        state.progress = current / total; // expose\n\n        api.fire('progress', state.progress);\n      }, function () {\n        api.fire('abort');\n      }, function (response) {\n        var fileinfo = getFileInfoFromHeaders(typeof response === 'string' ? response : response.headers);\n        api.fire('meta', {\n          size: state.size || fileinfo.size,\n          filename: fileinfo.name,\n          source: fileinfo.source\n        });\n      });\n    };\n\n    var api = Object.assign({}, on(), {\n      setSource: function setSource(source) {\n        return state.source = source;\n      },\n      getProgress: getProgress,\n      // file load progress\n      abort: abort,\n      // abort file load\n      load: load // start load\n\n    });\n    return api;\n  };\n\n  var isGet = function isGet(method) {\n    return /GET|HEAD/.test(method);\n  };\n\n  var sendRequest = function sendRequest(data, url, options) {\n    var api = {\n      onheaders: function onheaders() {},\n      onprogress: function onprogress() {},\n      onload: function onload() {},\n      ontimeout: function ontimeout() {},\n      onerror: function onerror() {},\n      onabort: function onabort() {},\n      abort: function abort() {\n        aborted = true;\n        xhr.abort();\n      }\n    }; // timeout identifier, only used when timeout is defined\n\n    var aborted = false;\n    var headersReceived = false; // set default options\n\n    options = Object.assign({\n      method: 'POST',\n      headers: {},\n      withCredentials: false\n    }, options); // encode url\n\n    url = encodeURI(url); // if method is GET, add any received data to url\n\n    if (isGet(options.method) && data) {\n      url = '' + url + encodeURIComponent(typeof data === 'string' ? data : JSON.stringify(data));\n    } // create request\n\n\n    var xhr = new XMLHttpRequest(); // progress of load\n\n    var process = isGet(options.method) ? xhr : xhr.upload;\n\n    process.onprogress = function (e) {\n      // no progress event when aborted ( onprogress is called once after abort() )\n      if (aborted) {\n        return;\n      }\n\n      api.onprogress(e.lengthComputable, e.loaded, e.total);\n    }; // tries to get header info to the app as fast as possible\n\n\n    xhr.onreadystatechange = function () {\n      // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)\n      if (xhr.readyState < 2) {\n        return;\n      } // no server response\n\n\n      if (xhr.readyState === 4 && xhr.status === 0) {\n        return;\n      }\n\n      if (headersReceived) {\n        return;\n      }\n\n      headersReceived = true; // we've probably received some useful data in response headers\n\n      api.onheaders(xhr);\n    }; // load successful\n\n\n    xhr.onload = function () {\n      // is classified as valid response\n      if (xhr.status >= 200 && xhr.status < 300) {\n        api.onload(xhr);\n      } else {\n        api.onerror(xhr);\n      }\n    }; // error during load\n\n\n    xhr.onerror = function () {\n      return api.onerror(xhr);\n    }; // request aborted\n\n\n    xhr.onabort = function () {\n      aborted = true;\n      api.onabort();\n    }; // request timeout\n\n\n    xhr.ontimeout = function () {\n      return api.ontimeout(xhr);\n    }; // open up open up!\n\n\n    xhr.open(options.method, url, true); // set timeout if defined (do it after open so IE11 plays ball)\n\n    if (isInt(options.timeout)) {\n      xhr.timeout = options.timeout;\n    } // add headers\n\n\n    Object.keys(options.headers).forEach(function (key) {\n      var value = unescape(encodeURIComponent(options.headers[key]));\n      xhr.setRequestHeader(key, value);\n    }); // set type of response\n\n    if (options.responseType) {\n      xhr.responseType = options.responseType;\n    } // set credentials\n\n\n    if (options.withCredentials) {\n      xhr.withCredentials = true;\n    } // let's send our data\n\n\n    xhr.send(data);\n    return api;\n  };\n\n  var createResponse = function createResponse(type, code, body, headers) {\n    return {\n      type: type,\n      code: code,\n      body: body,\n      headers: headers\n    };\n  };\n\n  var createTimeoutResponse = function createTimeoutResponse(cb) {\n    return function (xhr) {\n      cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));\n    };\n  };\n\n  var createFetchFunction = function createFetchFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined; // custom handler (should also handle file, load, error, progress and abort)\n\n    if (typeof action === 'function') {\n      return action;\n    } // no action supplied\n\n\n    if (!action || !isString(action.url)) {\n      return null;\n    } // set onload hanlder\n\n\n    var onload = action.onload || function (res) {\n      return res;\n    };\n\n    var onerror = action.onerror || function (res) {\n      return null;\n    }; // internal handler\n\n\n    return function (url, load, error, progress, abort, headers) {\n      // do local or remote request based on if the url is external\n      var request = sendRequest(url, apiUrl + action.url, Object.assign({}, action, {\n        responseType: 'blob'\n      }));\n\n      request.onload = function (xhr) {\n        // get headers\n        var headers = xhr.getAllResponseHeaders(); // get filename\n\n        var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url); // create response\n\n        load(createResponse('load', xhr.status, getFileFromBlob(onload(xhr.response), filename), headers));\n      };\n\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.onheaders = function (xhr) {\n        headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort; // should return request\n\n      return request;\n    };\n  };\n\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var REACT_ELEMENT_TYPE;\n\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE = typeof Symbol === 'function' && Symbol['for'] && Symbol['for']('react.element') || 0xeac7;\n    }\n\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n\n  function _asyncIterator(iterable) {\n    var method;\n\n    if (typeof Symbol !== 'undefined') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n\n    throw new TypeError('Object is not async iterable');\n  }\n\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n\n  function _AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function (resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(function (arg) {\n          if (wrappedAwait) {\n            resume('next', arg);\n            return;\n          }\n\n          settle(result.done ? 'return' : 'normal', arg);\n        }, function (err) {\n          resume('throw', err);\n        });\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case 'throw':\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function () {\n      return this;\n    };\n  }\n\n  _AsyncGenerator.prototype.next = function (arg) {\n    return this._invoke('next', arg);\n  };\n\n  _AsyncGenerator.prototype.throw = function (arg) {\n    return this._invoke('throw', arg);\n  };\n\n  _AsyncGenerator.prototype.return = function (arg) {\n    return this._invoke('return', arg);\n  };\n\n  function _wrapAsyncGenerator(fn) {\n    return function () {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n        waiting = false;\n\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function (resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function () {\n        return this;\n      };\n    }\n\n    iter.next = function (value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n\n      return pump('next', value);\n    };\n\n    if (typeof inner.throw === 'function') {\n      iter.throw = function (value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n\n        return pump('throw', value);\n      };\n    }\n\n    if (typeof inner.return === 'function') {\n      iter.return = function (value) {\n        return pump('return', value);\n      };\n    }\n\n    return iter;\n  }\n\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n\n  function _asyncToGenerator(fn) {\n    return function () {\n      var self = this,\n          args = arguments;\n      return new Promise(function (resolve, reject) {\n        var gen = fn.apply(self, args);\n\n        function _next(value) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'next', value);\n        }\n\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n\n        _next(undefined);\n      });\n    };\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _extends() {\n    _extends = Object.assign || function (target) {\n      for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i];\n\n        for (var key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n\n      return target;\n    };\n\n    return _extends.apply(this, arguments);\n  }\n\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n          return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n        }));\n      }\n\n      ownKeys.forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n\n    return target;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(source, true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(source).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n      return o.__proto__ || Object.getPrototypeOf(o);\n    };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n      o.__proto__ = p;\n      return o;\n    };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n\n    return _construct.apply(null, arguments);\n  }\n\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n\n      if (typeof Class !== 'function') {\n        throw new TypeError('Super expression must either be null or a function');\n      }\n\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n\n        _cache.set(Class, Wrapper);\n      }\n\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n\n    return _wrapNativeSuper(Class);\n  }\n\n  function _instanceof(left, right) {\n    if (right != null && typeof Symbol !== 'undefined' && right[Symbol.hasInstance]) {\n      return !!right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule ? obj : {\n      default: obj\n    };\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};\n\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n\n        var desc;\n\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n\n        return true;\n      };\n    }\n\n    return set(target, property, value, receiver);\n  }\n\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n\n    return value;\n  }\n\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    return Object.freeze(Object.defineProperties(strings, {\n      raw: {\n        value: Object.freeze(raw)\n      }\n    }));\n  }\n\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    strings.raw = raw;\n    return strings;\n  }\n\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n\n  function _classNameTDZError(name) {\n    throw new Error('Class \"' + name + '\" cannot be referenced in computed property keys.');\n  }\n\n  var _temporalUndefined = {};\n\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n  }\n\n  function _slicedToArrayLoose(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimitLoose(arr, i) || _nonIterableRest();\n  }\n\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === '[object Arguments]') return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n\n    for (var _iterator = arr[Symbol.iterator](), _step; !(_step = _iterator.next()).done;) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n\n  function _skipFirstGeneratorNext(fn) {\n    return function () {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n\n    return (hint === 'string' ? String : Number)(input);\n  }\n\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n\n    return typeof key === 'symbol' ? key : String(key);\n  }\n\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error('Decorating class property failed. Please ensure that ' + 'proposal-class-properties is enabled and set to use loose mode. ' + 'To use proposal-class-properties in spec mode with decorators, wait for ' + 'the next major version of decorators in stage 2.');\n  }\n\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer ? descriptor.initializer.call(context) : void 0\n    });\n  }\n\n  function _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function (key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n\n    desc = decorators.slice().reverse().reduce(function (desc, decorator) {\n      return decorator(target, property, desc) || desc;\n    }, desc);\n\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n\n    return desc;\n  }\n\n  var id = 0;\n\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n\n    return receiver;\n  }\n\n  function _classPrivateFieldGet(receiver, privateMap) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n\n    return descriptor.value;\n  }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      descriptor.value = value;\n    }\n\n    return value;\n  }\n\n  function _classPrivateFieldDestructureSet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.set) {\n      if (!('__destrObj' in descriptor)) {\n        descriptor.__destrObj = {\n          set value(v) {\n            descriptor.set.call(receiver, v);\n          }\n\n        };\n      }\n\n      return descriptor.__destrObj;\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      return descriptor;\n    }\n  }\n\n  function _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return descriptor.value;\n  }\n\n  function _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n\n    descriptor.value = value;\n    return value;\n  }\n\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return method;\n  }\n\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(_coalesceClassElements(r.d.map(_createElementDescriptor)), decorators);\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function () {\n      return api;\n    };\n\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function (O, elements) {\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function (F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function (kind) {\n          elements.forEach(function (element) {\n            var placement = element.placement;\n\n            if (element.kind === kind && (placement === 'static' || placement === 'prototype')) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function (receiver, element) {\n        var descriptor = element.descriptor;\n\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function (elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function (element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function (element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(element, placements);\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function (element, placements, silent) {\n        var keys = placements[element.placement];\n\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n\n        keys.push(element.key);\n      },\n      decorateElement: function (element, placements) {\n        var extras = [];\n        var finishers = [];\n\n        for (var decorators = element.decorators, i = decorators.length - 1; i >= 0; i--) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras((0, decorators[i])(elementObject) || elementObject);\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n\n          var newExtras = elementFinisherExtras.extras;\n\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n\n            extras.push.apply(extras, newExtras);\n          }\n        }\n\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function (elements, decorators) {\n        var finishers = [];\n\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor((0, decorators[i])(obj) || obj);\n\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (elements[j].key === elements[k].key && elements[j].placement === elements[k].placement) {\n                  throw new TypeError('Duplicated element (' + elements[j].key + ')');\n                }\n              }\n            }\n          }\n        }\n\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function (element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function (elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function (elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(elementObject, 'finisher', 'An element descriptor');\n          this.disallowProperty(elementObject, 'extras', 'An element descriptor');\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function (elementObject) {\n        var kind = String(elementObject.kind);\n\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError('An element descriptor\\'s .kind property must be either \"method\" or' + ' \"field\", but a decorator created an element descriptor with' + ' .kind \"' + kind + '\"');\n        }\n\n        var key = _toPropertyKey(elementObject.key);\n\n        var placement = String(elementObject.placement);\n\n        if (placement !== 'static' && placement !== 'prototype' && placement !== 'own') {\n          throw new TypeError('An element descriptor\\'s .placement property must be one of \"static\",' + ' \"prototype\" or \"own\", but a decorator created an element descriptor' + ' with .placement \"' + placement + '\"');\n        }\n\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(elementObject, 'elements', 'An element descriptor');\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n\n        if (kind !== 'field') {\n          this.disallowProperty(elementObject, 'initializer', 'A method descriptor');\n        } else {\n          this.disallowProperty(descriptor, 'get', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'set', 'The property descriptor of a field descriptor');\n          this.disallowProperty(descriptor, 'value', 'The property descriptor of a field descriptor');\n          element.initializer = elementObject.initializer;\n        }\n\n        return element;\n      },\n      toElementFinisherExtras: function (elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function (elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function (obj) {\n        var kind = String(obj.kind);\n\n        if (kind !== 'class') {\n          throw new TypeError('A class descriptor\\'s .kind property must be \"class\", but a decorator' + ' created a class descriptor with .kind \"' + kind + '\"');\n        }\n\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function (constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n\n            constructor = newConstructor;\n          }\n        }\n\n        return constructor;\n      },\n      disallowProperty: function (obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(objectType + \" can't have a .\" + name + ' property.');\n        }\n      }\n    };\n    return api;\n  }\n\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n\n    var descriptor;\n\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static ? 'static' : def.kind === 'field' ? 'own' : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n\n    var isSameElement = function (other) {\n      return other.kind === 'method' && other.key === element.key && other.placement === element.placement;\n    };\n\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n\n      if (element.kind === 'method' && (other = newElements.find(isSameElement))) {\n        if (_isDataDescriptor(element.descriptor) || _isDataDescriptor(other.descriptor)) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError('Duplicated methods (' + element.key + \") can't be decorated.\");\n          }\n\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\"Decorators can't be placed on different accessors with for \" + 'the same property (' + element.key + ').');\n            }\n\n            other.decorators = element.decorators;\n          }\n\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n\n    return newElements;\n  }\n\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n\n  function _isDataDescriptor(desc) {\n    return desc !== undefined && !(desc.value === undefined && desc.writable === undefined);\n  }\n\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n\n    return value;\n  }\n\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    return fn;\n  }\n\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function (re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n\n    var _RegExp = _wrapNativeSuper(RegExp);\n\n    var _super = RegExp.prototype;\n\n    var _groups = new WeakMap();\n\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n\n      _groups.set(_this, groups);\n\n      return _this;\n    }\n\n    _inherits(BabelRegExp, _RegExp);\n\n    BabelRegExp.prototype.exec = function (str) {\n      var result = _super.exec.call(this, str);\n\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n\n    BabelRegExp.prototype[Symbol.replace] = function (str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n\n        return _super[Symbol.replace].call(this, str, substitution.replace(/\\$<([^>]+)>/g, function (_, name) {\n          return '$' + groups[name];\n        }));\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n\n        return _super[Symbol.replace].call(this, str, function () {\n          var args = [];\n          args.push.apply(args, arguments);\n\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n\n      return Object.keys(g).reduce(function (groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n\n    return _wrapRegExp.apply(this, arguments);\n  }\n\n  var ChunkStatus = {\n    QUEUED: 0,\n    COMPLETE: 1,\n    PROCESSING: 2,\n    ERROR: 3,\n    WAITING: 4\n  };\n  /*\n                                                       function signature:\n                                                         (file, metadata, load, error, progress, abort, transfer, options) => {\n                                                           return {\n                                                           abort:() => {}\n                                                         }\n                                                       }\n                                                       */\n  // apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options\n\n  var processFileChunked = function processFileChunked(apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options) {\n    // all chunks\n    var chunks = [];\n    var chunkTransferId = options.chunkTransferId,\n        chunkServer = options.chunkServer,\n        chunkSize = options.chunkSize,\n        chunkRetryDelays = options.chunkRetryDelays; // default state\n\n    var state = {\n      serverId: chunkTransferId,\n      aborted: false\n    }; // set onload handlers\n\n    var ondata = action.ondata || function (fd) {\n      return fd;\n    };\n\n    var onload = action.onload || function (xhr, method) {\n      return method === 'HEAD' ? xhr.getResponseHeader('Upload-Offset') : xhr.response;\n    };\n\n    var onerror = action.onerror || function (res) {\n      return null;\n    }; // create server hook\n\n\n    var requestTransferId = function requestTransferId(cb) {\n      var formData = new FormData(); // add metadata under same name\n\n      if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));\n      var headers = typeof action.headers === 'function' ? action.headers(file, metadata) : Object.assign({}, action.headers, {\n        'Upload-Length': file.size\n      });\n      var requestParams = Object.assign({}, action, {\n        headers: headers\n      }); // send request object\n\n      var request = sendRequest(ondata(formData), apiUrl + action.url, requestParams);\n\n      request.onload = function (xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function (xhr) {\n        return error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    };\n\n    var requestTransferOffset = function requestTransferOffset(cb) {\n      var requestUrl = apiUrl + chunkServer.url + state.serverId;\n      var headers = typeof action.headers === 'function' ? action.headers(state.serverId) : Object.assign({}, action.headers);\n      var requestParams = {\n        headers: headers,\n        method: 'HEAD'\n      };\n      var request = sendRequest(null, requestUrl, requestParams);\n\n      request.onload = function (xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function (xhr) {\n        return error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    }; // create chunks\n\n\n    var lastChunkIndex = Math.floor(file.size / chunkSize);\n\n    for (var i = 0; i <= lastChunkIndex; i++) {\n      var offset = i * chunkSize;\n      var data = file.slice(offset, offset + chunkSize, 'application/offset+octet-stream');\n      chunks[i] = {\n        index: i,\n        size: data.size,\n        offset: offset,\n        data: data,\n        file: file,\n        progress: 0,\n        retries: _toConsumableArray(chunkRetryDelays),\n        status: ChunkStatus.QUEUED,\n        error: null,\n        request: null,\n        timeout: null\n      };\n    }\n\n    var completeProcessingChunks = function completeProcessingChunks() {\n      return load(state.serverId);\n    };\n\n    var canProcessChunk = function canProcessChunk(chunk) {\n      return chunk.status === ChunkStatus.QUEUED || chunk.status === ChunkStatus.ERROR;\n    };\n\n    var processChunk = function processChunk(chunk) {\n      // processing is paused, wait here\n      if (state.aborted) return; // get next chunk to process\n\n      chunk = chunk || chunks.find(canProcessChunk); // no more chunks to process\n\n      if (!chunk) {\n        // all done?\n        if (chunks.every(function (chunk) {\n          return chunk.status === ChunkStatus.COMPLETE;\n        })) {\n          completeProcessingChunks();\n        } // no chunk to handle\n\n\n        return;\n      } // now processing this chunk\n\n\n      chunk.status = ChunkStatus.PROCESSING;\n      chunk.progress = null; // allow parsing of formdata\n\n      var ondata = chunkServer.ondata || function (fd) {\n        return fd;\n      };\n\n      var onerror = chunkServer.onerror || function (res) {\n        return null;\n      }; // send request object\n\n\n      var requestUrl = apiUrl + chunkServer.url + state.serverId;\n      var headers = typeof chunkServer.headers === 'function' ? chunkServer.headers(chunk) : Object.assign({}, chunkServer.headers, {\n        'Content-Type': 'application/offset+octet-stream',\n        'Upload-Offset': chunk.offset,\n        'Upload-Length': file.size,\n        'Upload-Name': file.name\n      });\n      var request = chunk.request = sendRequest(ondata(chunk.data), requestUrl, Object.assign({}, chunkServer, {\n        headers: headers\n      }));\n\n      request.onload = function () {\n        // done!\n        chunk.status = ChunkStatus.COMPLETE; // remove request reference\n\n        chunk.request = null; // start processing more chunks\n\n        processChunks();\n      };\n\n      request.onprogress = function (lengthComputable, loaded, total) {\n        chunk.progress = lengthComputable ? loaded : null;\n        updateTotalProgress();\n      };\n\n      request.onerror = function (xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n        chunk.error = onerror(xhr.response) || xhr.statusText;\n\n        if (!retryProcessChunk(chunk)) {\n          error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n        }\n      };\n\n      request.ontimeout = function (xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n\n        if (!retryProcessChunk(chunk)) {\n          createTimeoutResponse(error)(xhr);\n        }\n      };\n\n      request.onabort = function () {\n        chunk.status = ChunkStatus.QUEUED;\n        chunk.request = null;\n        abort();\n      };\n    };\n\n    var retryProcessChunk = function retryProcessChunk(chunk) {\n      // no more retries left\n      if (chunk.retries.length === 0) return false; // new retry\n\n      chunk.status = ChunkStatus.WAITING;\n      clearTimeout(chunk.timeout);\n      chunk.timeout = setTimeout(function () {\n        processChunk(chunk);\n      }, chunk.retries.shift()); // we're going to retry\n\n      return true;\n    };\n\n    var updateTotalProgress = function updateTotalProgress() {\n      // calculate total progress fraction\n      var totalBytesTransfered = chunks.reduce(function (p, chunk) {\n        if (p === null || chunk.progress === null) return null;\n        return p + chunk.progress;\n      }, 0); // can't compute progress\n\n      if (totalBytesTransfered === null) return progress(false, 0, 0); // calculate progress values\n\n      var totalSize = chunks.reduce(function (total, chunk) {\n        return total + chunk.size;\n      }, 0); // can update progress indicator\n\n      progress(true, totalBytesTransfered, totalSize);\n    }; // process new chunks\n\n\n    var processChunks = function processChunks() {\n      var totalProcessing = chunks.filter(function (chunk) {\n        return chunk.status === ChunkStatus.PROCESSING;\n      }).length;\n      if (totalProcessing >= 1) return;\n      processChunk();\n    };\n\n    var abortChunks = function abortChunks() {\n      chunks.forEach(function (chunk) {\n        clearTimeout(chunk.timeout);\n\n        if (chunk.request) {\n          chunk.request.abort();\n        }\n      });\n    }; // let's go!\n\n\n    if (!state.serverId) {\n      requestTransferId(function (serverId) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return; // pass back to item so we can use it if something goes wrong\n\n        transfer(serverId); // store internally\n\n        state.serverId = serverId;\n        processChunks();\n      });\n    } else {\n      requestTransferOffset(function (offset) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return; // mark chunks with lower offset as complete\n\n        chunks.filter(function (chunk) {\n          return chunk.offset < offset;\n        }).forEach(function (chunk) {\n          chunk.status = ChunkStatus.COMPLETE;\n          chunk.progress = chunk.size;\n        }); // continue processing\n\n        processChunks();\n      });\n    }\n\n    return {\n      abort: function abort() {\n        state.aborted = true;\n        abortChunks();\n      }\n    };\n  };\n  /*\n                                                               function signature:\n                                                                 (file, metadata, load, error, progress, abort) => {\n                                                                   return {\n                                                                   abort:() => {}\n                                                                 }\n                                                               }\n                                                               */\n\n\n  var createFileProcessorFunction = function createFileProcessorFunction(apiUrl, action, name, options) {\n    return function (file, metadata, load, error, progress, abort, transfer) {\n      // no file received\n      if (!file) return; // if was passed a file, and we can chunk it, exit here\n\n      var canChunkUpload = options.chunkUploads;\n      var shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;\n      var willChunkUpload = canChunkUpload && (shouldChunkUpload || options.chunkForce);\n      if (file instanceof Blob && willChunkUpload) return processFileChunked(apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options); // set handlers\n\n      var ondata = action.ondata || function (fd) {\n        return fd;\n      };\n\n      var onload = action.onload || function (res) {\n        return res;\n      };\n\n      var onerror = action.onerror || function (res) {\n        return null;\n      }; // create formdata object\n\n\n      var formData = new FormData(); // add metadata under same name\n\n      if (isObject(metadata)) {\n        formData.append(name, JSON.stringify(metadata));\n      } // Turn into an array of objects so no matter what the input, we can handle it the same way\n\n\n      (file instanceof Blob ? [{\n        name: null,\n        file: file\n      }] : file).forEach(function (item) {\n        formData.append(name, item.file, item.name === null ? item.file.name : '' + item.name + item.file.name);\n      }); // send request object\n\n      var request = sendRequest(ondata(formData), apiUrl + action.url, action);\n\n      request.onload = function (xhr) {\n        load(createResponse('load', xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));\n      };\n\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort; // should return request\n\n      return request;\n    };\n  };\n\n  var createProcessorFunction = function createProcessorFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    var name = arguments.length > 2 ? arguments[2] : undefined;\n    var options = arguments.length > 3 ? arguments[3] : undefined; // custom handler (should also handle file, load, error, progress and abort)\n\n    if (typeof action === 'function') return function () {\n      for (var _len = arguments.length, params = new Array(_len), _key = 0; _key < _len; _key++) {\n        params[_key] = arguments[_key];\n      }\n\n      return action.apply(void 0, [name].concat(params, [options]));\n    }; // no action supplied\n\n    if (!action || !isString(action.url)) return null; // internal handler\n\n    return createFileProcessorFunction(apiUrl, action, name, options);\n  };\n  /*\n                                                      function signature:\n                                                      (uniqueFileId, load, error) => { }\n                                                      */\n\n\n  var createRevertFunction = function createRevertFunction() {\n    var apiUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined; // is custom implementation\n\n    if (typeof action === 'function') {\n      return action;\n    } // no action supplied, return stub function, interface will work, but file won't be removed\n\n\n    if (!action || !isString(action.url)) {\n      return function (uniqueFileId, load) {\n        return load();\n      };\n    } // set onload hanlder\n\n\n    var onload = action.onload || function (res) {\n      return res;\n    };\n\n    var onerror = action.onerror || function (res) {\n      return null;\n    }; // internal implementation\n\n\n    return function (uniqueFileId, load, error) {\n      var request = sendRequest(uniqueFileId, apiUrl + action.url, action // contains method, headers and withCredentials properties\n      );\n\n      request.onload = function (xhr) {\n        load(createResponse('load', xhr.status, onload(xhr.response), xhr.getAllResponseHeaders()));\n      };\n\n      request.onerror = function (xhr) {\n        error(createResponse('error', xhr.status, onerror(xhr.response) || xhr.statusText, xhr.getAllResponseHeaders()));\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      return request;\n    };\n  };\n\n  var getRandomNumber = function getRandomNumber() {\n    var min = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var max = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    return min + Math.random() * (max - min);\n  };\n\n  var createPerceivedPerformanceUpdater = function createPerceivedPerformanceUpdater(cb) {\n    var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n    var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var tickMin = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 25;\n    var tickMax = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 250;\n    var timeout = null;\n    var start = Date.now();\n\n    var tick = function tick() {\n      var runtime = Date.now() - start;\n      var delay = getRandomNumber(tickMin, tickMax);\n\n      if (runtime + delay > duration) {\n        delay = runtime + delay - duration;\n      }\n\n      var progress = runtime / duration;\n\n      if (progress >= 1) {\n        cb(1);\n        return;\n      }\n\n      cb(progress);\n      timeout = setTimeout(tick, delay);\n    };\n\n    tick();\n    return {\n      clear: function clear() {\n        clearTimeout(timeout);\n      }\n    };\n  };\n\n  var createFileProcessor = function createFileProcessor(processFn) {\n    var state = {\n      complete: false,\n      perceivedProgress: 0,\n      perceivedPerformanceUpdater: null,\n      progress: null,\n      timestamp: null,\n      perceivedDuration: 0,\n      duration: 0,\n      request: null,\n      response: null\n    };\n\n    var process = function process(file, metadata) {\n      var progressFn = function progressFn() {\n        // we've not yet started the real download, stop here\n        // the request might not go through, for instance, there might be some server trouble\n        // if state.progress is null, the server does not allow computing progress and we show the spinner instead\n        if (state.duration === 0 || state.progress === null) {\n          return;\n        } // as we're now processing, fire the progress event\n\n\n        api.fire('progress', api.getProgress());\n      };\n\n      var completeFn = function completeFn() {\n        state.complete = true;\n        api.fire('load-perceived', state.response.body);\n      }; // let's start processing\n\n\n      api.fire('start'); // set request start\n\n      state.timestamp = Date.now(); // create perceived performance progress indicator\n\n      state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(function (progress) {\n        state.perceivedProgress = progress;\n        state.perceivedDuration = Date.now() - state.timestamp;\n        progressFn(); // if fake progress is done, and a response has been received,\n        // and we've not yet called the complete method\n\n        if (state.response && state.perceivedProgress === 1 && !state.complete) {\n          // we done!\n          completeFn();\n        }\n      }, // random delay as in a list of files you start noticing\n      // files uploading at the exact same speed\n      getRandomNumber(750, 1500)); // remember request so we can abort it later\n\n      state.request = processFn( // the file to process\n      file, // the metadata to send along\n      metadata, // callbacks (load, error, progress, abort, transfer)\n      // load expects the body to be a server id if\n      // you want to make use of revert\n      function (response) {\n        // we put the response in state so we can access\n        // it outside of this method\n        state.response = isObject(response) ? response : {\n          type: 'load',\n          code: 200,\n          body: '' + response,\n          headers: {}\n        }; // update duration\n\n        state.duration = Date.now() - state.timestamp; // force progress to 1 as we're now done\n\n        state.progress = 1; // actual load is done let's share results\n\n        api.fire('load', state.response.body); // we are really done\n        // if perceived progress is 1 ( wait for perceived progress to complete )\n        // or if server does not support progress ( null )\n\n        if (state.perceivedProgress === 1) {\n          completeFn();\n        }\n      }, // error is expected to be an object with type, code, body\n      function (error) {\n        // cancel updater\n        state.perceivedPerformanceUpdater.clear(); // update others about this error\n\n        api.fire('error', isObject(error) ? error : {\n          type: 'error',\n          code: 0,\n          body: '' + error\n        });\n      }, // actual processing progress\n      function (computable, current, total) {\n        // update actual duration\n        state.duration = Date.now() - state.timestamp; // update actual progress\n\n        state.progress = computable ? current / total : null;\n        progressFn();\n      }, // abort does not expect a value\n      function () {\n        // stop updater\n        state.perceivedPerformanceUpdater.clear(); // fire the abort event so we can switch visuals\n\n        api.fire('abort', state.response ? state.response.body : null);\n      }, // register the id for this transfer\n      function (transferId) {\n        api.fire('transfer', transferId);\n      });\n    };\n\n    var abort = function abort() {\n      // no request running, can't abort\n      if (!state.request) return; // stop updater\n\n      state.perceivedPerformanceUpdater.clear(); // abort actual request\n\n      state.request.abort(); // if has response object, we've completed the request\n\n      state.complete = true;\n    };\n\n    var reset = function reset() {\n      abort();\n      state.complete = false;\n      state.perceivedProgress = 0;\n      state.progress = 0;\n      state.timestamp = null;\n      state.perceivedDuration = 0;\n      state.duration = 0;\n      state.request = null;\n      state.response = null;\n    };\n\n    var getProgress = function getProgress() {\n      return state.progress ? Math.min(state.progress, state.perceivedProgress) : null;\n    };\n\n    var getDuration = function getDuration() {\n      return Math.min(state.duration, state.perceivedDuration);\n    };\n\n    var api = Object.assign({}, on(), {\n      process: process,\n      // start processing file\n      abort: abort,\n      // abort active process request\n      getProgress: getProgress,\n      getDuration: getDuration,\n      reset: reset\n    });\n    return api;\n  };\n\n  var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {\n    return name.substr(0, name.lastIndexOf('.')) || name;\n  };\n\n  var createFileStub = function createFileStub(source) {\n    var data = [source.name, source.size, source.type]; // is blob or base64, then we need to set the name\n\n    if (source instanceof Blob || isBase64DataURI(source)) {\n      data[0] = source.name || getDateString();\n    } else if (isBase64DataURI(source)) {\n      // if is base64 data uri we need to determine the average size and type\n      data[1] = source.length;\n      data[2] = getMimeTypeFromBase64DataURI(source);\n    } else if (isString(source)) {\n      // url\n      data[0] = getFilenameFromURL(source);\n      data[1] = 0;\n      data[2] = 'application/octet-stream';\n    }\n\n    return {\n      name: data[0],\n      size: data[1],\n      type: data[2]\n    };\n  };\n\n  var isFile = function isFile(value) {\n    return !!(value instanceof File || value instanceof Blob && value.name);\n  };\n\n  var deepCloneObject = function deepCloneObject(src) {\n    if (!isObject(src)) return src;\n    var target = isArray(src) ? [] : {};\n\n    for (var key in src) {\n      if (!src.hasOwnProperty(key)) continue;\n      var v = src[key];\n      target[key] = v && isObject(v) ? deepCloneObject(v) : v;\n    }\n\n    return target;\n  };\n\n  var createItem = function createItem() {\n    var origin = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var serverFileReference = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var file = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null; // unique id for this item, is used to identify the item across views\n\n    var id = getUniqueId();\n    /**\n     * Internal item state\n     */\n\n    var state = {\n      // is archived\n      archived: false,\n      // if is frozen, no longer fires events\n      frozen: false,\n      // removed from view\n      released: false,\n      // original source\n      source: null,\n      // file model reference\n      file: file,\n      // id of file on server\n      serverFileReference: serverFileReference,\n      // id of file transfer on server\n      transferId: null,\n      // is aborted\n      processingAborted: false,\n      // current item status\n      status: serverFileReference ? ItemStatus.PROCESSING_COMPLETE : ItemStatus.INIT,\n      // active processes\n      activeLoader: null,\n      activeProcessor: null\n    }; // callback used when abort processing is called to link back to the resolve method\n\n    var abortProcessingRequestComplete = null;\n    /**\n     * Externally added item metadata\n     */\n\n    var metadata = {}; // item data\n\n    var setStatus = function setStatus(status) {\n      return state.status = status;\n    }; // fire event unless the item has been archived\n\n\n    var fire = function fire(event) {\n      if (state.released || state.frozen) return;\n\n      for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        params[_key - 1] = arguments[_key];\n      }\n\n      api.fire.apply(api, [event].concat(params));\n    }; // file data\n\n\n    var getFileExtension = function getFileExtension() {\n      return getExtensionFromFilename(state.file.name);\n    };\n\n    var getFileType = function getFileType() {\n      return state.file.type;\n    };\n\n    var getFileSize = function getFileSize() {\n      return state.file.size;\n    };\n\n    var getFile = function getFile() {\n      return state.file;\n    }; //\n    // logic to load a file\n    //\n\n\n    var load = function load(source, loader, onload) {\n      // remember the original item source\n      state.source = source; // file stub is already there\n\n      if (state.file) {\n        fire('load-skip');\n        return;\n      } // set a stub file object while loading the actual data\n\n\n      state.file = createFileStub(source); // starts loading\n\n      loader.on('init', function () {\n        fire('load-init');\n      }); // we'eve received a size indication, let's update the stub\n\n      loader.on('meta', function (meta) {\n        // set size of file stub\n        state.file.size = meta.size; // set name of file stub\n\n        state.file.filename = meta.filename; // if has received source, we done\n\n        if (meta.source) {\n          origin = FileOrigin.LIMBO;\n          state.serverFileReference = meta.source;\n          state.status = ItemStatus.PROCESSING_COMPLETE;\n        } // size has been updated\n\n\n        fire('load-meta');\n      }); // the file is now loading we need to update the progress indicators\n\n      loader.on('progress', function (progress) {\n        setStatus(ItemStatus.LOADING);\n        fire('load-progress', progress);\n      }); // an error was thrown while loading the file, we need to switch to error state\n\n      loader.on('error', function (error) {\n        setStatus(ItemStatus.LOAD_ERROR);\n        fire('load-request-error', error);\n      }); // user or another process aborted the file load (cannot retry)\n\n      loader.on('abort', function () {\n        setStatus(ItemStatus.INIT);\n        fire('load-abort');\n      }); // done loading\n\n      loader.on('load', function (file) {\n        // as we've now loaded the file the loader is no longer required\n        state.activeLoader = null; // called when file has loaded succesfully\n\n        var success = function success(result) {\n          // set (possibly) transformed file\n          state.file = isFile(result) ? result : state.file; // file received\n\n          if (origin === FileOrigin.LIMBO && state.serverFileReference) {\n            setStatus(ItemStatus.PROCESSING_COMPLETE);\n          } else {\n            setStatus(ItemStatus.IDLE);\n          }\n\n          fire('load');\n        };\n\n        var error = function error(result) {\n          // set original file\n          state.file = file;\n          fire('load-meta');\n          setStatus(ItemStatus.LOAD_ERROR);\n          fire('load-file-error', result);\n        }; // if we already have a server file reference, we don't need to call the onload method\n\n\n        if (state.serverFileReference) {\n          success(file);\n          return;\n        } // no server id, let's give this file the full treatment\n\n\n        onload(file, success, error);\n      }); // set loader source data\n\n      loader.setSource(source); // set as active loader\n\n      state.activeLoader = loader; // load the source data\n\n      loader.load();\n    };\n\n    var retryLoad = function retryLoad() {\n      if (!state.activeLoader) {\n        return;\n      }\n\n      state.activeLoader.load();\n    };\n\n    var abortLoad = function abortLoad() {\n      if (state.activeLoader) {\n        state.activeLoader.abort();\n        return;\n      }\n\n      setStatus(ItemStatus.INIT);\n      fire('load-abort');\n    }; //\n    // logic to process a file\n    //\n\n\n    var process = function process(processor, onprocess) {\n      // processing was aborted\n      if (state.processingAborted) {\n        state.processingAborted = false;\n        return;\n      } // now processing\n\n\n      setStatus(ItemStatus.PROCESSING); // reset abort callback\n\n      abortProcessingRequestComplete = null; // if no file loaded we'll wait for the load event\n\n      if (!(state.file instanceof Blob)) {\n        api.on('load', function () {\n          process(processor, onprocess);\n        });\n        return;\n      } // setup processor\n\n\n      processor.on('load', function (serverFileReference) {\n        // need this id to be able to revert the upload\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n      }); // register transfer id\n\n      processor.on('transfer', function (transferId) {\n        // need this id to be able to revert the upload\n        state.transferId = transferId;\n      });\n      processor.on('load-perceived', function (serverFileReference) {\n        // no longer required\n        state.activeProcessor = null; // need this id to be able to rever the upload\n\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n        setStatus(ItemStatus.PROCESSING_COMPLETE);\n        fire('process-complete', serverFileReference);\n      });\n      processor.on('start', function () {\n        fire('process-start');\n      });\n      processor.on('error', function (error) {\n        state.activeProcessor = null;\n        setStatus(ItemStatus.PROCESSING_ERROR);\n        fire('process-error', error);\n      });\n      processor.on('abort', function (serverFileReference) {\n        state.activeProcessor = null; // if file was uploaded but processing was cancelled during perceived processor time store file reference\n\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n        setStatus(ItemStatus.IDLE);\n        fire('process-abort'); // has timeout so doesn't interfere with remove action\n\n        if (abortProcessingRequestComplete) {\n          abortProcessingRequestComplete();\n        }\n      });\n      processor.on('progress', function (progress) {\n        fire('process-progress', progress);\n      }); // when successfully transformed\n\n      var success = function success(file) {\n        // if was archived in the mean time, don't process\n        if (state.archived) return; // process file!\n\n        processor.process(file, Object.assign({}, metadata));\n      }; // something went wrong during transform phase\n\n\n      var error = console.error; // start processing the file\n\n      onprocess(state.file, success, error); // set as active processor\n\n      state.activeProcessor = processor;\n    };\n\n    var requestProcessing = function requestProcessing() {\n      state.processingAborted = false;\n      setStatus(ItemStatus.PROCESSING_QUEUED);\n    };\n\n    var abortProcessing = function abortProcessing() {\n      return new Promise(function (resolve) {\n        if (!state.activeProcessor) {\n          state.processingAborted = true;\n          setStatus(ItemStatus.IDLE);\n          fire('process-abort');\n          resolve();\n          return;\n        }\n\n        abortProcessingRequestComplete = function abortProcessingRequestComplete() {\n          resolve();\n        };\n\n        state.activeProcessor.abort();\n      });\n    }; //\n    // logic to revert a processed file\n    //\n\n\n    var revert = function revert(revertFileUpload, forceRevert) {\n      return new Promise(function (resolve, reject) {\n        // cannot revert without a server id for this process\n        if (state.serverFileReference === null) {\n          resolve();\n          return;\n        } // revert the upload (fire and forget)\n\n\n        revertFileUpload(state.serverFileReference, function () {\n          // reset file server id as now it's no available on the server\n          state.serverFileReference = null;\n          resolve();\n        }, function (error) {\n          // don't set error state when reverting is optional, it will always resolve\n          if (!forceRevert) {\n            resolve();\n            return;\n          } // oh no errors\n\n\n          setStatus(ItemStatus.PROCESSING_REVERT_ERROR);\n          fire('process-revert-error');\n          reject(error);\n        }); // fire event\n\n        setStatus(ItemStatus.IDLE);\n        fire('process-revert');\n      });\n    }; // exposed methods\n\n\n    var _setMetadata = function setMetadata(key, value, silent) {\n      var keys = key.split('.');\n      var root = keys[0];\n      var last = keys.pop();\n      var data = metadata;\n      keys.forEach(function (key) {\n        return data = data[key];\n      }); // compare old value against new value, if they're the same, we're not updating\n\n      if (JSON.stringify(data[last]) === JSON.stringify(value)) return; // update value\n\n      data[last] = value; // don't fire update\n\n      if (silent) return; // fire update\n\n      fire('metadata-update', {\n        key: root,\n        value: metadata[root]\n      });\n    };\n\n    var getMetadata = function getMetadata(key) {\n      return deepCloneObject(key ? metadata[key] : metadata);\n    };\n\n    var api = Object.assign({\n      id: {\n        get: function get() {\n          return id;\n        }\n      },\n      origin: {\n        get: function get() {\n          return origin;\n        }\n      },\n      serverId: {\n        get: function get() {\n          return state.serverFileReference;\n        }\n      },\n      transferId: {\n        get: function get() {\n          return state.transferId;\n        }\n      },\n      status: {\n        get: function get() {\n          return state.status;\n        }\n      },\n      filename: {\n        get: function get() {\n          return state.file.name;\n        }\n      },\n      filenameWithoutExtension: {\n        get: function get() {\n          return getFilenameWithoutExtension(state.file.name);\n        }\n      },\n      fileExtension: {\n        get: getFileExtension\n      },\n      fileType: {\n        get: getFileType\n      },\n      fileSize: {\n        get: getFileSize\n      },\n      file: {\n        get: getFile\n      },\n      source: {\n        get: function get() {\n          return state.source;\n        }\n      },\n      getMetadata: getMetadata,\n      setMetadata: function setMetadata(key, value, silent) {\n        if (isObject(key)) {\n          var data = key;\n          Object.keys(data).forEach(function (key) {\n            _setMetadata(key, data[key], value);\n          });\n          return key;\n        }\n\n        _setMetadata(key, value, silent);\n\n        return value;\n      },\n      extend: function extend(name, handler) {\n        return itemAPI[name] = handler;\n      },\n      abortLoad: abortLoad,\n      retryLoad: retryLoad,\n      requestProcessing: requestProcessing,\n      abortProcessing: abortProcessing,\n      load: load,\n      process: process,\n      revert: revert\n    }, on(), {\n      freeze: function freeze() {\n        return state.frozen = true;\n      },\n      release: function release() {\n        return state.released = true;\n      },\n      released: {\n        get: function get() {\n          return state.released;\n        }\n      },\n      archive: function archive() {\n        return state.archived = true;\n      },\n      archived: {\n        get: function get() {\n          return state.archived;\n        }\n      }\n    }); // create it here instead of returning it instantly so we can extend it later\n\n    var itemAPI = createObject(api);\n    return itemAPI;\n  };\n\n  var getItemIndexByQuery = function getItemIndexByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return 0;\n    } // invalid queries\n\n\n    if (!isString(query)) {\n      return -1;\n    } // return item by id (or -1 if not found)\n\n\n    return items.findIndex(function (item) {\n      return item.id === query;\n    });\n  };\n\n  var getItemById = function getItemById(items, itemId) {\n    var index = getItemIndexByQuery(items, itemId);\n\n    if (index < 0) {\n      return;\n    }\n\n    return items[index] || null;\n  };\n\n  var fetchLocal = function fetchLocal(url, load, error, progress, abort, headers) {\n    var request = sendRequest(null, url, {\n      method: 'GET',\n      responseType: 'blob'\n    });\n\n    request.onload = function (xhr) {\n      // get headers\n      var headers = xhr.getAllResponseHeaders(); // get filename\n\n      var filename = getFileInfoFromHeaders(headers).name || getFilenameFromURL(url); // create response\n\n      load(createResponse('load', xhr.status, getFileFromBlob(xhr.response, filename), headers));\n    };\n\n    request.onerror = function (xhr) {\n      error(createResponse('error', xhr.status, xhr.statusText, xhr.getAllResponseHeaders()));\n    };\n\n    request.onheaders = function (xhr) {\n      headers(createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders()));\n    };\n\n    request.ontimeout = createTimeoutResponse(error);\n    request.onprogress = progress;\n    request.onabort = abort; // should return request\n\n    return request;\n  };\n\n  var getDomainFromURL = function getDomainFromURL(url) {\n    if (url.indexOf('//') === 0) {\n      url = location.protocol + url;\n    }\n\n    return url.toLowerCase().replace('blob:', '').replace(/([a-z])?:\\/\\//, '$1').split('/')[0];\n  };\n\n  var isExternalURL = function isExternalURL(url) {\n    return (url.indexOf(':') > -1 || url.indexOf('//') > -1) && getDomainFromURL(location.href) !== getDomainFromURL(url);\n  };\n\n  var dynamicLabel = function dynamicLabel(label) {\n    return function () {\n      return isFunction(label) ? label.apply(void 0, arguments) : label;\n    };\n  };\n\n  var isMockItem = function isMockItem(item) {\n    return !isFile(item.file);\n  };\n\n  var listUpdated = function listUpdated(dispatch, state) {\n    clearTimeout(state.listUpdateTimeout);\n    state.listUpdateTimeout = setTimeout(function () {\n      dispatch('DID_UPDATE_ITEMS', {\n        items: getActiveItems(state.items)\n      });\n    }, 0);\n  };\n\n  var optionalPromise = function optionalPromise(fn) {\n    for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      params[_key - 1] = arguments[_key];\n    }\n\n    return new Promise(function (resolve) {\n      if (!fn) {\n        return resolve(true);\n      }\n\n      var result = fn.apply(void 0, params);\n\n      if (result == null) {\n        return resolve(true);\n      }\n\n      if (typeof result === 'boolean') {\n        return resolve(result);\n      }\n\n      if (typeof result.then === 'function') {\n        result.then(resolve);\n      }\n    });\n  };\n\n  var sortItems = function sortItems(state, compare) {\n    state.items.sort(function (a, b) {\n      return compare(createItemAPI(a), createItemAPI(b));\n    });\n  }; // returns item based on state\n\n\n  var getItemByQueryFromState = function getItemByQueryFromState(state, itemHandler) {\n    return function () {\n      var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          query = _ref.query,\n          _ref$success = _ref.success,\n          success = _ref$success === void 0 ? function () {} : _ref$success,\n          _ref$failure = _ref.failure,\n          failure = _ref$failure === void 0 ? function () {} : _ref$failure;\n\n      var item = getItemByQuery(state.items, query);\n\n      if (!item) {\n        failure({\n          error: createResponse('error', 0, 'Item not found'),\n          file: null\n        });\n        return;\n      }\n\n      itemHandler(item, success, failure);\n    };\n  };\n\n  var actions = function actions(dispatch, query, state) {\n    return {\n      /**\n       * Aborts all ongoing processes\n       */\n      ABORT_ALL: function ABORT_ALL() {\n        getActiveItems(state.items).forEach(function (item) {\n          item.freeze();\n          item.abortLoad();\n          item.abortProcessing();\n        });\n      },\n\n      /**\n       * Sets initial files\n       */\n      DID_SET_FILES: function DID_SET_FILES(_ref2) {\n        var _ref2$value = _ref2.value,\n            value = _ref2$value === void 0 ? [] : _ref2$value; // map values to file objects\n\n        var files = value.map(function (file) {\n          return {\n            source: file.source ? file.source : file,\n            options: file.options\n          };\n        }); // loop over files, if file is in list, leave it be, if not, remove\n        // test if items should be moved\n\n        var activeItems = getActiveItems(state.items);\n        activeItems.forEach(function (item) {\n          // if item not is in new value, remove\n          if (!files.find(function (file) {\n            return file.source === item.source || file.source === item.file;\n          })) {\n            dispatch('REMOVE_ITEM', {\n              query: item\n            });\n          }\n        }); // add new files\n\n        activeItems = getActiveItems(state.items);\n        files.forEach(function (file, index) {\n          // if file is already in list\n          if (activeItems.find(function (item) {\n            return item.source === file.source || item.file === file.source;\n          })) return; // not in list, add\n\n          dispatch('ADD_ITEM', Object.assign({}, file, {\n            interactionMethod: InteractionMethod.NONE,\n            index: index\n          }));\n        });\n      },\n      DID_UPDATE_ITEM_METADATA: function DID_UPDATE_ITEM_METADATA(_ref3) {\n        var id = _ref3.id; // if is called multiple times in close succession we combined all calls together to save resources\n\n        clearTimeout(state.itemUpdateTimeout);\n        state.itemUpdateTimeout = setTimeout(function () {\n          var item = getItemById(state.items, id); // only revert and attempt to upload when we're uploading to a server\n\n          if (!query('IS_ASYNC')) {\n            // should we update the output data\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query\n            }).then(function (shouldPrepareOutput) {\n              if (!shouldPrepareOutput) {\n                return;\n              }\n\n              dispatch('REQUEST_PREPARE_OUTPUT', {\n                query: id,\n                item: item,\n                ready: function ready(file) {\n                  dispatch('DID_PREPARE_OUTPUT', {\n                    id: id,\n                    file: file\n                  });\n                }\n              }, true);\n            });\n            return;\n          } // for async scenarios\n\n\n          var upload = function upload() {\n            // we push this forward a bit so the interface is updated correctly\n            setTimeout(function () {\n              dispatch('REQUEST_ITEM_PROCESSING', {\n                query: id\n              });\n            }, 32);\n          };\n\n          var revert = function revert(doUpload) {\n            item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(doUpload ? upload : function () {}).catch(function () {});\n          };\n\n          var abort = function abort(doUpload) {\n            item.abortProcessing().then(doUpload ? upload : function () {});\n          }; // if we should re-upload the file immidiately\n\n\n          if (item.status === ItemStatus.PROCESSING_COMPLETE) {\n            return revert(state.options.instantUpload);\n          } // if currently uploading, cancel upload\n\n\n          if (item.status === ItemStatus.PROCESSING) {\n            return abort(state.options.instantUpload);\n          }\n\n          if (state.options.instantUpload) {\n            upload();\n          }\n        }, 0);\n      },\n      SORT: function SORT(_ref4) {\n        var compare = _ref4.compare;\n        sortItems(state, compare);\n      },\n      ADD_ITEMS: function ADD_ITEMS(_ref5) {\n        var items = _ref5.items,\n            index = _ref5.index,\n            interactionMethod = _ref5.interactionMethod,\n            _ref5$success = _ref5.success,\n            success = _ref5$success === void 0 ? function () {} : _ref5$success,\n            _ref5$failure = _ref5.failure,\n            failure = _ref5$failure === void 0 ? function () {} : _ref5$failure;\n        var currentIndex = index;\n\n        if (index === -1 || typeof index === 'undefined') {\n          var insertLocation = query('GET_ITEM_INSERT_LOCATION');\n          var totalItems = query('GET_TOTAL_ITEMS');\n          currentIndex = insertLocation === 'before' ? 0 : totalItems;\n        }\n\n        var ignoredFiles = query('GET_IGNORED_FILES');\n\n        var isValidFile = function isValidFile(source) {\n          return isFile(source) ? !ignoredFiles.includes(source.name.toLowerCase()) : !isEmpty(source);\n        };\n\n        var validItems = items.filter(isValidFile);\n        var promises = validItems.map(function (source) {\n          return new Promise(function (resolve, reject) {\n            dispatch('ADD_ITEM', {\n              interactionMethod: interactionMethod,\n              source: source.source || source,\n              success: resolve,\n              failure: reject,\n              index: currentIndex++,\n              options: source.options || {}\n            });\n          });\n        });\n        Promise.all(promises).then(success).catch(failure);\n      },\n\n      /**\n       * @param source\n       * @param index\n       * @param interactionMethod\n       */\n      ADD_ITEM: function ADD_ITEM(_ref6) {\n        var source = _ref6.source,\n            _ref6$index = _ref6.index,\n            index = _ref6$index === void 0 ? -1 : _ref6$index,\n            interactionMethod = _ref6.interactionMethod,\n            _ref6$success = _ref6.success,\n            success = _ref6$success === void 0 ? function () {} : _ref6$success,\n            _ref6$failure = _ref6.failure,\n            failure = _ref6$failure === void 0 ? function () {} : _ref6$failure,\n            _ref6$options = _ref6.options,\n            options = _ref6$options === void 0 ? {} : _ref6$options; // if no source supplied\n\n        if (isEmpty(source)) {\n          failure({\n            error: createResponse('error', 0, 'No source'),\n            file: null\n          });\n          return;\n        } // filter out invalid file items, used to filter dropped directory contents\n\n\n        if (isFile(source) && state.options.ignoredFiles.includes(source.name.toLowerCase())) {\n          // fail silently\n          return;\n        } // test if there's still room in the list of files\n\n\n        if (!hasRoomForItem(state)) {\n          // if multiple allowed, we can't replace\n          // or if only a single item is allowed but we're not allowed to replace it we exit\n          if (state.options.allowMultiple || !state.options.allowMultiple && !state.options.allowReplace) {\n            var error = createResponse('warning', 0, 'Max files');\n            dispatch('DID_THROW_MAX_FILES', {\n              source: source,\n              error: error\n            });\n            failure({\n              error: error,\n              file: null\n            });\n            return;\n          } // let's replace the item\n          // id of first item we're about to remove\n\n\n          var _item = getActiveItems(state.items)[0]; // if has been processed remove it from the server as well\n\n          if (_item.status === ItemStatus.PROCESSING_COMPLETE || _item.status === ItemStatus.PROCESSING_REVERT_ERROR) {\n            var forceRevert = query('GET_FORCE_REVERT');\n\n            _item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), forceRevert).then(function () {\n              if (!forceRevert) return; // try to add now\n\n              dispatch('ADD_ITEM', {\n                source: source,\n                index: index,\n                interactionMethod: interactionMethod,\n                success: success,\n                failure: failure,\n                options: options\n              });\n            }).catch(function () {}); // no need to handle this catch state for now\n\n\n            if (forceRevert) return;\n          } // remove first item as it will be replaced by this item\n\n\n          dispatch('REMOVE_ITEM', {\n            query: _item.id\n          });\n        } // where did the file originate\n\n\n        var origin = options.type === 'local' ? FileOrigin.LOCAL : options.type === 'limbo' ? FileOrigin.LIMBO : FileOrigin.INPUT; // create a new blank item\n\n        var item = createItem( // where did this file come from\n        origin, // an input file never has a server file reference\n        origin === FileOrigin.INPUT ? null : source, // file mock data, if defined\n        options.file); // set initial meta data\n\n        Object.keys(options.metadata || {}).forEach(function (key) {\n          item.setMetadata(key, options.metadata[key]);\n        }); // created the item, let plugins add methods\n\n        applyFilters('DID_CREATE_ITEM', item, {\n          query: query,\n          dispatch: dispatch\n        }); // where to insert new items\n\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION'); // adjust index if is not allowed to pick location\n\n        if (!state.options.itemInsertLocationFreedom) {\n          index = itemInsertLocation === 'before' ? -1 : state.items.length;\n        } // add item to list\n\n\n        insertItem(state.items, item, index); // sort items in list\n\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        } // get a quick reference to the item id\n\n\n        var id = item.id; // observe item events\n\n        item.on('load-init', function () {\n          dispatch('DID_START_ITEM_LOAD', {\n            id: id\n          });\n        });\n        item.on('load-meta', function () {\n          dispatch('DID_UPDATE_ITEM_META', {\n            id: id\n          });\n        });\n        item.on('load-progress', function (progress) {\n          dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n        item.on('load-request-error', function (error) {\n          var mainStatus = dynamicLabel(state.options.labelFileLoadError)(error); // is client error, no way to recover\n\n          if (error.code >= 400 && error.code < 500) {\n            dispatch('DID_THROW_ITEM_INVALID', {\n              id: id,\n              error: error,\n              status: {\n                main: mainStatus,\n                sub: error.code + ' (' + error.body + ')'\n              }\n            }); // reject the file so can be dealt with through API\n\n            failure({\n              error: error,\n              file: createItemAPI(item)\n            });\n            return;\n          } // is possible server error, so might be possible to retry\n\n\n          dispatch('DID_THROW_ITEM_LOAD_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: mainStatus,\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('load-file-error', function (error) {\n          dispatch('DID_THROW_ITEM_INVALID', {\n            id: id,\n            error: error.status,\n            status: error.status\n          });\n          failure({\n            error: error.status,\n            file: createItemAPI(item)\n          });\n        });\n        item.on('load-abort', function () {\n          dispatch('REMOVE_ITEM', {\n            query: id\n          });\n        });\n        item.on('load-skip', function () {\n          dispatch('COMPLETE_LOAD_ITEM', {\n            query: id,\n            item: item,\n            data: {\n              source: source,\n              success: success\n            }\n          });\n        });\n        item.on('load', function () {\n          var handleAdd = function handleAdd(shouldAdd) {\n            // no should not add this file\n            if (!shouldAdd) {\n              dispatch('REMOVE_ITEM', {\n                query: id\n              });\n              return;\n            } // now interested in metadata updates\n\n\n            item.on('metadata-update', function (change) {\n              dispatch('DID_UPDATE_ITEM_METADATA', {\n                id: id,\n                change: change\n              });\n            }); // let plugins decide if the output data should be prepared at this point\n            // means we'll do this and wait for idle state\n\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query\n            }).then(function (shouldPrepareOutput) {\n              var loadComplete = function loadComplete() {\n                dispatch('COMPLETE_LOAD_ITEM', {\n                  query: id,\n                  item: item,\n                  data: {\n                    source: source,\n                    success: success\n                  }\n                });\n                listUpdated(dispatch, state);\n              }; // exit\n\n\n              if (shouldPrepareOutput) {\n                // wait for idle state and then run PREPARE_OUTPUT\n                dispatch('REQUEST_PREPARE_OUTPUT', {\n                  query: id,\n                  item: item,\n                  ready: function ready(file) {\n                    dispatch('DID_PREPARE_OUTPUT', {\n                      id: id,\n                      file: file\n                    });\n                    loadComplete();\n                  }\n                }, true);\n                return;\n              }\n\n              loadComplete();\n            });\n          }; // item loaded, allow plugins to\n          // - read data (quickly)\n          // - add metadata\n\n\n          applyFilterChain('DID_LOAD_ITEM', item, {\n            query: query,\n            dispatch: dispatch\n          }).then(function () {\n            optionalPromise(query('GET_BEFORE_ADD_FILE'), createItemAPI(item)).then(handleAdd);\n          }).catch(function () {\n            handleAdd(false);\n          });\n        });\n        item.on('process-start', function () {\n          dispatch('DID_START_ITEM_PROCESSING', {\n            id: id\n          });\n        });\n        item.on('process-progress', function (progress) {\n          dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n        item.on('process-error', function (error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingError)(error),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('process-revert-error', function (error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingRevertError)(error),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n        item.on('process-complete', function (serverFileReference) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: id,\n            error: null,\n            serverFileReference: serverFileReference\n          });\n        });\n        item.on('process-abort', function () {\n          dispatch('DID_ABORT_ITEM_PROCESSING', {\n            id: id\n          });\n        });\n        item.on('process-revert', function () {\n          dispatch('DID_REVERT_ITEM_PROCESSING', {\n            id: id\n          });\n        }); // let view know the item has been inserted\n\n        dispatch('DID_ADD_ITEM', {\n          id: id,\n          index: index,\n          interactionMethod: interactionMethod\n        });\n        listUpdated(dispatch, state); // start loading the source\n\n        var _ref7 = state.options.server || {},\n            url = _ref7.url,\n            load = _ref7.load,\n            restore = _ref7.restore,\n            fetch = _ref7.fetch;\n\n        item.load(source, // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)\n        createFileLoader(origin === FileOrigin.INPUT ? // input\n        isString(source) && isExternalURL(source) ? createFetchFunction(url, fetch) // remote url\n        : fetchLocal // local url\n        : // limbo or local\n        origin === FileOrigin.LIMBO ? createFetchFunction(url, restore) // limbo\n        : createFetchFunction(url, load) // local\n        ), // called when the file is loaded so it can be piped through the filters\n        function (file, success, error) {\n          // let's process the file\n          applyFilterChain('LOAD_FILE', file, {\n            query: query\n          }).then(success).catch(error);\n        });\n      },\n      REQUEST_PREPARE_OUTPUT: function REQUEST_PREPARE_OUTPUT(_ref8) {\n        var item = _ref8.item,\n            ready = _ref8.ready; // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared\n\n        if (item.archived) return; // allow plugins to alter the file data\n\n        applyFilterChain('PREPARE_OUTPUT', item.file, {\n          query: query,\n          item: item\n        }).then(function (result) {\n          applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, {\n            query: query,\n            item: item\n          }).then(function (result) {\n            // don't handle archived items, an item could have been archived (load aborted) while being prepared\n            if (item.archived) return; // we done!\n\n            ready(result);\n          });\n        });\n      },\n      COMPLETE_LOAD_ITEM: function COMPLETE_LOAD_ITEM(_ref9) {\n        var item = _ref9.item,\n            data = _ref9.data;\n        var success = data.success,\n            source = data.source; // sort items in list\n\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        } // let interface know the item has loaded\n\n\n        dispatch('DID_LOAD_ITEM', {\n          id: item.id,\n          error: null,\n          serverFileReference: item.origin === FileOrigin.INPUT ? null : source\n        }); // item has been successfully loaded and added to the\n        // list of items so can now be safely returned for use\n\n        success(createItemAPI(item)); // if this is a local server file we need to show a different state\n\n        if (item.origin === FileOrigin.LOCAL) {\n          dispatch('DID_LOAD_LOCAL_ITEM', {\n            id: item.id\n          });\n          return;\n        } // if is a temp server file we prevent async upload call here (as the file is already on the server)\n\n\n        if (item.origin === FileOrigin.LIMBO) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: item.id,\n            error: null,\n            serverFileReference: source\n          });\n          return;\n        } // id we are allowed to upload the file immidiately, lets do it\n\n\n        if (query('IS_ASYNC') && state.options.instantUpload) {\n          dispatch('REQUEST_ITEM_PROCESSING', {\n            query: item.id\n          });\n        }\n      },\n      RETRY_ITEM_LOAD: getItemByQueryFromState(state, function (item) {\n        // try loading the source one more time\n        item.retryLoad();\n      }),\n      REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, function (item, success, failure) {\n        // cannot be queued (or is already queued)\n        var itemCanBeQueuedForProcessing = // waiting for something\n        item.status === ItemStatus.IDLE || // processing went wrong earlier\n        item.status === ItemStatus.PROCESSING_ERROR; // not ready to be processed\n\n        if (!itemCanBeQueuedForProcessing) {\n          var process = function process() {\n            setTimeout(function () {\n              dispatch('REQUEST_ITEM_PROCESSING', {\n                query: item,\n                success: success,\n                failure: failure\n              });\n            }, 32);\n          }; // if already done processing or tried to revert but didn't work, try again\n\n\n          if (item.status === ItemStatus.PROCESSING_COMPLETE || item.status === ItemStatus.PROCESSING_REVERT_ERROR) {\n            item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(process).catch(function () {}); // don't continue with processing if something went wrong\n          } else if (item.status === ItemStatus.PROCESSING) {\n            item.abortProcessing().then(process);\n          }\n\n          return;\n        } // already queued for processing\n\n\n        if (item.status === ItemStatus.PROCESSING_QUEUED) return;\n        item.requestProcessing();\n        dispatch('DID_REQUEST_ITEM_PROCESSING', {\n          id: item.id\n        });\n        dispatch('PROCESS_ITEM', {\n          query: item,\n          success: success,\n          failure: failure\n        }, true);\n      }),\n      PROCESS_ITEM: getItemByQueryFromState(state, function (item, success, failure) {\n        var maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');\n        var totalCurrentUploads = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING).length; // queue and wait till queue is freed up\n\n        if (totalCurrentUploads === maxParallelUploads) {\n          // queue for later processing\n          state.processingQueue.push({\n            id: item.id,\n            success: success,\n            failure: failure\n          }); // stop it!\n\n          return;\n        } // if was not queued or is already processing exit here\n\n\n        if (item.status === ItemStatus.PROCESSING) return;\n\n        var processNext = function processNext() {\n          // process queueud items\n          var queueEntry = state.processingQueue.shift(); // no items left\n\n          if (!queueEntry) return; // get item reference\n\n          var id = queueEntry.id,\n              success = queueEntry.success,\n              failure = queueEntry.failure;\n          var itemReference = getItemByQuery(state.items, id); // if item was archived while in queue, jump to next\n\n          if (!itemReference || itemReference.archived) {\n            processNext();\n            return;\n          } // process queued item\n\n\n          dispatch('PROCESS_ITEM', {\n            query: id,\n            success: success,\n            failure: failure\n          }, true);\n        }; // we done function\n\n\n        item.onOnce('process-complete', function () {\n          success(createItemAPI(item));\n          processNext(); // All items processed? No errors?\n\n          var allItemsProcessed = query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE).length === state.items.length;\n\n          if (allItemsProcessed) {\n            dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');\n          }\n        }); // we error function\n\n        item.onOnce('process-error', function (error) {\n          failure({\n            error: error,\n            file: createItemAPI(item)\n          });\n          processNext();\n        }); // start file processing\n\n        var options = state.options;\n        item.process(createFileProcessor(createProcessorFunction(options.server.url, options.server.process, options.name, {\n          chunkTransferId: item.transferId,\n          chunkServer: options.server.patch,\n          chunkUploads: options.chunkUploads,\n          chunkForce: options.chunkForce,\n          chunkSize: options.chunkSize,\n          chunkRetryDelays: options.chunkRetryDelays\n        })), // called when the file is about to be processed so it can be piped through the transform filters\n        function (file, success, error) {\n          // allow plugins to alter the file data\n          applyFilterChain('PREPARE_OUTPUT', file, {\n            query: query,\n            item: item\n          }).then(function (file) {\n            dispatch('DID_PREPARE_OUTPUT', {\n              id: item.id,\n              file: file\n            });\n            success(file);\n          }).catch(error);\n        });\n      }),\n      RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        dispatch('REQUEST_ITEM_PROCESSING', {\n          query: item\n        });\n      }),\n      REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, function (item) {\n        optionalPromise(query('GET_BEFORE_REMOVE_FILE'), createItemAPI(item)).then(function (shouldRemove) {\n          if (!shouldRemove) {\n            return;\n          }\n\n          dispatch('REMOVE_ITEM', {\n            query: item\n          });\n        });\n      }),\n      RELEASE_ITEM: getItemByQueryFromState(state, function (item) {\n        item.release();\n      }),\n      REMOVE_ITEM: getItemByQueryFromState(state, function (item, success) {\n        var removeFromView = function removeFromView() {\n          // get id reference\n          var id = item.id; // archive the item, this does not remove it from the list\n\n          getItemById(state.items, id).archive(); // tell the view the item has been removed\n\n          dispatch('DID_REMOVE_ITEM', {\n            error: null,\n            id: id,\n            item: item\n          }); // now the list has been modified\n\n          listUpdated(dispatch, state); // correctly removed\n\n          success(createItemAPI(item));\n        }; // if this is a local file and the server.remove function has been configured, send source there so dev can remove file from server\n\n\n        var server = state.options.server;\n\n        if (item.origin === FileOrigin.LOCAL && server && isFunction(server.remove)) {\n          dispatch('DID_START_ITEM_REMOVE', {\n            id: item.id\n          });\n          server.remove(item.source, function () {\n            return removeFromView();\n          }, function (status) {\n            dispatch('DID_THROW_ITEM_REMOVE_ERROR', {\n              id: item.id,\n              error: createResponse('error', 0, status, null),\n              status: {\n                main: dynamicLabel(state.options.labelFileRemoveError)(status),\n                sub: state.options.labelTapToRetry\n              }\n            });\n          });\n        } else {\n          removeFromView();\n        }\n      }),\n      ABORT_ITEM_LOAD: getItemByQueryFromState(state, function (item) {\n        item.abortLoad();\n      }),\n      ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        // test if is already processed\n        if (item.serverId) {\n          dispatch('REVERT_ITEM_PROCESSING', {\n            id: item.id\n          });\n          return;\n        } // abort\n\n\n        item.abortProcessing().then(function () {\n          var shouldRemove = state.options.instantUpload;\n\n          if (shouldRemove) {\n            dispatch('REMOVE_ITEM', {\n              query: item.id\n            });\n          }\n        });\n      }),\n      REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        // not instant uploading, revert immidiately\n        if (!state.options.instantUpload) {\n          dispatch('REVERT_ITEM_PROCESSING', {\n            query: item\n          });\n          return;\n        } // if we're instant uploading the file will also be removed if we revert,\n        // so if a before remove file hook is defined we need to run it now\n\n\n        var handleRevert = function handleRevert(shouldRevert) {\n          if (!shouldRevert) return;\n          dispatch('REVERT_ITEM_PROCESSING', {\n            query: item\n          });\n        };\n\n        var fn = query('GET_BEFORE_REMOVE_FILE');\n\n        if (!fn) {\n          return handleRevert(true);\n        }\n\n        var requestRemoveResult = fn(createItemAPI(item));\n\n        if (requestRemoveResult == null) {\n          // undefined or null\n          return handleRevert(true);\n        }\n\n        if (typeof requestRemoveResult === 'boolean') {\n          return handleRevert(requestRemoveResult);\n        }\n\n        if (typeof requestRemoveResult.then === 'function') {\n          requestRemoveResult.then(handleRevert);\n        }\n      }),\n      REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function (item) {\n        item.revert(createRevertFunction(state.options.server.url, state.options.server.revert), query('GET_FORCE_REVERT')).then(function () {\n          var shouldRemove = state.options.instantUpload || isMockItem(item);\n\n          if (shouldRemove) {\n            dispatch('REMOVE_ITEM', {\n              query: item.id\n            });\n          }\n        }).catch(function () {});\n      }),\n      SET_OPTIONS: function SET_OPTIONS(_ref10) {\n        var options = _ref10.options;\n        forin(options, function (key, value) {\n          dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        });\n      }\n    };\n  };\n\n  var formatFilename = function formatFilename(name) {\n    return name;\n  };\n\n  var createElement$1 = function createElement(tagName) {\n    return document.createElement(tagName);\n  };\n\n  var text = function text(node, value) {\n    var textNode = node.childNodes[0];\n\n    if (!textNode) {\n      textNode = document.createTextNode(value);\n      node.appendChild(textNode);\n    } else if (value !== textNode.nodeValue) {\n      textNode.nodeValue = value;\n    }\n  };\n\n  var polarToCartesian = function polarToCartesian(centerX, centerY, radius, angleInDegrees) {\n    var angleInRadians = (angleInDegrees % 360 - 90) * Math.PI / 180.0;\n    return {\n      x: centerX + radius * Math.cos(angleInRadians),\n      y: centerY + radius * Math.sin(angleInRadians)\n    };\n  };\n\n  var describeArc = function describeArc(x, y, radius, startAngle, endAngle, arcSweep) {\n    var start = polarToCartesian(x, y, radius, endAngle);\n    var end = polarToCartesian(x, y, radius, startAngle);\n    return ['M', start.x, start.y, 'A', radius, radius, 0, arcSweep, 0, end.x, end.y].join(' ');\n  };\n\n  var percentageArc = function percentageArc(x, y, radius, from, to) {\n    var arcSweep = 1;\n\n    if (to > from && to - from <= 0.5) {\n      arcSweep = 0;\n    }\n\n    if (from > to && from - to >= 0.5) {\n      arcSweep = 0;\n    }\n\n    return describeArc(x, y, radius, Math.min(0.9999, from) * 360, Math.min(0.9999, to) * 360, arcSweep);\n  };\n\n  var create = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // start at 0\n\n    props.spin = false;\n    props.progress = 0;\n    props.opacity = 0; // svg\n\n    var svg = createElement('svg');\n    root.ref.path = createElement('path', {\n      'stroke-width': 2,\n      'stroke-linecap': 'round'\n    });\n    svg.appendChild(root.ref.path);\n    root.ref.svg = svg;\n    root.appendChild(svg);\n  };\n\n  var write = function write(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props;\n\n    if (props.opacity === 0) {\n      return;\n    }\n\n    if (props.align) {\n      root.element.dataset.align = props.align;\n    } // get width of stroke\n\n\n    var ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10); // calculate size of ring\n\n    var size = root.rect.element.width * 0.5; // ring state\n\n    var ringFrom = 0;\n    var ringTo = 0; // now in busy mode\n\n    if (props.spin) {\n      ringFrom = 0;\n      ringTo = 0.5;\n    } else {\n      ringFrom = 0;\n      ringTo = props.progress;\n    } // get arc path\n\n\n    var coordinates = percentageArc(size, size, size - ringStrokeWidth, ringFrom, ringTo); // update progress bar\n\n    attr(root.ref.path, 'd', coordinates); // hide while contains 0 value\n\n    attr(root.ref.path, 'stroke-opacity', props.spin || props.progress > 0 ? 1 : 0);\n  };\n\n  var progressIndicator = createView({\n    tag: 'div',\n    name: 'progress-indicator',\n    ignoreRectUpdate: true,\n    ignoreRect: true,\n    create: create,\n    write: write,\n    mixins: {\n      apis: ['progress', 'spin', 'align'],\n      styles: ['opacity'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 500\n        },\n        progress: {\n          type: 'spring',\n          stiffness: 0.95,\n          damping: 0.65,\n          mass: 10\n        }\n      }\n    }\n  });\n\n  var create$1 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    root.element.innerHTML = (props.icon || '') + ('<span>' + props.label + '</span>');\n    props.isDisabled = false;\n  };\n\n  var write$1 = function write(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props;\n    var isDisabled = props.isDisabled;\n    var shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;\n\n    if (shouldDisable && !isDisabled) {\n      props.isDisabled = true;\n      attr(root.element, 'disabled', 'disabled');\n    } else if (!shouldDisable && isDisabled) {\n      props.isDisabled = false;\n      root.element.removeAttribute('disabled');\n    }\n  };\n\n  var fileActionButton = createView({\n    tag: 'button',\n    attributes: {\n      type: 'button'\n    },\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'file-action-button',\n    mixins: {\n      apis: ['label'],\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      },\n      listeners: true\n    },\n    create: create$1,\n    write: write$1\n  });\n\n  var toNaturalFileSize = function toNaturalFileSize(bytes) {\n    var decimalSeparator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '.'; // nope, no negative byte sizes\n\n    bytes = Math.round(Math.abs(bytes)); // just bytes\n\n    if (bytes < 1000) {\n      return bytes + ' bytes';\n    } // kilobytes\n\n\n    if (bytes < MB) {\n      return Math.floor(bytes / KB) + ' KB';\n    } // megabytes\n\n\n    if (bytes < GB) {\n      return removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator) + ' MB';\n    } // gigabytes\n\n\n    return removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator) + ' GB';\n  };\n\n  var KB = 1000;\n  var MB = 1000000;\n  var GB = 1000000000;\n\n  var removeDecimalsWhenZero = function removeDecimalsWhenZero(value, decimalCount, separator) {\n    return value.toFixed(decimalCount).split('.').filter(function (part) {\n      return part !== '0';\n    }).join(separator);\n  };\n\n  var create$2 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // filename\n\n    var fileName = createElement$1('span');\n    fileName.className = 'filepond--file-info-main'; // hide for screenreaders\n    // the file is contained in a fieldset with legend that contains the filename\n    // no need to read it twice\n\n    attr(fileName, 'aria-hidden', 'true');\n    root.appendChild(fileName);\n    root.ref.fileName = fileName; // filesize\n\n    var fileSize = createElement$1('span');\n    fileSize.className = 'filepond--file-info-sub';\n    root.appendChild(fileSize);\n    root.ref.fileSize = fileSize; // set initial values\n\n    text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));\n    text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var updateFile = function updateFile(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props;\n    text(root.ref.fileSize, toNaturalFileSize(root.query('GET_ITEM_SIZE', props.id)));\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var updateFileSizeOnError = function updateFileSizeOnError(_ref3) {\n    var root = _ref3.root,\n        props = _ref3.props; // if size is available don't fallback to unknown size message\n\n    if (isInt(root.query('GET_ITEM_SIZE', props.id))) {\n      return;\n    }\n\n    text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));\n  };\n\n  var fileInfo = createView({\n    name: 'file-info',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: updateFile,\n      DID_UPDATE_ITEM_META: updateFile,\n      DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,\n      DID_THROW_ITEM_INVALID: updateFileSizeOnError\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    create: create$2,\n    mixins: {\n      styles: ['translateX', 'translateY'],\n      animations: {\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var toPercentage = function toPercentage(value) {\n    return Math.round(value * 100);\n  };\n\n  var create$3 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // main status\n\n    var main = createElement$1('span');\n    main.className = 'filepond--file-status-main';\n    root.appendChild(main);\n    root.ref.main = main; // sub status\n\n    var sub = createElement$1('span');\n    sub.className = 'filepond--file-status-sub';\n    root.appendChild(sub);\n    root.ref.sub = sub;\n    didSetItemLoadProgress({\n      root: root,\n      action: {\n        progress: null\n      }\n    });\n  };\n\n  var didSetItemLoadProgress = function didSetItemLoadProgress(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n    var title = action.progress === null ? root.query('GET_LABEL_FILE_LOADING') : root.query('GET_LABEL_FILE_LOADING') + ' ' + toPercentage(action.progress) + '%';\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didSetItemProcessProgress = function didSetItemProcessProgress(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n    var title = action.progress === null ? root.query('GET_LABEL_FILE_PROCESSING') : root.query('GET_LABEL_FILE_PROCESSING') + ' ' + toPercentage(action.progress) + '%';\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didRequestItemProcessing = function didRequestItemProcessing(_ref4) {\n    var root = _ref4.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didAbortItemProcessing = function didAbortItemProcessing(_ref5) {\n    var root = _ref5.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));\n  };\n\n  var didCompleteItemProcessing = function didCompleteItemProcessing(_ref6) {\n    var root = _ref6.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));\n  };\n\n  var clear = function clear(_ref7) {\n    var root = _ref7.root;\n    text(root.ref.main, '');\n    text(root.ref.sub, '');\n  };\n\n  var error = function error(_ref8) {\n    var root = _ref8.root,\n        action = _ref8.action;\n    text(root.ref.main, action.status.main);\n    text(root.ref.sub, action.status.sub);\n  };\n\n  var fileStatus = createView({\n    name: 'file-status',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: clear,\n      DID_REVERT_ITEM_PROCESSING: clear,\n      DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,\n      DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,\n      DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,\n      DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,\n      DID_THROW_ITEM_LOAD_ERROR: error,\n      DID_THROW_ITEM_INVALID: error,\n      DID_THROW_ITEM_PROCESSING_ERROR: error,\n      DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,\n      DID_THROW_ITEM_REMOVE_ERROR: error\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    create: create$3,\n    mixins: {\n      styles: ['translateX', 'translateY', 'opacity'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 250\n        },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n  /**\n   * Button definitions for the file view\n   */\n\n  var Buttons = {\n    AbortItemLoad: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',\n      action: 'ABORT_ITEM_LOAD',\n      className: 'filepond--action-abort-item-load',\n      align: 'LOAD_INDICATOR_POSITION' // right\n\n    },\n    RetryItemLoad: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',\n      action: 'RETRY_ITEM_LOAD',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-load',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    RemoveItem: {\n      label: 'GET_LABEL_BUTTON_REMOVE_ITEM',\n      action: 'REQUEST_REMOVE_ITEM',\n      icon: 'GET_ICON_REMOVE',\n      className: 'filepond--action-remove-item',\n      align: 'BUTTON_REMOVE_ITEM_POSITION' // left\n\n    },\n    ProcessItem: {\n      label: 'GET_LABEL_BUTTON_PROCESS_ITEM',\n      action: 'REQUEST_ITEM_PROCESSING',\n      icon: 'GET_ICON_PROCESS',\n      className: 'filepond--action-process-item',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    AbortItemProcessing: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',\n      action: 'ABORT_ITEM_PROCESSING',\n      className: 'filepond--action-abort-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    RetryItemProcessing: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',\n      action: 'RETRY_ITEM_PROCESSING',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    },\n    RevertItemProcessing: {\n      label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',\n      action: 'REQUEST_REVERT_ITEM_PROCESSING',\n      icon: 'GET_ICON_UNDO',\n      className: 'filepond--action-revert-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n\n    }\n  }; // make a list of buttons, we can then remove buttons from this list if they're disabled\n\n  var ButtonKeys = [];\n  forin(Buttons, function (key) {\n    ButtonKeys.push(key);\n  });\n\n  var calculateFileInfoOffset = function calculateFileInfoOffset(root) {\n    var buttonRect = root.ref.buttonRemoveItem.rect.element;\n    return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;\n  }; // Force on full pixels so text stays crips\n\n\n  var calculateFileVerticalCenterOffset = function calculateFileVerticalCenterOffset(root) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);\n  };\n\n  var calculateFileHorizontalCenterOffset = function calculateFileHorizontalCenterOffset(root) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);\n  };\n\n  var getLoadIndicatorAlignment = function getLoadIndicatorAlignment(root) {\n    return root.query('GET_STYLE_LOAD_INDICATOR_POSITION');\n  };\n\n  var getProcessIndicatorAlignment = function getProcessIndicatorAlignment(root) {\n    return root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');\n  };\n\n  var getRemoveIndicatorAligment = function getRemoveIndicatorAligment(root) {\n    return root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');\n  };\n\n  var DefaultStyle = {\n    buttonAbortItemLoad: {\n      opacity: 0\n    },\n    buttonRetryItemLoad: {\n      opacity: 0\n    },\n    buttonRemoveItem: {\n      opacity: 0\n    },\n    buttonProcessItem: {\n      opacity: 0\n    },\n    buttonAbortItemProcessing: {\n      opacity: 0\n    },\n    buttonRetryItemProcessing: {\n      opacity: 0\n    },\n    buttonRevertItemProcessing: {\n      opacity: 0\n    },\n    loadProgressIndicator: {\n      opacity: 0,\n      align: getLoadIndicatorAlignment\n    },\n    processProgressIndicator: {\n      opacity: 0,\n      align: getProcessIndicatorAlignment\n    },\n    processingCompleteIndicator: {\n      opacity: 0,\n      scaleX: 0.75,\n      scaleY: 0.75\n    },\n    info: {\n      translateX: 0,\n      translateY: 0,\n      opacity: 0\n    },\n    status: {\n      translateX: 0,\n      translateY: 0,\n      opacity: 0\n    }\n  };\n  var IdleStyle = {\n    buttonRemoveItem: {\n      opacity: 1\n    },\n    buttonProcessItem: {\n      opacity: 1\n    },\n    info: {\n      translateX: calculateFileInfoOffset\n    },\n    status: {\n      translateX: calculateFileInfoOffset\n    }\n  };\n  var ProcessingStyle = {\n    buttonAbortItemProcessing: {\n      opacity: 1\n    },\n    processProgressIndicator: {\n      opacity: 1\n    },\n    status: {\n      opacity: 1\n    }\n  };\n  var StyleMap = {\n    DID_THROW_ITEM_INVALID: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        translateX: calculateFileInfoOffset,\n        opacity: 1\n      }\n    },\n    DID_START_ITEM_LOAD: {\n      buttonAbortItemLoad: {\n        opacity: 1\n      },\n      loadProgressIndicator: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_THROW_ITEM_LOAD_ERROR: {\n      buttonRetryItemLoad: {\n        opacity: 1\n      },\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_START_ITEM_REMOVE: {\n      processProgressIndicator: {\n        opacity: 1,\n        align: getRemoveIndicatorAligment\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 0\n      }\n    },\n    DID_THROW_ITEM_REMOVE_ERROR: {\n      processProgressIndicator: {\n        opacity: 0,\n        align: getRemoveIndicatorAligment\n      },\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1,\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_LOAD_ITEM: IdleStyle,\n    DID_LOAD_LOCAL_ITEM: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_START_ITEM_PROCESSING: ProcessingStyle,\n    DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,\n    DID_COMPLETE_ITEM_PROCESSING: {\n      buttonRevertItemProcessing: {\n        opacity: 1\n      },\n      info: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_THROW_ITEM_PROCESSING_ERROR: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      buttonRetryItemProcessing: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      }\n    },\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {\n      buttonRevertItemProcessing: {\n        opacity: 1\n      },\n      status: {\n        opacity: 1\n      },\n      info: {\n        opacity: 1\n      }\n    },\n    DID_ABORT_ITEM_PROCESSING: {\n      buttonRemoveItem: {\n        opacity: 1\n      },\n      buttonProcessItem: {\n        opacity: 1\n      },\n      info: {\n        translateX: calculateFileInfoOffset\n      },\n      status: {\n        opacity: 1\n      }\n    },\n    DID_REVERT_ITEM_PROCESSING: IdleStyle\n  }; // complete indicator view\n\n  var processingCompleteIndicatorView = createView({\n    create: function create(_ref) {\n      var root = _ref.root;\n      root.element.innerHTML = root.query('GET_ICON_DONE');\n    },\n    name: 'processing-complete-indicator',\n    ignoreRect: true,\n    mixins: {\n      styles: ['scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      }\n    }\n  });\n  /**\n   * Creates the file view\n   */\n\n  var create$4 = function create(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props;\n    var id = props.id; // allow reverting upload\n\n    var allowRevert = root.query('GET_ALLOW_REVERT'); // is instant uploading, need this to determine the icon of the undo button\n\n    var instantUpload = root.query('GET_INSTANT_UPLOAD'); // is async set up\n\n    var isAsync = root.query('IS_ASYNC'); // enabled buttons array\n\n    var enabledButtons = isAsync ? ButtonKeys.concat() : ButtonKeys.filter(function (key) {\n      return !/Process/.test(key);\n    }); // remove last button (revert) if not allowed\n\n    if (isAsync && !allowRevert) {\n      enabledButtons.splice(-1, 1);\n      var map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      map.info.translateX = calculateFileHorizontalCenterOffset;\n      map.info.translateY = calculateFileVerticalCenterOffset;\n      map.status.translateY = calculateFileVerticalCenterOffset;\n      map.processingCompleteIndicator = {\n        opacity: 1,\n        scaleX: 1,\n        scaleY: 1\n      };\n    } // update icon and label for revert button when instant uploading\n\n\n    if (instantUpload && allowRevert) {\n      Buttons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';\n      Buttons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';\n    } // create the button views\n\n\n    forin(Buttons, function (key, definition) {\n      // create button\n      var buttonView = root.createChildView(fileActionButton, {\n        label: root.query(definition.label),\n        icon: root.query(definition.icon),\n        opacity: 0\n      }); // should be appended?\n\n      if (enabledButtons.includes(key)) {\n        root.appendChildView(buttonView);\n      } // add position attribute\n\n\n      buttonView.element.dataset.align = root.query('GET_STYLE_' + definition.align); // add class\n\n      buttonView.element.classList.add(definition.className); // handle interactions\n\n      buttonView.on('click', function (e) {\n        e.stopPropagation();\n        root.dispatch(definition.action, {\n          query: id\n        });\n      }); // set reference\n\n      root.ref['button' + key] = buttonView;\n    }); // create file info view\n\n    root.ref.info = root.appendChildView(root.createChildView(fileInfo, {\n      id: id\n    })); // create file status view\n\n    root.ref.status = root.appendChildView(root.createChildView(fileStatus, {\n      id: id\n    })); // checkmark\n\n    root.ref.processingCompleteIndicator = root.appendChildView(root.createChildView(processingCompleteIndicatorView));\n    root.ref.processingCompleteIndicator.element.dataset.align = root.query('GET_STYLE_BUTTON_PROCESS_ITEM_POSITION'); // add progress indicators\n\n    var loadIndicatorView = root.appendChildView(root.createChildView(progressIndicator, {\n      opacity: 0,\n      align: root.query('GET_STYLE_LOAD_INDICATOR_POSITION')\n    }));\n    loadIndicatorView.element.classList.add('filepond--load-indicator');\n    root.ref.loadProgressIndicator = loadIndicatorView;\n    var progressIndicatorView = root.appendChildView(root.createChildView(progressIndicator, {\n      opacity: 0,\n      align: root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION')\n    }));\n    progressIndicatorView.element.classList.add('filepond--process-indicator');\n    root.ref.processProgressIndicator = progressIndicatorView; // current active styles\n\n    root.ref.activeStyles = [];\n  };\n\n  var write$2 = function write(_ref3) {\n    var root = _ref3.root,\n        actions = _ref3.actions,\n        props = _ref3.props; // route actions\n\n    route({\n      root: root,\n      actions: actions,\n      props: props\n    }); // select last state change action\n\n    var action = actions.concat().filter(function (action) {\n      return /^DID_/.test(action.type);\n    }).reverse().find(function (action) {\n      return StyleMap[action.type];\n    }); // a new action happened, let's get the matching styles\n\n    if (action) {\n      // define new active styles\n      root.ref.activeStyles = [];\n      var stylesToApply = StyleMap[action.type];\n      forin(DefaultStyle, function (name, defaultStyles) {\n        // get reference to control\n        var control = root.ref[name]; // loop over all styles for this control\n\n        forin(defaultStyles, function (key, defaultValue) {\n          var value = stylesToApply[name] && typeof stylesToApply[name][key] !== 'undefined' ? stylesToApply[name][key] : defaultValue;\n          root.ref.activeStyles.push({\n            control: control,\n            key: key,\n            value: value\n          });\n        });\n      });\n    } // apply active styles to element\n\n\n    root.ref.activeStyles.forEach(function (_ref4) {\n      var control = _ref4.control,\n          key = _ref4.key,\n          value = _ref4.value;\n      control[key] = typeof value === 'function' ? value(root) : value;\n    });\n  };\n\n  var route = createRoute({\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: function DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING(_ref5) {\n      var root = _ref5.root,\n          action = _ref5.action;\n      root.ref.buttonAbortItemProcessing.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: function DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD(_ref6) {\n      var root = _ref6.root,\n          action = _ref6.action;\n      root.ref.buttonAbortItemLoad.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: function DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL(_ref7) {\n      var root = _ref7.root,\n          action = _ref7.action;\n      root.ref.buttonAbortItemRemoval.label = action.value;\n    },\n    DID_REQUEST_ITEM_PROCESSING: function DID_REQUEST_ITEM_PROCESSING(_ref8) {\n      var root = _ref8.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_LOAD: function DID_START_ITEM_LOAD(_ref9) {\n      var root = _ref9.root;\n      root.ref.loadProgressIndicator.spin = true;\n      root.ref.loadProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_REMOVE: function DID_START_ITEM_REMOVE(_ref10) {\n      var root = _ref10.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_UPDATE_ITEM_LOAD_PROGRESS: function DID_UPDATE_ITEM_LOAD_PROGRESS(_ref11) {\n      var root = _ref11.root,\n          action = _ref11.action;\n      root.ref.loadProgressIndicator.spin = false;\n      root.ref.loadProgressIndicator.progress = action.progress;\n    },\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: function DID_UPDATE_ITEM_PROCESS_PROGRESS(_ref12) {\n      var root = _ref12.root,\n          action = _ref12.action;\n      root.ref.processProgressIndicator.spin = false;\n      root.ref.processProgressIndicator.progress = action.progress;\n    }\n  });\n  var file = createView({\n    create: create$4,\n    write: write$2,\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    name: 'file'\n  });\n  /**\n   * Creates the file view\n   */\n\n  var create$5 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // filename\n\n    root.ref.fileName = createElement$1('legend');\n    root.appendChild(root.ref.fileName); // file appended\n\n    root.ref.file = root.appendChildView(root.createChildView(file, {\n      id: props.id\n    })); // create data container\n\n    var dataContainer = createElement$1('input');\n    dataContainer.type = 'hidden';\n    dataContainer.name = root.query('GET_NAME');\n    dataContainer.disabled = root.query('GET_DISABLED');\n    root.ref.data = dataContainer;\n    root.appendChild(dataContainer);\n  };\n\n  var didSetDisabled = function didSetDisabled(_ref2) {\n    var root = _ref2.root;\n    root.ref.data.disabled = root.query('GET_DISABLED');\n  };\n  /**\n   * Data storage\n   */\n\n\n  var didLoadItem = function didLoadItem(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action,\n        props = _ref3.props;\n    root.ref.data.value = action.serverFileReference; // updates the legend of the fieldset so screenreaders can better group buttons\n\n    text(root.ref.fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var didRemoveItem = function didRemoveItem(_ref4) {\n    var root = _ref4.root;\n    root.ref.data.removeAttribute('value');\n  };\n\n  var didCompleteItemProcessing$1 = function didCompleteItemProcessing(_ref5) {\n    var root = _ref5.root,\n        action = _ref5.action;\n    root.ref.data.value = action.serverFileReference;\n  };\n\n  var didRevertItemProcessing = function didRevertItemProcessing(_ref6) {\n    var root = _ref6.root;\n    root.ref.data.removeAttribute('value');\n  };\n\n  var fileWrapper = createView({\n    create: create$5,\n    ignoreRect: true,\n    write: createRoute({\n      DID_SET_DISABLED: didSetDisabled,\n      DID_LOAD_ITEM: didLoadItem,\n      DID_REMOVE_ITEM: didRemoveItem,\n      DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing$1,\n      DID_REVERT_ITEM_PROCESSING: didRevertItemProcessing\n    }),\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, {\n        view: root\n      }));\n    },\n    tag: 'fieldset',\n    name: 'file-wrapper'\n  });\n  var PANEL_SPRING_PROPS = {\n    type: 'spring',\n    damping: 0.6,\n    mass: 7\n  };\n\n  var create$6 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    [{\n      name: 'top'\n    }, {\n      name: 'center',\n      props: {\n        translateY: null,\n        scaleY: null\n      },\n      mixins: {\n        animations: {\n          scaleY: PANEL_SPRING_PROPS\n        },\n        styles: ['translateY', 'scaleY']\n      }\n    }, {\n      name: 'bottom',\n      props: {\n        translateY: null\n      },\n      mixins: {\n        animations: {\n          translateY: PANEL_SPRING_PROPS\n        },\n        styles: ['translateY']\n      }\n    }].forEach(function (section) {\n      createSection(root, section, props.name);\n    });\n    root.element.classList.add('filepond--' + props.name);\n    root.ref.scalable = null;\n  };\n\n  var createSection = function createSection(root, section, className) {\n    var viewConstructor = createView({\n      name: 'panel-' + section.name + ' filepond--' + className,\n      mixins: section.mixins,\n      ignoreRectUpdate: true\n    });\n    var view = root.createChildView(viewConstructor, section.props);\n    root.ref[section.name] = root.appendChildView(view);\n  };\n\n  var write$3 = function write(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props; // update scalable state\n\n    if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {\n      root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;\n      root.element.dataset.scalable = root.ref.scalable;\n    } // no height, can't set\n\n\n    if (!props.height) return; // get child rects\n\n    var topRect = root.ref.top.rect.element;\n    var bottomRect = root.ref.bottom.rect.element; // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)\n\n    var height = Math.max(topRect.height + bottomRect.height, props.height); // offset center part\n\n    root.ref.center.translateY = topRect.height; // scale center part\n    // use math ceil to prevent transparent lines because of rounding errors\n\n    root.ref.center.scaleY = (height - topRect.height - bottomRect.height) / 100; // offset bottom part\n\n    root.ref.bottom.translateY = height - bottomRect.height;\n  };\n\n  var panel = createView({\n    name: 'panel',\n    write: write$3,\n    create: create$6,\n    ignoreRect: true,\n    mixins: {\n      apis: ['height', 'scalable']\n    }\n  });\n  var ITEM_TRANSLATE_SPRING = {\n    type: 'spring',\n    stiffness: 0.75,\n    damping: 0.45,\n    mass: 10\n  };\n  var ITEM_SCALE_SPRING = 'spring';\n  /**\n   * Creates the file view\n   */\n\n  var create$7 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // select\n\n    root.ref.handleClick = function () {\n      return root.dispatch('DID_ACTIVATE_ITEM', {\n        id: props.id\n      });\n    }; // set id\n\n\n    root.element.id = 'filepond--item-' + props.id;\n    root.element.addEventListener('click', root.ref.handleClick); // file view\n\n    root.ref.container = root.appendChildView(root.createChildView(fileWrapper, {\n      id: props.id\n    })); // file panel\n\n    root.ref.panel = root.appendChildView(root.createChildView(panel, {\n      name: 'item-panel'\n    })); // default start height\n\n    root.ref.panel.height = null; // by default not marked for removal\n\n    props.markedForRemoval = false;\n  };\n\n  var StateMap = {\n    DID_START_ITEM_LOAD: 'busy',\n    DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',\n    DID_THROW_ITEM_INVALID: 'load-invalid',\n    DID_THROW_ITEM_LOAD_ERROR: 'load-error',\n    DID_LOAD_ITEM: 'idle',\n    DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',\n    DID_START_ITEM_REMOVE: 'busy',\n    DID_START_ITEM_PROCESSING: 'busy',\n    DID_REQUEST_ITEM_PROCESSING: 'busy',\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',\n    DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',\n    DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',\n    DID_ABORT_ITEM_PROCESSING: 'cancelled',\n    DID_REVERT_ITEM_PROCESSING: 'idle'\n  };\n  var route$1 = createRoute({\n    DID_UPDATE_PANEL_HEIGHT: function DID_UPDATE_PANEL_HEIGHT(_ref2) {\n      var root = _ref2.root,\n          action = _ref2.action;\n      var height = action.height;\n      root.height = height;\n    }\n  });\n\n  var write$4 = function write(_ref3) {\n    var root = _ref3.root,\n        actions = _ref3.actions,\n        props = _ref3.props,\n        shouldOptimize = _ref3.shouldOptimize; // select last state change action\n\n    var action = actions.concat().filter(function (action) {\n      return /^DID_/.test(action.type);\n    }).reverse().find(function (action) {\n      return StateMap[action.type];\n    }); // no need to set same state twice\n\n    if (action && action.type !== props.currentState) {\n      // set current state\n      props.currentState = action.type; // set state\n\n      root.element.dataset.filepondItemState = StateMap[props.currentState] || '';\n    } // route actions\n\n\n    var aspectRatio = root.query('GET_ITEM_PANEL_ASPECT_RATIO') || root.query('GET_PANEL_ASPECT_RATIO');\n\n    if (!aspectRatio) {\n      route$1({\n        root: root,\n        actions: actions,\n        props: props\n      });\n\n      if (!root.height && root.ref.container.rect.element.height > 0) {\n        root.height = root.ref.container.rect.element.height;\n      }\n    } else if (!shouldOptimize) {\n      root.height = root.rect.element.width * aspectRatio;\n    } // sync panel height with item height\n\n\n    if (shouldOptimize) {\n      root.ref.panel.height = null;\n    }\n\n    root.ref.panel.height = root.height;\n  };\n\n  var item = createView({\n    create: create$7,\n    write: write$4,\n    destroy: function destroy(_ref4) {\n      var root = _ref4.root,\n          props = _ref4.props;\n      root.element.removeEventListener('click', root.ref.handleClick);\n      root.dispatch('RELEASE_ITEM', {\n        query: props.id\n      });\n    },\n    tag: 'li',\n    name: 'item',\n    mixins: {\n      apis: ['id', 'interactionMethod', 'markedForRemoval', 'spawnDate'],\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity', 'height'],\n      animations: {\n        scaleX: ITEM_SCALE_SPRING,\n        scaleY: ITEM_SCALE_SPRING,\n        translateX: ITEM_TRANSLATE_SPRING,\n        translateY: ITEM_TRANSLATE_SPRING,\n        opacity: {\n          type: 'tween',\n          duration: 150\n        }\n      }\n    }\n  });\n\n  var getItemIndexByPosition = function getItemIndexByPosition(view, positionInView) {\n    if (!positionInView) return;\n    var horizontalSpace = view.rect.element.width;\n    var children = view.childViews;\n    var l = children.length;\n    var last = null; // -1, don't move items to accomodate (either add to top or bottom)\n\n    if (l === 0 || positionInView.top < children[0].rect.element.top) return -1; // let's get the item width\n\n    var item = children[0];\n    var itemRect = item.rect.element;\n    var itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;\n    var itemWidth = itemRect.width + itemHorizontalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth); // stack\n\n    if (itemsPerRow === 1) {\n      for (var index = 0; index < l; index++) {\n        var child = children[index];\n        var childMid = child.rect.outer.top + child.rect.element.height * 0.5;\n\n        if (positionInView.top < childMid) {\n          return index;\n        }\n      }\n\n      return l;\n    } // grid\n\n\n    var itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;\n    var itemHeight = itemRect.height + itemVerticalMargin;\n\n    for (var _index = 0; _index < l; _index++) {\n      var indexX = _index % itemsPerRow;\n      var indexY = Math.floor(_index / itemsPerRow);\n      var offsetX = indexX * itemWidth;\n      var offsetY = indexY * itemHeight;\n      var itemTop = offsetY - itemRect.marginTop;\n      var itemRight = offsetX + itemWidth;\n      var itemBottom = offsetY + itemHeight + itemRect.marginBottom;\n\n      if (positionInView.top < itemBottom && positionInView.top > itemTop) {\n        if (positionInView.left < itemRight) {\n          return _index;\n        } else if (_index !== l - 1) {\n          last = _index;\n        } else {\n          last = null;\n        }\n      }\n    }\n\n    if (last !== null) {\n      return last;\n    }\n\n    return l;\n  };\n\n  var create$8 = function create(_ref) {\n    var root = _ref.root; // need to set role to list as otherwise it won't be read as a list by VoiceOver\n\n    attr(root.element, 'role', 'list');\n    root.ref.lastItemSpanwDate = Date.now();\n  };\n  /**\n   * Inserts a new item\n   * @param root\n   * @param action\n   */\n\n\n  var addItemView = function addItemView(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n    var id = action.id,\n        index = action.index,\n        interactionMethod = action.interactionMethod;\n    root.ref.addIndex = index;\n    var now = Date.now();\n    var spawnDate = now;\n    var opacity = 1;\n\n    if (interactionMethod !== InteractionMethod.NONE) {\n      opacity = 0;\n      var cooldown = root.query('GET_ITEM_INSERT_INTERVAL');\n      var dist = now - root.ref.lastItemSpanwDate;\n      spawnDate = dist < cooldown ? now + (cooldown - dist) : now;\n    }\n\n    root.ref.lastItemSpanwDate = spawnDate;\n    root.appendChildView(root.createChildView( // view type\n    item, // props\n    {\n      spawnDate: spawnDate,\n      id: id,\n      opacity: opacity,\n      interactionMethod: interactionMethod\n    }), index);\n  };\n\n  var moveItem = function moveItem(item, x, y) {\n    var vx = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    var vy = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n    item.translateX = x;\n    item.translateY = y;\n\n    if (Date.now() > item.spawnDate) {\n      // reveal element\n      if (item.opacity === 0) {\n        introItemView(item, x, y, vx, vy);\n      } // make sure is default scale every frame\n\n\n      item.scaleX = 1;\n      item.scaleY = 1;\n      item.opacity = 1;\n    }\n  };\n\n  var introItemView = function introItemView(item, x, y, vx, vy) {\n    if (item.interactionMethod === InteractionMethod.NONE) {\n      item.translateX = null;\n      item.translateX = x;\n      item.translateY = null;\n      item.translateY = y;\n    } else if (item.interactionMethod === InteractionMethod.DROP) {\n      item.translateX = null;\n      item.translateX = x - vx * 20;\n      item.translateY = null;\n      item.translateY = y - vy * 10;\n      item.scaleX = 0.8;\n      item.scaleY = 0.8;\n    } else if (item.interactionMethod === InteractionMethod.BROWSE) {\n      item.translateY = null;\n      item.translateY = y - 30;\n    } else if (item.interactionMethod === InteractionMethod.API) {\n      item.translateX = null;\n      item.translateX = x - 30;\n      item.translateY = null;\n    }\n  };\n  /**\n   * Removes an existing item\n   * @param root\n   * @param action\n   */\n\n\n  var removeItemView = function removeItemView(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n    var id = action.id; // get the view matching the given id\n\n    var view = root.childViews.find(function (child) {\n      return child.id === id;\n    }); // if no view found, exit\n\n    if (!view) {\n      return;\n    } // animate view out of view\n\n\n    view.scaleX = 0.9;\n    view.scaleY = 0.9;\n    view.opacity = 0; // mark for removal\n\n    view.markedForRemoval = true;\n  };\n  /**\n   * Setup action routes\n   */\n\n\n  var route$2 = createRoute({\n    DID_ADD_ITEM: addItemView,\n    DID_REMOVE_ITEM: removeItemView\n  });\n  /**\n   * Write to view\n   * @param root\n   * @param actions\n   * @param props\n   */\n\n  var write$5 = function write(_ref4) {\n    var root = _ref4.root,\n        props = _ref4.props,\n        actions = _ref4.actions,\n        shouldOptimize = _ref4.shouldOptimize; // route actions\n\n    route$2({\n      root: root,\n      props: props,\n      actions: actions\n    });\n    var dragCoordinates = props.dragCoordinates; // get index\n\n    var dragIndex = dragCoordinates ? getItemIndexByPosition(root, dragCoordinates) : null; // available space on horizontal axis\n\n    var horizontalSpace = root.rect.element.width; // only draw children that have dimensions\n\n    var visibleChildren = root.childViews.filter(function (child) {\n      return child.rect.element.height;\n    }); // sort based on current active items\n\n    var children = root.query('GET_ACTIVE_ITEMS').map(function (item) {\n      return visibleChildren.find(function (child) {\n        return child.id === item.id;\n      });\n    }).filter(function (item) {\n      return item;\n    }); // add index is used to reserve the dropped/added item index till the actual item is rendered\n\n    var addIndex = root.ref.addIndex || null; // add index no longer needed till possibly next draw\n\n    root.ref.addIndex = null;\n    var dragIndexOffset = 0;\n    var removeIndexOffset = 0;\n    var addIndexOffset = 0;\n    if (children.length === 0) return;\n    var childRect = children[0].rect.element;\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth); // stack\n\n    if (itemsPerRow === 1) {\n      var offsetY = 0;\n      var dragOffset = 0;\n      children.forEach(function (child, index) {\n        if (dragIndex) {\n          var dist = index - dragIndex;\n\n          if (dist === -2) {\n            dragOffset = -itemVerticalMargin * 0.25;\n          } else if (dist === -1) {\n            dragOffset = -itemVerticalMargin * 0.75;\n          } else if (dist === 0) {\n            dragOffset = itemVerticalMargin * 0.75;\n          } else if (dist === 1) {\n            dragOffset = itemVerticalMargin * 0.25;\n          } else {\n            dragOffset = 0;\n          }\n        }\n\n        if (shouldOptimize) {\n          child.translateX = null;\n          child.translateY = null;\n        }\n\n        if (!child.markedForRemoval) {\n          moveItem(child, 0, offsetY + dragOffset);\n        }\n\n        var itemHeight = child.rect.element.height + itemVerticalMargin;\n        var visualHeight = itemHeight * (child.markedForRemoval ? child.opacity : 1);\n        offsetY += visualHeight;\n      });\n    } // grid\n    else {\n        var prevX = 0;\n        var prevY = 0;\n        children.forEach(function (child, index) {\n          if (index === dragIndex) {\n            dragIndexOffset = 1;\n          }\n\n          if (index === addIndex) {\n            addIndexOffset += 1;\n          }\n\n          if (child.markedForRemoval && child.opacity < 0.5) {\n            removeIndexOffset -= 1;\n          }\n\n          var visualIndex = index + addIndexOffset + dragIndexOffset + removeIndexOffset;\n          var indexX = visualIndex % itemsPerRow;\n          var indexY = Math.floor(visualIndex / itemsPerRow);\n          var offsetX = indexX * itemWidth;\n          var offsetY = indexY * itemHeight;\n          var vectorX = Math.sign(offsetX - prevX);\n          var vectorY = Math.sign(offsetY - prevY);\n          prevX = offsetX;\n          prevY = offsetY;\n          if (child.markedForRemoval) return;\n\n          if (shouldOptimize) {\n            child.translateX = null;\n            child.translateY = null;\n          }\n\n          moveItem(child, offsetX, offsetY, vectorX, vectorY);\n        });\n      }\n  };\n  /**\n   * Filters actions that are meant specifically for a certain child of the list\n   * @param child\n   * @param actions\n   */\n\n\n  var filterSetItemActions = function filterSetItemActions(child, actions) {\n    return actions.filter(function (action) {\n      // if action has an id, filter out actions that don't have this child id\n      if (action.data && action.data.id) {\n        return child.id === action.data.id;\n      } // allow all other actions\n\n\n      return true;\n    });\n  };\n\n  var list = createView({\n    create: create$8,\n    write: write$5,\n    tag: 'ul',\n    name: 'list',\n    didWriteView: function didWriteView(_ref5) {\n      var root = _ref5.root;\n      root.childViews.filter(function (view) {\n        return view.markedForRemoval && view.opacity === 0 && view.resting;\n      }).forEach(function (view) {\n        view._destroy();\n\n        root.removeChildView(view);\n      });\n    },\n    filterFrameActionsForChild: filterSetItemActions,\n    mixins: {\n      apis: ['dragCoordinates']\n    }\n  });\n\n  var create$9 = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    root.ref.list = root.appendChildView(root.createChildView(list));\n    props.dragCoordinates = null;\n    props.overflowing = false;\n  };\n\n  var storeDragCoordinates = function storeDragCoordinates(_ref2) {\n    var root = _ref2.root,\n        props = _ref2.props,\n        action = _ref2.action;\n    if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;\n    props.dragCoordinates = {\n      left: action.position.scopeLeft - root.ref.list.rect.element.left,\n      top: action.position.scopeTop - (root.rect.outer.top + root.rect.element.marginTop + root.rect.element.scrollTop)\n    };\n  };\n\n  var clearDragCoordinates = function clearDragCoordinates(_ref3) {\n    var props = _ref3.props;\n    props.dragCoordinates = null;\n  };\n\n  var route$3 = createRoute({\n    DID_DRAG: storeDragCoordinates,\n    DID_END_DRAG: clearDragCoordinates\n  });\n\n  var write$6 = function write(_ref4) {\n    var root = _ref4.root,\n        props = _ref4.props,\n        actions = _ref4.actions; // route actions\n\n    route$3({\n      root: root,\n      props: props,\n      actions: actions\n    }); // current drag position\n\n    root.ref.list.dragCoordinates = props.dragCoordinates; // if currently overflowing but no longer received overflow\n\n    if (props.overflowing && !props.overflow) {\n      props.overflowing = false; // reset overflow state\n\n      root.element.dataset.state = '';\n      root.height = null;\n    } // if is not overflowing currently but does receive overflow value\n\n\n    if (props.overflow) {\n      var newHeight = Math.round(props.overflow);\n\n      if (newHeight !== root.height) {\n        props.overflowing = true;\n        root.element.dataset.state = 'overflow';\n        root.height = newHeight;\n      }\n    }\n  };\n\n  var listScroller = createView({\n    create: create$9,\n    write: write$6,\n    name: 'list-scroller',\n    mixins: {\n      apis: ['overflow', 'dragCoordinates'],\n      styles: ['height', 'translateY'],\n      animations: {\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var attrToggle = function attrToggle(element, name, state) {\n    var enabledValue = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n\n    if (state) {\n      attr(element, name, enabledValue);\n    } else {\n      element.removeAttribute(name);\n    }\n  };\n\n  var resetFileInput = function resetFileInput(input) {\n    // no value, no need to reset\n    if (!input || input.value === '') {\n      return;\n    }\n\n    try {\n      // for modern browsers\n      input.value = '';\n    } catch (err) {} // for IE10\n\n\n    if (input.value) {\n      // quickly append input to temp form and reset form\n      var form = createElement$1('form');\n      var parentNode = input.parentNode;\n      var ref = input.nextSibling;\n      form.appendChild(input);\n      form.reset(); // re-inject input where it originally was\n\n      if (ref) {\n        parentNode.insertBefore(input, ref);\n      } else {\n        parentNode.appendChild(input);\n      }\n    }\n  };\n\n  var create$a = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // set id so can be referenced from outside labels\n\n    root.element.id = 'filepond--browser-' + props.id; // set name of element (is removed when a value is set)\n\n    attr(root.element, 'name', root.query('GET_NAME')); // we have to link this element to the status element\n\n    attr(root.element, 'aria-controls', 'filepond--assistant-' + props.id); // set label, we use labelled by as otherwise the screenreader does not read the \"browse\" text in the label (as it has tabindex: 0)\n\n    attr(root.element, 'aria-labelledby', 'filepond--drop-label-' + props.id); // handle changes to the input field\n\n    root.ref.handleChange = function (e) {\n      if (!root.element.value) {\n        return;\n      } // extract files\n\n\n      var files = Array.from(root.element.files); // we add a little delay so the OS file select window can move out of the way before we add our file\n\n      setTimeout(function () {\n        // load files\n        props.onload(files); // reset input, it's just for exposing a method to drop files, should not retain any state\n\n        resetFileInput(root.element);\n      }, 250);\n    };\n\n    root.element.addEventListener('change', root.ref.handleChange);\n  };\n\n  var setAcceptedFileTypes = function setAcceptedFileTypes(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n    attrToggle(root.element, 'accept', !!action.value, action.value ? action.value.join(',') : '');\n  };\n\n  var toggleAllowMultiple = function toggleAllowMultiple(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n    attrToggle(root.element, 'multiple', action.value);\n  };\n\n  var toggleDisabled = function toggleDisabled(_ref4) {\n    var root = _ref4.root,\n        action = _ref4.action;\n    var isDisabled = root.query('GET_DISABLED');\n    var doesAllowBrowse = root.query('GET_ALLOW_BROWSE');\n    var disableField = isDisabled || !doesAllowBrowse;\n    attrToggle(root.element, 'disabled', disableField);\n  };\n\n  var toggleRequired = function toggleRequired(_ref5) {\n    var root = _ref5.root,\n        action = _ref5.action; // want to remove required, always possible\n\n    if (!action.value) {\n      attrToggle(root.element, 'required', false);\n    } // if want to make required, only possible when zero items\n    else if (root.query('GET_TOTAL_ITEMS') === 0) {\n        attrToggle(root.element, 'required', true);\n      }\n  };\n\n  var setCaptureMethod = function setCaptureMethod(_ref6) {\n    var root = _ref6.root,\n        action = _ref6.action;\n    attrToggle(root.element, 'capture', !!action.value, action.value === true ? '' : action.value);\n  };\n\n  var updateRequiredStatus = function updateRequiredStatus(_ref7) {\n    var root = _ref7.root;\n    var element = root.element; // always remove the required attribute when more than zero items\n\n    if (root.query('GET_TOTAL_ITEMS') > 0) {\n      attrToggle(element, 'required', false);\n      attrToggle(element, 'name', false);\n    } else {\n      // add name attribute\n      attrToggle(element, 'name', true, root.query('GET_NAME')); // remove any validation messages\n\n      var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n\n      if (shouldCheckValidity) {\n        element.setCustomValidity('');\n      } // we only add required if the field has been deemed required\n\n\n      if (root.query('GET_REQUIRED')) {\n        attrToggle(element, 'required', true);\n      }\n    }\n  };\n\n  var updateFieldValidityStatus = function updateFieldValidityStatus(_ref8) {\n    var root = _ref8.root;\n    var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n    if (!shouldCheckValidity) return;\n    root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));\n  };\n\n  var browser = createView({\n    tag: 'input',\n    name: 'browser',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    attributes: {\n      type: 'file'\n    },\n    create: create$a,\n    destroy: function destroy(_ref9) {\n      var root = _ref9.root;\n      root.element.removeEventListener('change', root.ref.handleChange);\n    },\n    write: createRoute({\n      DID_LOAD_ITEM: updateRequiredStatus,\n      DID_REMOVE_ITEM: updateRequiredStatus,\n      DID_THROW_ITEM_INVALID: updateFieldValidityStatus,\n      DID_SET_DISABLED: toggleDisabled,\n      DID_SET_ALLOW_BROWSE: toggleDisabled,\n      DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,\n      DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,\n      DID_SET_CAPTURE_METHOD: setCaptureMethod,\n      DID_SET_REQUIRED: toggleRequired\n    })\n  });\n  var Key = {\n    ENTER: 13,\n    SPACE: 32\n  };\n\n  var create$b = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // create the label and link it to the file browser\n\n    var label = createElement$1('label');\n    attr(label, 'for', 'filepond--browser-' + props.id); // use for labeling file input (aria-labelledby on file input)\n\n    attr(label, 'id', 'filepond--drop-label-' + props.id); // hide the label for screenreaders, the input element will read the contents of the label when it's focussed. If we don't set aria-hidden the screenreader will also navigate the contents of the label separately from the input.\n\n    attr(label, 'aria-hidden', 'true'); // handle keys\n\n    root.ref.handleKeyDown = function (e) {\n      var isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;\n      if (!isActivationKey) return; // stops from triggering the element a second time\n\n      e.preventDefault(); // click link (will then in turn activate file input)\n\n      root.ref.label.click();\n    };\n\n    root.ref.handleClick = function (e) {\n      var isLabelClick = e.target === label || label.contains(e.target); // don't want to click twice\n\n      if (isLabelClick) return; // click link (will then in turn activate file input)\n\n      root.ref.label.click();\n    }; // attach events\n\n\n    label.addEventListener('keydown', root.ref.handleKeyDown);\n    root.element.addEventListener('click', root.ref.handleClick); // update\n\n    updateLabelValue(label, props.caption); // add!\n\n    root.appendChild(label);\n    root.ref.label = label;\n  };\n\n  var updateLabelValue = function updateLabelValue(label, value) {\n    label.innerHTML = value;\n    var clickable = label.querySelector('.filepond--label-action');\n\n    if (clickable) {\n      attr(clickable, 'tabindex', '0');\n    }\n\n    return value;\n  };\n\n  var dropLabel = createView({\n    name: 'drop-label',\n    ignoreRect: true,\n    create: create$b,\n    destroy: function destroy(_ref2) {\n      var root = _ref2.root;\n      root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);\n      root.element.removeEventListener('click', root.ref.handleClick);\n    },\n    write: createRoute({\n      DID_SET_LABEL_IDLE: function DID_SET_LABEL_IDLE(_ref3) {\n        var root = _ref3.root,\n            action = _ref3.action;\n        updateLabelValue(root.ref.label, action.value);\n      }\n    }),\n    mixins: {\n      styles: ['opacity', 'translateX', 'translateY'],\n      animations: {\n        opacity: {\n          type: 'tween',\n          duration: 150\n        },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n  var blob = createView({\n    name: 'drip-blob',\n    ignoreRect: true,\n    mixins: {\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: {\n          type: 'tween',\n          duration: 250\n        }\n      }\n    }\n  });\n\n  var addBlob = function addBlob(_ref) {\n    var root = _ref.root;\n    var centerX = root.rect.element.width * 0.5;\n    var centerY = root.rect.element.height * 0.5;\n    root.ref.blob = root.appendChildView(root.createChildView(blob, {\n      opacity: 0,\n      scaleX: 2.5,\n      scaleY: 2.5,\n      translateX: centerX,\n      translateY: centerY\n    }));\n  };\n\n  var moveBlob = function moveBlob(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n\n    if (!root.ref.blob) {\n      addBlob({\n        root: root\n      });\n      return;\n    }\n\n    root.ref.blob.translateX = action.position.scopeLeft;\n    root.ref.blob.translateY = action.position.scopeTop;\n    root.ref.blob.scaleX = 1;\n    root.ref.blob.scaleY = 1;\n    root.ref.blob.opacity = 1;\n  };\n\n  var hideBlob = function hideBlob(_ref3) {\n    var root = _ref3.root;\n\n    if (!root.ref.blob) {\n      return;\n    }\n\n    root.ref.blob.opacity = 0;\n  };\n\n  var explodeBlob = function explodeBlob(_ref4) {\n    var root = _ref4.root;\n\n    if (!root.ref.blob) {\n      return;\n    }\n\n    root.ref.blob.scaleX = 2.5;\n    root.ref.blob.scaleY = 2.5;\n    root.ref.blob.opacity = 0;\n  };\n\n  var write$7 = function write(_ref5) {\n    var root = _ref5.root,\n        props = _ref5.props,\n        actions = _ref5.actions;\n    route$4({\n      root: root,\n      props: props,\n      actions: actions\n    });\n    var blob = root.ref.blob;\n\n    if (actions.length === 0 && blob && blob.opacity === 0) {\n      root.removeChildView(blob);\n      root.ref.blob = null;\n    }\n  };\n\n  var route$4 = createRoute({\n    DID_DRAG: moveBlob,\n    DID_DROP: explodeBlob,\n    DID_END_DRAG: hideBlob\n  });\n  var drip = createView({\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'drip',\n    write: write$7\n  });\n\n  var getRootNode = function getRootNode(element) {\n    return 'getRootNode' in element ? element.getRootNode() : document;\n  };\n\n  var images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\n  var text$1 = ['css', 'csv', 'html', 'txt'];\n  var map = {\n    zip: 'zip|compressed',\n    epub: 'application/epub+zip'\n  };\n\n  var guesstimateMimeType = function guesstimateMimeType() {\n    var extension = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    extension = extension.toLowerCase();\n\n    if (images.includes(extension)) {\n      return 'image/' + (extension === 'jpg' ? 'jpeg' : extension === 'svg' ? 'svg+xml' : extension);\n    }\n\n    if (text$1.includes(extension)) {\n      return 'text/' + extension;\n    }\n\n    return map[extension] || null;\n  };\n\n  var requestDataTransferItems = function requestDataTransferItems(dataTransfer) {\n    return new Promise(function (resolve, reject) {\n      // try to get links from transfer, if found we'll exit immidiately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)\n      var links = getLinks(dataTransfer);\n\n      if (links.length && !hasFiles(dataTransfer)) {\n        return resolve(links);\n      } // try to get files from the transfer\n\n\n      getFiles(dataTransfer).then(resolve);\n    });\n  };\n  /**\n   * Test if datatransfer has files\n   */\n\n\n  var hasFiles = function hasFiles(dataTransfer) {\n    if (dataTransfer.files) return dataTransfer.files.length > 0;\n    return false;\n  };\n  /**\n   * Extracts files from a DataTransfer object\n   */\n\n\n  var getFiles = function getFiles(dataTransfer) {\n    return new Promise(function (resolve, reject) {\n      // get the transfer items as promises\n      var promisedFiles = (dataTransfer.items ? Array.from(dataTransfer.items) : []). // only keep file system items (files and directories)\n      filter(function (item) {\n        return isFileSystemItem(item);\n      }) // map each item to promise\n      .map(function (item) {\n        return getFilesFromItem(item);\n      }); // if is empty, see if we can extract some info from the files property as a fallback\n\n      if (!promisedFiles.length) {\n        // TODO: test for directories (should not be allowed)\n        // Use FileReader, problem is that the files property gets lost in the process\n        resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);\n        return;\n      } // done!\n\n\n      Promise.all(promisedFiles).then(function (returnedFileGroups) {\n        // flatten groups\n        var files = [];\n        returnedFileGroups.forEach(function (group) {\n          files.push.apply(files, group);\n        }); // done (filter out empty files)!\n\n        resolve(files.filter(function (file) {\n          return file;\n        }));\n      }).catch(console.error);\n    });\n  };\n\n  var isFileSystemItem = function isFileSystemItem(item) {\n    if (isEntry(item)) {\n      var entry = getAsEntry(item);\n\n      if (entry) {\n        return entry.isFile || entry.isDirectory;\n      }\n    }\n\n    return item.kind === 'file';\n  };\n\n  var getFilesFromItem = function getFilesFromItem(item) {\n    return new Promise(function (resolve, reject) {\n      if (isDirectoryEntry(item)) {\n        getFilesInDirectory(getAsEntry(item)).then(resolve).catch(reject);\n        return;\n      }\n\n      resolve([item.getAsFile()]);\n    });\n  };\n\n  var getFilesInDirectory = function getFilesInDirectory(entry) {\n    return new Promise(function (resolve, reject) {\n      var files = []; // the total entries to read\n\n      var dirCounter = 0;\n      var fileCounter = 0;\n\n      var resolveIfDone = function resolveIfDone() {\n        if (fileCounter === 0 && dirCounter === 0) {\n          resolve(files);\n        }\n      }; // the recursive function\n\n\n      var readEntries = function readEntries(dirEntry) {\n        dirCounter++;\n        var directoryReader = dirEntry.createReader(); // directories are returned in batches, we need to process all batches before we're done\n\n        var readBatch = function readBatch() {\n          directoryReader.readEntries(function (entries) {\n            if (entries.length === 0) {\n              dirCounter--;\n              resolveIfDone();\n              return;\n            }\n\n            entries.forEach(function (entry) {\n              // recursively read more directories\n              if (entry.isDirectory) {\n                readEntries(entry);\n              } else {\n                // read as file\n                fileCounter++;\n                entry.file(function (file) {\n                  files.push(correctMissingFileType(file));\n                  fileCounter--;\n                  resolveIfDone();\n                });\n              }\n            }); // try to get next batch of files\n\n            readBatch();\n          }, reject);\n        }; // read first batch of files\n\n\n        readBatch();\n      }; // go!\n\n\n      readEntries(entry);\n    });\n  };\n\n  var correctMissingFileType = function correctMissingFileType(file) {\n    if (file.type.length) return file;\n    var date = file.lastModifiedDate;\n    var name = file.name;\n    file = file.slice(0, file.size, guesstimateMimeType(getExtensionFromFilename(file.name)));\n    file.name = name;\n    file.lastModifiedDate = date;\n    return file;\n  };\n\n  var isDirectoryEntry = function isDirectoryEntry(item) {\n    return isEntry(item) && (getAsEntry(item) || {}).isDirectory;\n  };\n\n  var isEntry = function isEntry(item) {\n    return 'webkitGetAsEntry' in item;\n  };\n\n  var getAsEntry = function getAsEntry(item) {\n    return item.webkitGetAsEntry();\n  };\n  /**\n   * Extracts links from a DataTransfer object\n   */\n\n\n  var getLinks = function getLinks(dataTransfer) {\n    var links = [];\n\n    try {\n      // look in meta data property\n      links = getLinksFromTransferMetaData(dataTransfer);\n\n      if (links.length) {\n        return links;\n      }\n\n      links = getLinksFromTransferURLData(dataTransfer);\n    } catch (e) {// nope nope nope (probably IE trouble)\n    }\n\n    return links;\n  };\n\n  var getLinksFromTransferURLData = function getLinksFromTransferURLData(dataTransfer) {\n    var data = dataTransfer.getData('url');\n\n    if (typeof data === 'string' && data.length) {\n      return [data];\n    }\n\n    return [];\n  };\n\n  var getLinksFromTransferMetaData = function getLinksFromTransferMetaData(dataTransfer) {\n    var data = dataTransfer.getData('text/html');\n\n    if (typeof data === 'string' && data.length) {\n      var matches = data.match(/src\\s*=\\s*\"(.+?)\"/);\n\n      if (matches) {\n        return [matches[1]];\n      }\n    }\n\n    return [];\n  };\n\n  var dragNDropObservers = [];\n\n  var eventPosition = function eventPosition(e) {\n    return {\n      pageLeft: e.pageX,\n      pageTop: e.pageY,\n      scopeLeft: e.offsetX || e.layerX,\n      scopeTop: e.offsetY || e.layerY\n    };\n  };\n\n  var createDragNDropClient = function createDragNDropClient(element, scopeToObserve, filterElement) {\n    var observer = getDragNDropObserver(scopeToObserve);\n    var client = {\n      element: element,\n      filterElement: filterElement,\n      state: null,\n      ondrop: function ondrop() {},\n      onenter: function onenter() {},\n      ondrag: function ondrag() {},\n      onexit: function onexit() {},\n      onload: function onload() {},\n      allowdrop: function allowdrop() {}\n    };\n    client.destroy = observer.addListener(client);\n    return client;\n  };\n\n  var getDragNDropObserver = function getDragNDropObserver(element) {\n    // see if already exists, if so, return\n    var observer = dragNDropObservers.find(function (item) {\n      return item.element === element;\n    });\n\n    if (observer) {\n      return observer;\n    } // create new observer, does not yet exist for this element\n\n\n    var newObserver = createDragNDropObserver(element);\n    dragNDropObservers.push(newObserver);\n    return newObserver;\n  };\n\n  var createDragNDropObserver = function createDragNDropObserver(element) {\n    var clients = [];\n    var routes = {\n      dragenter: dragenter,\n      dragover: dragover,\n      dragleave: dragleave,\n      drop: drop\n    };\n    var handlers = {};\n    forin(routes, function (event, createHandler) {\n      handlers[event] = createHandler(element, clients);\n      element.addEventListener(event, handlers[event], false);\n    });\n    var observer = {\n      element: element,\n      addListener: function addListener(client) {\n        // add as client\n        clients.push(client); // return removeListener function\n\n        return function () {\n          // remove client\n          clients.splice(clients.indexOf(client), 1); // if no more clients, clean up observer\n\n          if (clients.length === 0) {\n            dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);\n            forin(routes, function (event) {\n              element.removeEventListener(event, handlers[event], false);\n            });\n          }\n        };\n      }\n    };\n    return observer;\n  };\n\n  var elementFromPoint = function elementFromPoint(root, point) {\n    if (!('elementFromPoint' in root)) {\n      root = document;\n    }\n\n    return root.elementFromPoint(point.x, point.y);\n  };\n\n  var isEventTarget = function isEventTarget(e, target) {\n    // get root\n    var root = getRootNode(target); // get element at position\n    // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document\n\n    var elementAtPosition = elementFromPoint(root, {\n      x: e.pageX - window.pageXOffset,\n      y: e.pageY - window.pageYOffset\n    }); // test if target is the element or if one of its children is\n\n    return elementAtPosition === target || target.contains(elementAtPosition);\n  };\n\n  var initialTarget = null;\n\n  var setDropEffect = function setDropEffect(dataTransfer, effect) {\n    // is in try catch as IE11 will throw error if not\n    try {\n      dataTransfer.dropEffect = effect;\n    } catch (e) {}\n  };\n\n  var dragenter = function dragenter(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      initialTarget = e.target;\n      clients.forEach(function (client) {\n        var element = client.element,\n            onenter = client.onenter;\n\n        if (isEventTarget(e, element)) {\n          client.state = 'enter'; // fire enter event\n\n          onenter(eventPosition(e));\n        }\n      });\n    };\n  };\n\n  var dragover = function dragover(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      var dataTransfer = e.dataTransfer;\n      requestDataTransferItems(dataTransfer).then(function (items) {\n        var overDropTarget = false;\n        clients.some(function (client) {\n          var filterElement = client.filterElement,\n              element = client.element,\n              onenter = client.onenter,\n              onexit = client.onexit,\n              ondrag = client.ondrag,\n              allowdrop = client.allowdrop; // by default we can drop\n\n          setDropEffect(dataTransfer, 'copy'); // allow transfer of these items\n\n          var allowsTransfer = allowdrop(items); // only used when can be dropped on page\n\n          if (!allowsTransfer) {\n            setDropEffect(dataTransfer, 'none');\n            return;\n          } // targetting this client\n\n\n          if (isEventTarget(e, element)) {\n            overDropTarget = true; // had no previous state, means we are entering this client\n\n            if (client.state === null) {\n              client.state = 'enter';\n              onenter(eventPosition(e));\n              return;\n            } // now over element (no matter if it allows the drop or not)\n\n\n            client.state = 'over'; // needs to allow transfer\n\n            if (filterElement && !allowsTransfer) {\n              setDropEffect(dataTransfer, 'none');\n              return;\n            } // dragging\n\n\n            ondrag(eventPosition(e));\n          } else {\n            // should be over an element to drop\n            if (filterElement && !overDropTarget) {\n              setDropEffect(dataTransfer, 'none');\n            } // might have just left this client?\n\n\n            if (client.state) {\n              client.state = null;\n              onexit(eventPosition(e));\n            }\n          }\n        });\n      });\n    };\n  };\n\n  var drop = function drop(root, clients) {\n    return function (e) {\n      e.preventDefault();\n      var dataTransfer = e.dataTransfer;\n      requestDataTransferItems(dataTransfer).then(function (items) {\n        clients.forEach(function (client) {\n          var filterElement = client.filterElement,\n              element = client.element,\n              ondrop = client.ondrop,\n              onexit = client.onexit,\n              allowdrop = client.allowdrop;\n          client.state = null; // if we're filtering on element we need to be over the element to drop\n\n          if (filterElement && !isEventTarget(e, element)) return; // no transfer for this client\n\n          if (!allowdrop(items)) return onexit(eventPosition(e)); // we can drop these items on this client\n\n          ondrop(eventPosition(e), items);\n        });\n      });\n    };\n  };\n\n  var dragleave = function dragleave(root, clients) {\n    return function (e) {\n      if (initialTarget !== e.target) {\n        return;\n      }\n\n      clients.forEach(function (client) {\n        var onexit = client.onexit;\n        client.state = null;\n        onexit(eventPosition(e));\n      });\n    };\n  };\n\n  var createHopper = function createHopper(scope, validateItems, options) {\n    // is now hopper scope\n    scope.classList.add('filepond--hopper'); // shortcuts\n\n    var catchesDropsOnPage = options.catchesDropsOnPage,\n        requiresDropOnElement = options.requiresDropOnElement,\n        _options$filterItems = options.filterItems,\n        filterItems = _options$filterItems === void 0 ? function (items) {\n      return items;\n    } : _options$filterItems; // create a dnd client\n\n    var client = createDragNDropClient(scope, catchesDropsOnPage ? document.documentElement : scope, requiresDropOnElement); // current client state\n\n    var lastState = '';\n    var currentState = ''; // determines if a file may be dropped\n\n    client.allowdrop = function (items) {\n      // TODO: if we can, throw error to indicate the items cannot by dropped\n      return validateItems(filterItems(items));\n    };\n\n    client.ondrop = function (position, items) {\n      var filteredItems = filterItems(items);\n\n      if (!validateItems(filteredItems)) {\n        api.ondragend(position);\n        return;\n      }\n\n      currentState = 'drag-drop';\n      api.onload(filteredItems, position);\n    };\n\n    client.ondrag = function (position) {\n      api.ondrag(position);\n    };\n\n    client.onenter = function (position) {\n      currentState = 'drag-over';\n      api.ondragstart(position);\n    };\n\n    client.onexit = function (position) {\n      currentState = 'drag-exit';\n      api.ondragend(position);\n    };\n\n    var api = {\n      updateHopperState: function updateHopperState() {\n        if (lastState !== currentState) {\n          scope.dataset.hopperState = currentState;\n          lastState = currentState;\n        }\n      },\n      onload: function onload() {},\n      ondragstart: function ondragstart() {},\n      ondrag: function ondrag() {},\n      ondragend: function ondragend() {},\n      destroy: function destroy() {\n        // destroy client\n        client.destroy();\n      }\n    };\n    return api;\n  };\n\n  var listening = false;\n  var listeners$1 = [];\n\n  var handlePaste = function handlePaste(e) {\n    requestDataTransferItems(e.clipboardData).then(function (files) {\n      // no files received\n      if (!files.length) {\n        return;\n      } // notify listeners of received files\n\n\n      listeners$1.forEach(function (listener) {\n        return listener(files);\n      });\n    });\n  };\n\n  var listen = function listen(cb) {\n    // can't add twice\n    if (listeners$1.includes(cb)) {\n      return;\n    } // add initial listener\n\n\n    listeners$1.push(cb); // setup paste listener for entire page\n\n    if (listening) {\n      return;\n    }\n\n    listening = true;\n    document.addEventListener('paste', handlePaste);\n  };\n\n  var unlisten = function unlisten(listener) {\n    arrayRemove(listeners$1, listeners$1.indexOf(listener)); // clean up\n\n    if (listeners$1.length === 0) {\n      document.removeEventListener('paste', handlePaste);\n      listening = false;\n    }\n  };\n\n  var createPaster = function createPaster() {\n    var cb = function cb(files) {\n      api.onload(files);\n    };\n\n    var api = {\n      destroy: function destroy() {\n        unlisten(cb);\n      },\n      onload: function onload() {}\n    };\n    listen(cb);\n    return api;\n  };\n  /**\n   * Creates the file view\n   */\n\n\n  var create$c = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props;\n    root.element.id = 'filepond--assistant-' + props.id;\n    attr(root.element, 'role', 'status');\n    attr(root.element, 'aria-live', 'polite');\n    attr(root.element, 'aria-relevant', 'additions');\n  };\n\n  var addFilesNotificationTimeout = null;\n  var notificationClearTimeout = null;\n  var filenames = [];\n\n  var assist = function assist(root, message) {\n    root.element.textContent = message;\n  };\n\n  var clear$1 = function clear(root) {\n    root.element.textContent = '';\n  };\n\n  var listModified = function listModified(root, filename, label) {\n    var total = root.query('GET_TOTAL_ITEMS');\n    assist(root, label + ' ' + filename + ', ' + total + ' ' + (total === 1 ? root.query('GET_LABEL_FILE_COUNT_SINGULAR') : root.query('GET_LABEL_FILE_COUNT_PLURAL'))); // clear group after set amount of time so the status is not read twice\n\n    clearTimeout(notificationClearTimeout);\n    notificationClearTimeout = setTimeout(function () {\n      clear$1(root);\n    }, 1500);\n  };\n\n  var isUsingFilePond = function isUsingFilePond(root) {\n    return root.element.parentNode.contains(document.activeElement);\n  };\n\n  var itemAdded = function itemAdded(_ref2) {\n    var root = _ref2.root,\n        action = _ref2.action;\n\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    root.element.textContent = '';\n    var item = root.query('GET_ITEM', action.id);\n    filenames.push(item.filename);\n    clearTimeout(addFilesNotificationTimeout);\n    addFilesNotificationTimeout = setTimeout(function () {\n      listModified(root, filenames.join(', '), root.query('GET_LABEL_FILE_ADDED'));\n      filenames.length = 0;\n    }, 750);\n  };\n\n  var itemRemoved = function itemRemoved(_ref3) {\n    var root = _ref3.root,\n        action = _ref3.action;\n\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    var item = action.item;\n    listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));\n  };\n\n  var itemProcessed = function itemProcessed(_ref4) {\n    var root = _ref4.root,\n        action = _ref4.action; // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemProcessedUndo = function itemProcessedUndo(_ref5) {\n    var root = _ref5.root,\n        action = _ref5.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemError = function itemError(_ref6) {\n    var root = _ref6.root,\n        action = _ref6.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename; // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    assist(root, action.status.main + ' ' + filename + ' ' + action.status.sub);\n  };\n\n  var assistant = createView({\n    create: create$c,\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: itemAdded,\n      DID_REMOVE_ITEM: itemRemoved,\n      DID_COMPLETE_ITEM_PROCESSING: itemProcessed,\n      DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,\n      DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,\n      DID_THROW_ITEM_REMOVE_ERROR: itemError,\n      DID_THROW_ITEM_LOAD_ERROR: itemError,\n      DID_THROW_ITEM_INVALID: itemError,\n      DID_THROW_ITEM_PROCESSING_ERROR: itemError\n    }),\n    tag: 'span',\n    name: 'assistant'\n  });\n\n  var toCamels = function toCamels(string) {\n    var separator = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string.replace(new RegExp(separator + '.', 'g'), function (sub) {\n      return sub.charAt(1).toUpperCase();\n    });\n  };\n\n  var debounce = function debounce(func) {\n    var interval = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;\n    var immidiateOnly = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    var last = Date.now();\n    var timeout = null;\n    return function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      clearTimeout(timeout);\n      var dist = Date.now() - last;\n\n      var fn = function fn() {\n        last = Date.now();\n        func.apply(void 0, args);\n      };\n\n      if (dist < interval) {\n        // we need to delay by the difference between interval and dist\n        // for example: if distance is 10 ms and interval is 16 ms,\n        // we need to wait an additional 6ms before calling the function)\n        if (!immidiateOnly) {\n          timeout = setTimeout(fn, interval - dist);\n        }\n      } else {\n        // go!\n        fn();\n      }\n    };\n  };\n\n  var MAX_FILES_LIMIT = 1000000;\n\n  var create$d = function create(_ref) {\n    var root = _ref.root,\n        props = _ref.props; // Add id\n\n    var id = root.query('GET_ID');\n\n    if (id) {\n      root.element.id = id;\n    } // Add className\n\n\n    var className = root.query('GET_CLASS_NAME');\n\n    if (className) {\n      className.split(' ').forEach(function (name) {\n        root.element.classList.add(name);\n      });\n    } // Field label\n\n\n    root.ref.label = root.appendChildView(root.createChildView(dropLabel, Object.assign({}, props, {\n      translateY: null,\n      caption: root.query('GET_LABEL_IDLE')\n    }))); // List of items\n\n    root.ref.list = root.appendChildView(root.createChildView(listScroller, {\n      translateY: null\n    })); // Background panel\n\n    root.ref.panel = root.appendChildView(root.createChildView(panel, {\n      name: 'panel-root'\n    })); // Assistant notifies assistive tech when content changes\n\n    root.ref.assistant = root.appendChildView(root.createChildView(assistant, Object.assign({}, props))); // Measure (tests if fixed height was set)\n    // DOCTYPE needs to be set for this to work\n\n    root.ref.measure = createElement$1('div');\n    root.ref.measure.style.height = '100%';\n    root.element.appendChild(root.ref.measure); // information on the root height or fixed height status\n\n    root.ref.bounds = null; // apply initial style properties\n\n    root.query('GET_STYLES').filter(function (style) {\n      return !isEmpty(style.value);\n    }).map(function (_ref2) {\n      var name = _ref2.name,\n          value = _ref2.value;\n      root.element.dataset[name] = value;\n    }); // determine if width changed\n\n    root.ref.widthPrevious = null;\n    root.ref.widthUpdated = debounce(function () {\n      root.ref.updateHistory = [];\n      root.dispatch('DID_RESIZE_ROOT');\n    }, 250); // history of updates\n\n    root.ref.previousAspectRatio = null;\n    root.ref.updateHistory = [];\n  };\n\n  var write$8 = function write(_ref3) {\n    var root = _ref3.root,\n        props = _ref3.props,\n        actions = _ref3.actions; // route actions\n\n    route$5({\n      root: root,\n      props: props,\n      actions: actions\n    }); // apply style properties\n\n    actions.filter(function (action) {\n      return /^DID_SET_STYLE_/.test(action.type);\n    }).filter(function (action) {\n      return !isEmpty(action.data.value);\n    }).map(function (_ref4) {\n      var type = _ref4.type,\n          data = _ref4.data;\n      var name = toCamels(type.substr(8).toLowerCase(), '_');\n      root.element.dataset[name] = data.value;\n      root.invalidateLayout();\n    });\n    if (root.rect.element.hidden) return;\n\n    if (root.rect.element.width !== root.ref.widthPrevious) {\n      root.ref.widthPrevious = root.rect.element.width;\n      root.ref.widthUpdated();\n    } // get box bounds, we do this only once\n\n\n    var bounds = root.ref.bounds;\n\n    if (!bounds) {\n      bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root); // destroy measure element\n\n      root.element.removeChild(root.ref.measure);\n      root.ref.measure = null;\n    } // get quick references to various high level parts of the upload tool\n\n\n    var _root$ref = root.ref,\n        hopper = _root$ref.hopper,\n        label = _root$ref.label,\n        list = _root$ref.list,\n        panel = _root$ref.panel; // sets correct state to hopper scope\n\n    if (hopper) {\n      hopper.updateHopperState();\n    } // bool to indicate if we're full or not\n\n\n    var aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n    var isMultiItem = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = isMultiItem ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT : 1;\n    var atMaxCapacity = totalItems === maxItems; // action used to add item\n\n    var addAction = actions.find(function (action) {\n      return action.type === 'DID_ADD_ITEM';\n    }); // if reached max capacity and we've just reached it\n\n    if (atMaxCapacity && addAction) {\n      // get interaction type\n      var interactionMethod = addAction.data.interactionMethod; // hide label\n\n      label.opacity = 0;\n\n      if (isMultiItem) {\n        label.translateY = -40;\n      } else {\n        if (interactionMethod === InteractionMethod.API) {\n          label.translateX = 40;\n        } else if (interactionMethod === InteractionMethod.BROWSE) {\n          label.translateY = 40;\n        } else {\n          label.translateY = 30;\n        }\n      }\n    } else if (!atMaxCapacity) {\n      label.opacity = 1;\n      label.translateX = 0;\n      label.translateY = 0;\n    }\n\n    var listItemMargin = calculateListItemMargin(root);\n    var listHeight = calculateListHeight(root);\n    var labelHeight = label.rect.element.height;\n    var currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;\n    var listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;\n    var listMarginBottom = totalItems === 0 ? 0 : list.rect.element.marginBottom;\n    var visualHeight = currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;\n    var boundsHeight = currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom; // link list to label bottom position\n\n    list.translateY = Math.max(0, currentLabelHeight - list.rect.element.marginTop) - listItemMargin.top;\n\n    if (aspectRatio) {\n      // fixed aspect ratio\n      // calculate height based on width\n      var width = root.rect.element.width;\n      var height = width * aspectRatio; // clear history if aspect ratio has changed\n\n      if (aspectRatio !== root.ref.previousAspectRatio) {\n        root.ref.previousAspectRatio = aspectRatio;\n        root.ref.updateHistory = [];\n      } // remember this width\n\n\n      var history = root.ref.updateHistory;\n      history.push(width);\n      var MAX_BOUNCES = 2;\n\n      if (history.length > MAX_BOUNCES * 2) {\n        var l = history.length;\n        var bottom = l - 10;\n        var bounces = 0;\n\n        for (var i = l; i >= bottom; i--) {\n          if (history[i] === history[i - 2]) {\n            bounces++;\n          }\n\n          if (bounces >= MAX_BOUNCES) {\n            // dont adjust height\n            return;\n          }\n        }\n      } // fix height of panel so it adheres to aspect ratio\n\n\n      panel.scalable = false;\n      panel.height = height; // available height for list\n\n      var listAvailableHeight = // the height of the panel minus the label height\n      height - currentLabelHeight - ( // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - ( // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0);\n\n      if (listHeight.visual > listAvailableHeight) {\n        list.overflow = listAvailableHeight;\n      } else {\n        list.overflow = null;\n      } // set container bounds (so pushes siblings downwards)\n\n\n      root.height = height;\n    } else if (bounds.fixedHeight) {\n      // fixed height\n      // fix height of panel\n      panel.scalable = false; // available height for list\n\n      var _listAvailableHeight = // the height of the panel minus the label height\n      bounds.fixedHeight - currentLabelHeight - ( // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - ( // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0); // set list height\n\n\n      if (listHeight.visual > _listAvailableHeight) {\n        list.overflow = _listAvailableHeight;\n      } else {\n        list.overflow = null;\n      } // no need to set container bounds as these are handles by CSS fixed height\n\n    } else if (bounds.cappedHeight) {\n      // max-height\n      // not a fixed height panel\n      var isCappedHeight = visualHeight >= bounds.cappedHeight;\n      var panelHeight = Math.min(bounds.cappedHeight, visualHeight);\n      panel.scalable = true;\n      panel.height = isCappedHeight ? panelHeight : panelHeight - listItemMargin.top - listItemMargin.bottom; // available height for list\n\n      var _listAvailableHeight2 = // the height of the panel minus the label height\n      panelHeight - currentLabelHeight - ( // the room we leave open between the end of the list and the panel bottom\n      listMarginBottom - listItemMargin.bottom) - ( // if we're full we need to leave some room between the top of the panel and the list\n      atMaxCapacity ? listMarginTop : 0); // set list height (if is overflowing)\n\n\n      if (visualHeight > bounds.cappedHeight && listHeight.visual > _listAvailableHeight2) {\n        list.overflow = _listAvailableHeight2;\n      } else {\n        list.overflow = null;\n      } // set container bounds (so pushes siblings downwards)\n\n\n      root.height = Math.min(bounds.cappedHeight, boundsHeight - listItemMargin.top - listItemMargin.bottom);\n    } else {\n      // flexible height\n      // not a fixed height panel\n      var itemMargin = totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;\n      panel.scalable = true;\n      panel.height = Math.max(labelHeight, visualHeight - itemMargin); // set container bounds (so pushes siblings downwards)\n\n      root.height = Math.max(labelHeight, boundsHeight - itemMargin);\n    }\n  };\n\n  var calculateListItemMargin = function calculateListItemMargin(root) {\n    var item = root.ref.list.childViews[0].childViews[0];\n    return item ? {\n      top: item.rect.element.marginTop,\n      bottom: item.rect.element.marginBottom\n    } : {\n      top: 0,\n      bottom: 0\n    };\n  };\n\n  var calculateListHeight = function calculateListHeight(root) {\n    var visual = 0;\n    var bounds = 0; // get file list reference\n\n    var scrollList = root.ref.list;\n    var itemList = scrollList.childViews[0];\n    var children = itemList.childViews; // no children, done!\n\n    if (children.length === 0) return {\n      visual: visual,\n      bounds: bounds\n    };\n    var horizontalSpace = itemList.rect.element.width;\n    var dragIndex = getItemIndexByPosition(itemList, scrollList.dragCoordinates);\n    var childRect = children[0].rect.element;\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n    var newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;\n    var removedItem = children.find(function (child) {\n      return child.markedForRemoval && child.opacity < 0.45;\n    }) ? -1 : 0;\n    var verticalItemCount = children.length + newItem + removedItem;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth); // stack\n\n    if (itemsPerRow === 1) {\n      children.forEach(function (item) {\n        var height = item.rect.element.height + itemVerticalMargin;\n        bounds += height;\n        visual += height * item.opacity;\n      });\n    } // grid\n    else {\n        bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;\n        visual = bounds;\n      }\n\n    return {\n      visual: visual,\n      bounds: bounds\n    };\n  };\n\n  var calculateRootBoundingBoxHeight = function calculateRootBoundingBoxHeight(root) {\n    var height = root.ref.measureHeight || null;\n    var cappedHeight = parseInt(root.style.maxHeight, 10) || null;\n    var fixedHeight = height === 0 ? null : height;\n    return {\n      cappedHeight: cappedHeight,\n      fixedHeight: fixedHeight\n    };\n  };\n\n  var exceedsMaxFiles = function exceedsMaxFiles(root, items) {\n    var allowReplace = root.query('GET_ALLOW_REPLACE');\n    var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = root.query('GET_MAX_FILES'); // total amount of items being dragged\n\n    var totalBrowseItems = items.length; // if does not allow multiple items and dragging more than one item\n\n    if (!allowMultiple && totalBrowseItems > 1) {\n      return true;\n    } // limit max items to one if not allowed to drop multiple items\n\n\n    maxItems = allowMultiple ? maxItems : allowReplace ? maxItems : 1; // no more room?\n\n    var hasMaxItems = isInt(maxItems);\n\n    if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {\n      root.dispatch('DID_THROW_MAX_FILES', {\n        source: items,\n        error: createResponse('warning', 0, 'Max files')\n      });\n      return true;\n    }\n\n    return false;\n  };\n\n  var getDragIndex = function getDragIndex(list, position) {\n    var itemList = list.childViews[0];\n    return getItemIndexByPosition(itemList, {\n      left: position.scopeLeft - itemList.rect.element.left,\n      top: position.scopeTop - (list.rect.outer.top + list.rect.element.marginTop + list.rect.element.scrollTop)\n    });\n  };\n  /**\n   * Enable or disable file drop functionality\n   */\n\n\n  var toggleDrop = function toggleDrop(root) {\n    var isAllowed = root.query('GET_ALLOW_DROP');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n\n    if (enabled && !root.ref.hopper) {\n      var hopper = createHopper(root.element, function (items) {\n        // these files don't fit so stop here\n        if (exceedsMaxFiles(root, items)) return false; // allow quick validation of dropped items\n\n        var beforeDropFile = root.query('GET_BEFORE_DROP_FILE') || function () {\n          return true;\n        }; // all items should be validated by all filters as valid\n\n\n        var dropValidation = root.query('GET_DROP_VALIDATION');\n        return dropValidation ? items.every(function (item) {\n          return applyFilters('ALLOW_HOPPER_ITEM', item, {\n            query: root.query\n          }).every(function (result) {\n            return result === true;\n          }) && beforeDropFile(item);\n        }) : true;\n      }, {\n        filterItems: function filterItems(items) {\n          var ignoredFiles = root.query('GET_IGNORED_FILES');\n          return items.filter(function (item) {\n            if (isFile(item)) {\n              return !ignoredFiles.includes(item.name.toLowerCase());\n            }\n\n            return true;\n          });\n        },\n        catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),\n        requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT')\n      });\n\n      hopper.onload = function (items, position) {\n        root.dispatch('ADD_ITEMS', {\n          items: items,\n          index: getDragIndex(root.ref.list, position),\n          interactionMethod: InteractionMethod.DROP\n        });\n        root.dispatch('DID_DROP', {\n          position: position\n        });\n        root.dispatch('DID_END_DRAG', {\n          position: position\n        });\n      };\n\n      hopper.ondragstart = function (position) {\n        root.dispatch('DID_START_DRAG', {\n          position: position\n        });\n      };\n\n      hopper.ondrag = debounce(function (position) {\n        root.dispatch('DID_DRAG', {\n          position: position\n        });\n      });\n\n      hopper.ondragend = function (position) {\n        root.dispatch('DID_END_DRAG', {\n          position: position\n        });\n      };\n\n      root.ref.hopper = hopper;\n      root.ref.drip = root.appendChildView(root.createChildView(drip));\n    } else if (!enabled && root.ref.hopper) {\n      root.ref.hopper.destroy();\n      root.ref.hopper = null;\n      root.removeChildView(root.ref.drip);\n    }\n  };\n  /**\n   * Enable or disable browse functionality\n   */\n\n\n  var toggleBrowse = function toggleBrowse(root, props) {\n    var isAllowed = root.query('GET_ALLOW_BROWSE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n\n    if (enabled && !root.ref.browser) {\n      root.ref.browser = root.appendChildView(root.createChildView(browser, Object.assign({}, props, {\n        onload: function onload(items) {\n          // these files don't fit so stop here\n          if (exceedsMaxFiles(root, items)) return false; // add items!\n\n          root.dispatch('ADD_ITEMS', {\n            items: items,\n            index: -1,\n            interactionMethod: InteractionMethod.BROWSE\n          });\n        }\n      })), 0);\n    } else if (!enabled && root.ref.browser) {\n      root.removeChildView(root.ref.browser);\n      root.ref.browser = null;\n    }\n  };\n  /**\n   * Enable or disable paste functionality\n   */\n\n\n  var togglePaste = function togglePaste(root) {\n    var isAllowed = root.query('GET_ALLOW_PASTE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n\n    if (enabled && !root.ref.paster) {\n      root.ref.paster = createPaster();\n\n      root.ref.paster.onload = function (items) {\n        root.dispatch('ADD_ITEMS', {\n          items: items,\n          index: -1,\n          interactionMethod: InteractionMethod.PASTE\n        });\n      };\n    } else if (!enabled && root.ref.paster) {\n      root.ref.paster.destroy();\n      root.ref.paster = null;\n    }\n  };\n  /**\n   * Route actions\n   */\n\n\n  var route$5 = createRoute({\n    DID_SET_ALLOW_BROWSE: function DID_SET_ALLOW_BROWSE(_ref5) {\n      var root = _ref5.root,\n          props = _ref5.props;\n      toggleBrowse(root, props);\n    },\n    DID_SET_ALLOW_DROP: function DID_SET_ALLOW_DROP(_ref6) {\n      var root = _ref6.root;\n      toggleDrop(root);\n    },\n    DID_SET_ALLOW_PASTE: function DID_SET_ALLOW_PASTE(_ref7) {\n      var root = _ref7.root;\n      togglePaste(root);\n    },\n    DID_SET_DISABLED: function DID_SET_DISABLED(_ref8) {\n      var root = _ref8.root,\n          props = _ref8.props;\n      toggleDrop(root);\n      togglePaste(root);\n      toggleBrowse(root, props);\n      var isDisabled = root.query('GET_DISABLED');\n\n      if (isDisabled) {\n        root.element.dataset.disabled = 'disabled';\n      } else {\n        // delete root.element.dataset.disabled; <= this does not work on iOS 10\n        root.element.removeAttribute('data-disabled');\n      }\n    }\n  });\n  var root = createView({\n    name: 'root',\n    read: function read(_ref9) {\n      var root = _ref9.root;\n\n      if (root.ref.measure) {\n        root.ref.measureHeight = root.ref.measure.offsetHeight;\n      }\n    },\n    create: create$d,\n    write: write$8,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n\n      if (root.ref.paster) {\n        root.ref.paster.destroy();\n      }\n\n      if (root.ref.hopper) {\n        root.ref.hopper.destroy();\n      }\n    },\n    mixins: {\n      styles: ['height']\n    }\n  }); // creates the app\n\n  var createApp = function createApp() {\n    var initialOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}; // let element\n\n    var originalElement = null; // get default options\n\n    var defaultOptions = getOptions(); // create the data store, this will contain all our app info\n\n    var store = createStore( // initial state (should be serializable)\n    createInitialState(defaultOptions), // queries\n    [queries, createOptionQueries(defaultOptions)], // action handlers\n    [actions, createOptionActions(defaultOptions)]); // set initial options\n\n    store.dispatch('SET_OPTIONS', {\n      options: initialOptions\n    }); // kick thread if visibility changes\n\n    var visibilityHandler = function visibilityHandler() {\n      if (document.hidden) return;\n      store.dispatch('KICK');\n    };\n\n    document.addEventListener('visibilitychange', visibilityHandler); // re-render on window resize start and finish\n\n    var resizeDoneTimer = null;\n    var isResizing = false;\n    var isResizingHorizontally = false;\n    var initialWindowWidth = null;\n    var currentWindowWidth = null;\n\n    var resizeHandler = function resizeHandler() {\n      if (!isResizing) {\n        isResizing = true;\n      }\n\n      clearTimeout(resizeDoneTimer);\n      resizeDoneTimer = setTimeout(function () {\n        isResizing = false;\n        initialWindowWidth = null;\n        currentWindowWidth = null;\n\n        if (isResizingHorizontally) {\n          isResizingHorizontally = false;\n          store.dispatch('DID_STOP_RESIZE');\n        }\n      }, 500);\n    };\n\n    window.addEventListener('resize', resizeHandler); // render initial view\n\n    var view = root(store, {\n      id: getUniqueId()\n    }); //\n    // PRIVATE API -------------------------------------------------------------------------------------\n    //\n\n    var isResting = false;\n    var isHidden = false;\n    var readWriteApi = {\n      // necessary for update loop\n\n      /**\n       * Reads from dom (never call manually)\n       * @private\n       */\n      _read: function _read() {\n        // test if we're resizing horizontally\n        // TODO: see if we can optimize this by measuring root rect\n        if (isResizing) {\n          currentWindowWidth = window.innerWidth;\n\n          if (!initialWindowWidth) {\n            initialWindowWidth = currentWindowWidth;\n          }\n\n          if (!isResizingHorizontally && currentWindowWidth !== initialWindowWidth) {\n            store.dispatch('DID_START_RESIZE');\n            isResizingHorizontally = true;\n          }\n        }\n\n        if (isHidden && isResting) {\n          // test if is no longer hidden\n          isResting = view.element.offsetParent === null;\n        } // if resting, no need to read as numbers will still all be correct\n\n\n        if (isResting) return; // read view data\n\n        view._read(); // if is hidden we need to know so we exit rest mode when revealed\n\n\n        isHidden = view.rect.element.hidden;\n      },\n\n      /**\n       * Writes to dom (never call manually)\n       * @private\n       */\n      _write: function _write(ts) {\n        // get all actions from store\n        var actions = store.processActionQueue() // filter out set actions (these will automatically trigger DID_SET)\n        .filter(function (action) {\n          return !/^SET_/.test(action.type);\n        }); // if was idling and no actions stop here\n\n        if (isResting && !actions.length) return; // some actions might trigger events\n\n        routeActionsToEvents(actions); // update the view\n\n        isResting = view._write(ts, actions, isResizingHorizontally); // will clean up all archived items\n\n        removeReleasedItems(store.query('GET_ITEMS')); // now idling\n\n        if (isResting) {\n          store.processDispatchQueue();\n        }\n      }\n    }; //\n    // EXPOSE EVENTS -------------------------------------------------------------------------------------\n    //\n\n    var createEvent = function createEvent(name) {\n      return function (data) {\n        // create default event\n        var event = {\n          type: name\n        }; // no data to add\n\n        if (!data) {\n          return event;\n        } // copy relevant props\n\n\n        if (data.hasOwnProperty('error')) {\n          event.error = data.error ? Object.assign({}, data.error) : null;\n        }\n\n        if (data.status) {\n          event.status = Object.assign({}, data.status);\n        }\n\n        if (data.file) {\n          event.output = data.file;\n        } // only source is available, else add item if possible\n\n\n        if (data.source) {\n          event.file = data.source;\n        } else if (data.item || data.id) {\n          var item = data.item ? data.item : store.query('GET_ITEM', data.id);\n          event.file = item ? createItemAPI(item) : null;\n        } // map all items in a possible items array\n\n\n        if (data.items) {\n          event.items = data.items.map(createItemAPI);\n        } // if this is a progress event add the progress amount\n\n\n        if (/progress/.test(name)) {\n          event.progress = data.progress;\n        }\n\n        return event;\n      };\n    };\n\n    var eventRoutes = {\n      DID_DESTROY: createEvent('destroy'),\n      DID_INIT: createEvent('init'),\n      DID_THROW_MAX_FILES: createEvent('warning'),\n      DID_START_ITEM_LOAD: createEvent('addfilestart'),\n      DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),\n      DID_LOAD_ITEM: createEvent('addfile'),\n      DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],\n      DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],\n      DID_THROW_ITEM_REMOVE_ERROR: [createEvent('error'), createEvent('removefile')],\n      DID_PREPARE_OUTPUT: createEvent('preparefile'),\n      DID_START_ITEM_PROCESSING: createEvent('processfilestart'),\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),\n      DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),\n      DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),\n      DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),\n      DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),\n      DID_THROW_ITEM_PROCESSING_ERROR: [createEvent('error'), createEvent('processfile')],\n      DID_REMOVE_ITEM: createEvent('removefile'),\n      DID_UPDATE_ITEMS: createEvent('updatefiles'),\n      DID_ACTIVATE_ITEM: createEvent('activatefile')\n    };\n\n    var exposeEvent = function exposeEvent(event) {\n      // create event object to be dispatched\n      var detail = Object.assign({\n        pond: exports\n      }, event);\n      delete detail.type;\n      view.element.dispatchEvent(new CustomEvent('FilePond:' + event.type, {\n        // event info\n        detail: detail,\n        // event behaviour\n        bubbles: true,\n        cancelable: true,\n        composed: true // triggers listeners outside of shadow root\n\n      })); // event object to params used for `on()` event handlers and callbacks `oninit()`\n\n      var params = []; // if is possible error event, make it the first param\n\n      if (event.hasOwnProperty('error')) {\n        params.push(event.error);\n      } // file is always section\n\n\n      if (event.hasOwnProperty('file')) {\n        params.push(event.file);\n      } // append other props\n\n\n      var filtered = ['type', 'error', 'file'];\n      Object.keys(event).filter(function (key) {\n        return !filtered.includes(key);\n      }).forEach(function (key) {\n        return params.push(event[key]);\n      }); // on(type, () => { })\n\n      exports.fire.apply(exports, [event.type].concat(params)); // oninit = () => {}\n\n      var handler = store.query('GET_ON' + event.type.toUpperCase());\n\n      if (handler) {\n        handler.apply(void 0, params);\n      }\n    };\n\n    var routeActionsToEvents = function routeActionsToEvents(actions) {\n      if (!actions.length) {\n        return;\n      }\n\n      actions.forEach(function (action) {\n        if (!eventRoutes[action.type]) {\n          return;\n        }\n\n        var routes = eventRoutes[action.type];\n        (Array.isArray(routes) ? routes : [routes]).forEach(function (route) {\n          setTimeout(function () {\n            exposeEvent(route(action.data));\n          }, 0);\n        });\n      });\n    }; //\n    // PUBLIC API -------------------------------------------------------------------------------------\n    //\n\n\n    var setOptions = function setOptions(options) {\n      return store.dispatch('SET_OPTIONS', {\n        options: options\n      });\n    };\n\n    var getFile = function getFile(query) {\n      return store.query('GET_ACTIVE_ITEM', query);\n    };\n\n    var addFile = function addFile(source) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return new Promise(function (resolve, reject) {\n        addFiles([{\n          source: source,\n          options: options\n        }], {\n          index: options.index\n        }).then(function (items) {\n          return resolve(items && items[0]);\n        }).catch(reject);\n      });\n    };\n\n    var removeFile = function removeFile(query) {\n      // request item removal\n      store.dispatch('REMOVE_ITEM', {\n        query: query\n      }); // see if item has been removed\n\n      return store.query('GET_ACTIVE_ITEM', query) === null;\n    };\n\n    var addFiles = function addFiles() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return new Promise(function (resolve, reject) {\n        var sources = [];\n        var options = {}; // user passed a sources array\n\n        if (isArray(args[0])) {\n          sources.push.apply(sources, args[0]);\n          Object.assign(options, args[1] || {});\n        } else {\n          // user passed sources as arguments, last one might be options object\n          var lastArgument = args[args.length - 1];\n\n          if (typeof lastArgument === 'object' && !(lastArgument instanceof Blob)) {\n            Object.assign(options, args.pop());\n          } // add rest to sources\n\n\n          sources.push.apply(sources, args);\n        }\n\n        store.dispatch('ADD_ITEMS', {\n          items: sources,\n          index: options.index,\n          interactionMethod: InteractionMethod.API,\n          success: resolve,\n          failure: reject\n        });\n      });\n    };\n\n    var getFiles = function getFiles() {\n      return store.query('GET_ACTIVE_ITEMS');\n    };\n\n    var processFile = function processFile(query) {\n      return new Promise(function (resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PROCESSING', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n\n    var processFiles = function processFiles() {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n\n      if (!queries.length) {\n        var files = getFiles().filter(function (item) {\n          return !(item.status === ItemStatus.IDLE && item.origin === FileOrigin.LOCAL) && item.status !== ItemStatus.PROCESSING && item.status !== ItemStatus.PROCESSING_COMPLETE && item.status !== ItemStatus.PROCESSING_REVERT_ERROR;\n        });\n        return Promise.all(files.map(processFile));\n      }\n\n      return Promise.all(queries.map(processFile));\n    };\n\n    var removeFiles = function removeFiles() {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      var files = getFiles();\n\n      if (!queries.length) {\n        return Promise.all(files.map(removeFile));\n      } // when removing by index the indexes shift after each file removal so we need to convert indexes to ids\n\n\n      var mappedQueries = queries.map(function (query) {\n        return isNumber(query) ? files[query] ? files[query].id : null : query;\n      }).filter(function (query) {\n        return query;\n      });\n      return mappedQueries.map(removeFile);\n    };\n\n    var exports = Object.assign({}, on(), {}, readWriteApi, {}, createOptionAPI(store, defaultOptions), {\n      /**\n       * Override options defined in options object\n       * @param options\n       */\n      setOptions: setOptions,\n\n      /**\n       * Load the given file\n       * @param source - the source of the file (either a File, base64 data uri or url)\n       * @param options - object, { index: 0 }\n       */\n      addFile: addFile,\n\n      /**\n       * Load the given files\n       * @param sources - the sources of the files to load\n       * @param options - object, { index: 0 }\n       */\n      addFiles: addFiles,\n\n      /**\n       * Returns the file objects matching the given query\n       * @param query { string, number, null }\n       */\n      getFile: getFile,\n\n      /**\n       * Upload file with given name\n       * @param query { string, number, null  }\n       */\n      processFile: processFile,\n\n      /**\n       * Removes a file by its name\n       * @param query { string, number, null  }\n       */\n      removeFile: removeFile,\n\n      /**\n       * Returns all files (wrapped in public api)\n       */\n      getFiles: getFiles,\n\n      /**\n       * Starts uploading all files\n       */\n      processFiles: processFiles,\n\n      /**\n       * Clears all files from the files list\n       */\n      removeFiles: removeFiles,\n\n      /**\n       * Sort list of files\n       */\n      sort: function sort(compare) {\n        return store.dispatch('SORT', {\n          compare: compare\n        });\n      },\n\n      /**\n       * Browse the file system for a file\n       */\n      browse: function browse() {\n        // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)\n        var input = view.element.querySelector('input[type=file]');\n\n        if (input) {\n          input.click();\n        }\n      },\n\n      /**\n       * Destroys the app\n       */\n      destroy: function destroy() {\n        // request destruction\n        exports.fire('destroy', view.element); // stop active processes (file uploads, fetches, stuff like that)\n        // loop over items and depending on states call abort for ongoing processes\n\n        store.dispatch('ABORT_ALL'); // destroy view\n\n        view._destroy(); // stop listening to resize\n\n\n        window.removeEventListener('resize', resizeHandler); // stop listening to the visiblitychange event\n\n        document.removeEventListener('visibilitychange', visibilityHandler); // dispatch destroy\n\n        store.dispatch('DID_DESTROY');\n      },\n\n      /**\n       * Inserts the plugin before the target element\n       */\n      insertBefore: function insertBefore$1(element) {\n        return insertBefore(view.element, element);\n      },\n\n      /**\n       * Inserts the plugin after the target element\n       */\n      insertAfter: function insertAfter$1(element) {\n        return insertAfter(view.element, element);\n      },\n\n      /**\n       * Appends the plugin to the target element\n       */\n      appendTo: function appendTo(element) {\n        return element.appendChild(view.element);\n      },\n\n      /**\n       * Replaces an element with the app\n       */\n      replaceElement: function replaceElement(element) {\n        // insert the app before the element\n        insertBefore(view.element, element); // remove the original element\n\n        element.parentNode.removeChild(element); // remember original element\n\n        originalElement = element;\n      },\n\n      /**\n       * Restores the original element\n       */\n      restoreElement: function restoreElement() {\n        if (!originalElement) {\n          return; // no element to restore\n        } // restore original element\n\n\n        insertAfter(originalElement, view.element); // remove our element\n\n        view.element.parentNode.removeChild(view.element); // remove reference\n\n        originalElement = null;\n      },\n\n      /**\n       * Returns true if the app root is attached to given element\n       * @param element\n       */\n      isAttachedTo: function isAttachedTo(element) {\n        return view.element === element || originalElement === element;\n      },\n\n      /**\n       * Returns the root element\n       */\n      element: {\n        get: function get() {\n          return view.element;\n        }\n      },\n\n      /**\n       * Returns the current pond status\n       */\n      status: {\n        get: function get() {\n          return store.query('GET_STATUS');\n        }\n      }\n    }); // Done!\n\n    store.dispatch('DID_INIT'); // create actual api object\n\n    return createObject(exports);\n  };\n\n  var createAppObject = function createAppObject() {\n    var customOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {}; // default options\n\n    var defaultOptions = {};\n    forin(getOptions(), function (key, value) {\n      defaultOptions[key] = value[0];\n    }); // set app options\n\n    var app = createApp(Object.assign({}, defaultOptions, {}, customOptions)); // return the plugin instance\n\n    return app;\n  };\n\n  var lowerCaseFirstLetter = function lowerCaseFirstLetter(string) {\n    return string.charAt(0).toLowerCase() + string.slice(1);\n  };\n\n  var attributeNameToPropertyName = function attributeNameToPropertyName(attributeName) {\n    return toCamels(attributeName.replace(/^data-/, ''));\n  };\n\n  var mapObject = function mapObject(object, propertyMap) {\n    // remove unwanted\n    forin(propertyMap, function (selector, mapping) {\n      forin(object, function (property, value) {\n        // create regexp shortcut\n        var selectorRegExp = new RegExp(selector); // tests if\n\n        var matches = selectorRegExp.test(property); // no match, skip\n\n        if (!matches) {\n          return;\n        } // if there's a mapping, the original property is always removed\n\n\n        delete object[property]; // should only remove, we done!\n\n        if (mapping === false) {\n          return;\n        } // move value to new property\n\n\n        if (isString(mapping)) {\n          object[mapping] = value;\n          return;\n        } // move to group\n\n\n        var group = mapping.group;\n\n        if (isObject(mapping) && !object[group]) {\n          object[group] = {};\n        }\n\n        object[group][lowerCaseFirstLetter(property.replace(selectorRegExp, ''))] = value;\n      }); // do submapping\n\n      if (mapping.mapping) {\n        mapObject(object[mapping.group], mapping.mapping);\n      }\n    });\n  };\n\n  var getAttributesAsObject = function getAttributesAsObject(node) {\n    var attributeMapping = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {}; // turn attributes into object\n\n    var attributes = [];\n    forin(node.attributes, function (index) {\n      attributes.push(node.attributes[index]);\n    });\n    var output = attributes.filter(function (attribute) {\n      return attribute.name;\n    }).reduce(function (obj, attribute) {\n      var value = attr(node, attribute.name);\n      obj[attributeNameToPropertyName(attribute.name)] = value === attribute.name ? true : value;\n      return obj;\n    }, {}); // do mapping of object properties\n\n    mapObject(output, attributeMapping);\n    return output;\n  };\n\n  var createAppAtElement = function createAppAtElement(element) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {}; // how attributes of the input element are mapped to the options for the plugin\n\n    var attributeMapping = {\n      // translate to other name\n      '^class$': 'className',\n      '^multiple$': 'allowMultiple',\n      '^capture$': 'captureMethod',\n      // group under single property\n      '^server': {\n        group: 'server',\n        mapping: {\n          '^process': {\n            group: 'process'\n          },\n          '^revert': {\n            group: 'revert'\n          },\n          '^fetch': {\n            group: 'fetch'\n          },\n          '^restore': {\n            group: 'restore'\n          },\n          '^load': {\n            group: 'load'\n          }\n        }\n      },\n      // don't include in object\n      '^type$': false,\n      '^files$': false\n    }; // add additional option translators\n\n    applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping); // create final options object by setting options object and then overriding options supplied on element\n\n    var mergedOptions = Object.assign({}, options);\n    var attributeOptions = getAttributesAsObject(element.nodeName === 'FIELDSET' ? element.querySelector('input[type=file]') : element, attributeMapping); // merge with options object\n\n    Object.keys(attributeOptions).forEach(function (key) {\n      if (isObject(attributeOptions[key])) {\n        if (!isObject(mergedOptions[key])) {\n          mergedOptions[key] = {};\n        }\n\n        Object.assign(mergedOptions[key], attributeOptions[key]);\n      } else {\n        mergedOptions[key] = attributeOptions[key];\n      }\n    }); // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields\n    // these will then be automatically set to the initial files\n\n    mergedOptions.files = (options.files || []).concat(Array.from(element.querySelectorAll('input:not([type=file])')).map(function (input) {\n      return {\n        source: input.value,\n        options: {\n          type: input.dataset.type\n        }\n      };\n    })); // build plugin\n\n    var app = createAppObject(mergedOptions); // add already selected files\n\n    if (element.files) {\n      Array.from(element.files).forEach(function (file) {\n        app.addFile(file);\n      });\n    } // replace the target element\n\n\n    app.replaceElement(element); // expose\n\n    return app;\n  }; // if an element is passed, we create the instance at that element, if not, we just create an up object\n\n\n  var createApp$1 = function createApp() {\n    return isNode(arguments.length <= 0 ? undefined : arguments[0]) ? createAppAtElement.apply(void 0, arguments) : createAppObject.apply(void 0, arguments);\n  };\n\n  var PRIVATE_METHODS = ['fire', '_read', '_write'];\n\n  var createAppAPI = function createAppAPI(app) {\n    var api = {};\n    copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);\n    return api;\n  };\n  /**\n   * Replaces placeholders in given string with replacements\n   * @param string - \"Foo {bar}\"\"\n   * @param replacements - { \"bar\": 10 }\n   */\n\n\n  var replaceInString = function replaceInString(string, replacements) {\n    return string.replace(/(?:{([a-zA-Z]+)})/g, function (match, group) {\n      return replacements[group];\n    });\n  };\n\n  var createWorker = function createWorker(fn) {\n    var workerBlob = new Blob(['(', fn.toString(), ')()'], {\n      type: 'application/javascript'\n    });\n    var workerURL = URL.createObjectURL(workerBlob);\n    var worker = new Worker(workerURL);\n    return {\n      transfer: function transfer(message, cb) {},\n      post: function post(message, cb, transferList) {\n        var id = getUniqueId();\n\n        worker.onmessage = function (e) {\n          if (e.data.id === id) {\n            cb(e.data.message);\n          }\n        };\n\n        worker.postMessage({\n          id: id,\n          message: message\n        }, transferList);\n      },\n      terminate: function terminate() {\n        worker.terminate();\n        URL.revokeObjectURL(workerURL);\n      }\n    };\n  };\n\n  var loadImage = function loadImage(url) {\n    return new Promise(function (resolve, reject) {\n      var img = new Image();\n\n      img.onload = function () {\n        resolve(img);\n      };\n\n      img.onerror = function (e) {\n        reject(e);\n      };\n\n      img.src = url;\n    });\n  };\n\n  var renameFile = function renameFile(file, name) {\n    var renamedFile = file.slice(0, file.size, file.type);\n    renamedFile.lastModifiedDate = file.lastModifiedDate;\n    renamedFile.name = name;\n    return renamedFile;\n  };\n\n  var copyFile = function copyFile(file) {\n    return renameFile(file, file.name);\n  }; // already registered plugins (can't register twice)\n\n\n  var registeredPlugins = []; // pass utils to plugin\n\n  var createAppPlugin = function createAppPlugin(plugin) {\n    // already registered\n    if (registeredPlugins.includes(plugin)) {\n      return;\n    } // remember this plugin\n\n\n    registeredPlugins.push(plugin); // setup!\n\n    var pluginOutline = plugin({\n      addFilter: addFilter,\n      utils: {\n        Type: Type,\n        forin: forin,\n        isString: isString,\n        isFile: isFile,\n        toNaturalFileSize: toNaturalFileSize,\n        replaceInString: replaceInString,\n        getExtensionFromFilename: getExtensionFromFilename,\n        getFilenameWithoutExtension: getFilenameWithoutExtension,\n        guesstimateMimeType: guesstimateMimeType,\n        getFileFromBlob: getFileFromBlob,\n        getFilenameFromURL: getFilenameFromURL,\n        createRoute: createRoute,\n        createWorker: createWorker,\n        createView: createView,\n        createItemAPI: createItemAPI,\n        loadImage: loadImage,\n        copyFile: copyFile,\n        renameFile: renameFile,\n        createBlob: createBlob,\n        applyFilterChain: applyFilterChain,\n        text: text,\n        getNumericAspectRatioFromString: getNumericAspectRatioFromString\n      },\n      views: {\n        fileActionButton: fileActionButton\n      }\n    }); // add plugin options to default options\n\n    extendDefaultOptions(pluginOutline.options);\n  }; // feature detection used by supported() method\n\n\n  var isOperaMini = function isOperaMini() {\n    return Object.prototype.toString.call(window.operamini) === '[object OperaMini]';\n  };\n\n  var hasPromises = function hasPromises() {\n    return 'Promise' in window;\n  };\n\n  var hasBlobSlice = function hasBlobSlice() {\n    return 'slice' in Blob.prototype;\n  };\n\n  var hasCreateObjectURL = function hasCreateObjectURL() {\n    return 'URL' in window && 'createObjectURL' in window.URL;\n  };\n\n  var hasVisibility = function hasVisibility() {\n    return 'visibilityState' in document;\n  };\n\n  var hasTiming = function hasTiming() {\n    return 'performance' in window;\n  }; // iOS 8.x\n\n\n  var isBrowser = function isBrowser() {\n    return typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  };\n\n  var supported = function () {\n    // Runs immidiately and then remembers result for subsequent calls\n    var isSupported = // Has to be a browser\n    isBrowser() && // Can't run on Opera Mini due to lack of everything\n    !isOperaMini() && // Require these APIs to feature detect a modern browser\n    hasVisibility() && hasPromises() && hasBlobSlice() && hasCreateObjectURL() && hasTiming();\n    return function () {\n      return isSupported;\n    };\n  }();\n  /**\n   * Plugin internal state (over all instances)\n   */\n\n\n  var state = {\n    // active app instances, used to redraw the apps and to find the later\n    apps: []\n  }; // plugin name\n\n  var name = 'filepond';\n  /**\n   * Public Plugin methods\n   */\n\n  var fn = function fn() {};\n\n  exports.Status = {};\n  exports.FileStatus = {};\n  exports.FileOrigin = {};\n  exports.OptionTypes = {};\n  exports.create = fn;\n  exports.destroy = fn;\n  exports.parse = fn;\n  exports.find = fn;\n  exports.registerPlugin = fn;\n  exports.getOptions = fn;\n  exports.setOptions = fn; // if not supported, no API\n\n  if (supported()) {\n    // start painter and fire load event\n    createPainter(function () {\n      state.apps.forEach(function (app) {\n        return app._read();\n      });\n    }, function (ts) {\n      state.apps.forEach(function (app) {\n        return app._write(ts);\n      });\n    }); // fire loaded event so we know when FilePond is available\n\n    var dispatch = function dispatch() {\n      // let others know we have area ready\n      document.dispatchEvent(new CustomEvent('FilePond:loaded', {\n        detail: {\n          supported: supported,\n          create: exports.create,\n          destroy: exports.destroy,\n          parse: exports.parse,\n          find: exports.find,\n          registerPlugin: exports.registerPlugin,\n          setOptions: exports.setOptions\n        }\n      })); // clean up event\n\n      document.removeEventListener('DOMContentLoaded', dispatch);\n    };\n\n    if (document.readyState !== 'loading') {\n      // move to back of execution queue, FilePond should have been exported by then\n      setTimeout(function () {\n        return dispatch();\n      }, 0);\n    } else {\n      document.addEventListener('DOMContentLoaded', dispatch);\n    } // updates the OptionTypes object based on the current options\n\n\n    var updateOptionTypes = function updateOptionTypes() {\n      return forin(getOptions(), function (key, value) {\n        exports.OptionTypes[key] = value[1];\n      });\n    };\n\n    exports.Status = Object.assign({}, Status);\n    exports.FileOrigin = Object.assign({}, FileOrigin);\n    exports.FileStatus = Object.assign({}, ItemStatus);\n    exports.OptionTypes = {};\n    updateOptionTypes(); // create method, creates apps and adds them to the app array\n\n    exports.create = function create() {\n      var app = createApp$1.apply(void 0, arguments);\n      app.on('destroy', exports.destroy);\n      state.apps.push(app);\n      return createAppAPI(app);\n    }; // destroys apps and removes them from the app array\n\n\n    exports.destroy = function destroy(hook) {\n      // returns true if the app was destroyed successfully\n      var indexToRemove = state.apps.findIndex(function (app) {\n        return app.isAttachedTo(hook);\n      });\n\n      if (indexToRemove >= 0) {\n        // remove from apps\n        var app = state.apps.splice(indexToRemove, 1)[0]; // restore original dom element\n\n        app.restoreElement();\n        return true;\n      }\n\n      return false;\n    }; // parses the given context for plugins (does not include the context element itself)\n\n\n    exports.parse = function parse(context) {\n      // get all possible hooks\n      var matchedHooks = Array.from(context.querySelectorAll('.' + name)); // filter out already active hooks\n\n      var newHooks = matchedHooks.filter(function (newHook) {\n        return !state.apps.find(function (app) {\n          return app.isAttachedTo(newHook);\n        });\n      }); // create new instance for each hook\n\n      return newHooks.map(function (hook) {\n        return exports.create(hook);\n      });\n    }; // returns an app based on the given element hook\n\n\n    exports.find = function find(hook) {\n      var app = state.apps.find(function (app) {\n        return app.isAttachedTo(hook);\n      });\n\n      if (!app) {\n        return null;\n      }\n\n      return createAppAPI(app);\n    }; // adds a plugin extension\n\n\n    exports.registerPlugin = function registerPlugin() {\n      for (var _len = arguments.length, plugins = new Array(_len), _key = 0; _key < _len; _key++) {\n        plugins[_key] = arguments[_key];\n      } // register plugins\n\n\n      plugins.forEach(createAppPlugin); // update OptionTypes, each plugin might have extended the default options\n\n      updateOptionTypes();\n    };\n\n    exports.getOptions = function getOptions$1() {\n      var opts = {};\n      forin(getOptions(), function (key, value) {\n        opts[key] = value[0];\n      });\n      return opts;\n    };\n\n    exports.setOptions = function setOptions$1(opts) {\n      if (isObject(opts)) {\n        // update existing plugins\n        state.apps.forEach(function (app) {\n          app.setOptions(opts);\n        }); // override defaults\n\n        setOptions(opts);\n      } // return new options\n\n\n      return exports.getOptions();\n    };\n  }\n\n  exports.supported = supported;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":{"version":3,"sources":["C:/Workspace/pycharmprojects/Bulkemails/frontend/node_modules/filepond/dist/filepond.js"],"names":["global","factory","exports","module","define","amd","self","FilePond","isNode","value","HTMLElement","createStore","initialState","queries","arguments","length","undefined","actions","state","Object","assign","actionQueue","dispatchQueue","getState","processActionQueue","queue","concat","processDispatchQueue","forEach","_ref","type","data","dispatch","isBlocking","push","actionHandlers","query","str","_queryHandles","_len","args","Array","_key","queryHandles","apply","api","action","defineProperty","obj","property","definition","forin","cb","key","hasOwnProperty","createObject","attr","node","name","getAttribute","hasAttribute","setAttribute","ns","svgElements","isSVGElement","tag","includes","createElement","className","attributes","element","document","createElementNS","appendChild","parent","child","index","children","insertBefore","appendChildView","childViews","view","splice","removeChildView","indexOf","parentNode","removeChild","getViewRect","elementRect","offset","scale","left","top","right","width","bottom","height","rect","inner","outer","filter","childView","isRectIgnored","map","childViewRect","expandRect","calculateRectSize","marginBottom","marginRight","isNumber","thereYet","position","destination","velocity","errorMargin","Math","abs","spring","_ref$stiffness","stiffness","_ref$damping","damping","_ref$mass","mass","target","resting","interpolate","f","onupdate","oncomplete","setTarget","set","get","easeLinear","t","easeInOutQuad","tween","_ref$duration","duration","_ref$easing","easing","_ref$delay","delay","start","p","reverse","ts","animator","createAnimator","category","def","props","addGetSet","keys","overwrite","isArray","o","getter","setter","isDefined","animations","mixinConfig","viewProps","viewInternalAPI","viewExternalAPI","viewState","initialProps","animation","prop","write","destroy","addEvent","fn","addEventListener","removeEvent","removeEventListener","listeners","events","add","remove","on","off","findIndex","event","apis","defaults","opacity","scaleX","scaleY","translateX","translateY","rotateX","rotateY","rotateZ","originX","originY","styles","currentProps","getOffset","getScale","getRect","propsHaveChanged","applyStyles","newProps","_ref2","perspective","transforms","elementCurrentStyle","style","cssText","Mixins","updateRect","layoutCalculated","paddingTop","parseInt","marginTop","marginLeft","offsetLeft","offsetTop","offsetWidth","offsetHeight","scrollTop","hidden","offsetParent","createView","_ref$tag","_ref$name","_ref$attributes","_ref$read","read","_ref$write","_ref$create","create","_ref$destroy","_ref$filterFrameActio","filterFrameActionsForChild","_ref$didCreateView","didCreateView","_ref$didWriteView","didWriteView","_ref$ignoreRect","ignoreRect","_ref$ignoreRectUpdate","ignoreRectUpdate","_ref$mixins","mixins","store","window","getComputedStyle","frameRect","isResting","activeMixins","ref","writers","readers","destroyers","getElement","getChildViews","getReference","createChildView","getStyle","_read","shouldUpdate","root","internalAPI","reader","_write","frameActions","shouldOptimize","writer","writerResting","timestamp","mixin","mixinResting","childResting","_destroy","destroyer","sharedAPIDefinition","internalAPIDefinition","is","needle","linkView","unlinkView","registerWriter","registerReader","registerDestroyer","invalidateLayout","externalAPIDefinition","mixinAPIDefinition","sort","a","b","mixinAPI","childCount","createPainter","fps","painter","interval","last","id","requestTick","cancelTick","setTimerType","setTimeout","tick","performance","now","clearTimeout","requestAnimationFrame","cancelAnimationFrame","delta","pause","createRoute","routes","_ref$actions","newNode","referenceNode","insertAfter","nextSibling","isEmpty","trim","toString","toArray","splitter","split","isBoolean","toBoolean","isString","toNumber","replace","toInt","toFloat","parseFloat","isInt","isFinite","floor","toBytes","naturalFileSize","test","isFunction","toFunctionReference","string","levels","level","shift","methods","process","patch","revert","fetch","restore","load","createServerAPI","outline","url","timeout","headers","createAction","method","withCredentials","onload","ondata","onerror","parts","header","toServerAPI","isNull","isObject","isAPI","getType","replaceSingleQuotes","conversionTable","array","boolean","int","number","float","bytes","function","_function","serverapi","object","JSON","parse","e","convertTo","getValueByType","newValue","defaultValue","valueType","newValueType","convertedValue","option","createOption","currentValue","enumerable","createOptions","options","optionDefinition","createInitialState","items","listUpdateTimeout","itemUpdateTimeout","processingQueue","fromCamels","separator","part","toLowerCase","join","createOptionAPI","toUpperCase","createOptionActions","createOptionQueries","InteractionMethod","API","DROP","BROWSE","PASTE","NONE","getUniqueId","random","substr","arrayRemove","arr","listener","fire","onOnce","_cb","copyObjectPropertiesToObject","src","excluded","getOwnPropertyNames","getOwnPropertyDescriptor","PRIVATE","createItemAPI","item","removeReleasedItems","released","ItemStatus","INIT","IDLE","PROCESSING_QUEUED","PROCESSING","PROCESSING_COMPLETE","PROCESSING_ERROR","PROCESSING_REVERT_ERROR","LOADING","LOAD_ERROR","FileOrigin","INPUT","LIMBO","LOCAL","getNonNumeric","exec","getDecimalSeparator","toLocaleString","getThousandsSeparator","decimalSeparator","thousandsStringWithSeparator","thousandsStringWithoutSeparator","Type","BOOLEAN","INT","NUMBER","STRING","ARRAY","OBJECT","FUNCTION","ACTION","SERVER_API","REGEX","filters","applyFilterChain","utils","Promise","resolve","reject","matchingFilters","initialFilter","reduce","current","next","then","catch","error","applyFilters","addFilter","extendDefaultOptions","additionalOptions","defaultOptions","getOptions","setOptions","opts","disabled","required","captureMethod","allowDrop","allowBrowse","allowPaste","allowMultiple","allowReplace","allowRevert","forceRevert","maxFiles","checkValidity","itemInsertLocationFreedom","itemInsertLocation","itemInsertInterval","dropOnPage","dropOnElement","dropValidation","ignoredFiles","instantUpload","maxParallelUploads","chunkUploads","chunkForce","chunkSize","chunkRetryDelays","server","labelDecimalSeparator","labelThousandsSeparator","labelIdle","labelInvalidField","labelFileWaitingForSize","labelFileSizeNotAvailable","labelFileCountSingular","labelFileCountPlural","labelFileLoading","labelFileAdded","labelFileLoadError","labelFileRemoved","labelFileRemoveError","labelFileProcessing","labelFileProcessingComplete","labelFileProcessingAborted","labelFileProcessingError","labelFileProcessingRevertError","labelTapToCancel","labelTapToRetry","labelTapToUndo","labelButtonRemoveItem","labelButtonAbortItemLoad","labelButtonRetryItemLoad","labelButtonAbortItemProcessing","labelButtonUndoItemProcessing","labelButtonRetryItemProcessing","labelButtonProcessItem","iconRemove","iconProcess","iconRetry","iconUndo","iconDone","oninit","onwarning","onactivatefile","onaddfilestart","onaddfileprogress","onaddfile","onprocessfilestart","onprocessfileprogress","onprocessfileabort","onprocessfilerevert","onprocessfile","onprocessfiles","onremovefile","onpreparefile","onupdatefiles","beforeDropFile","beforeAddFile","beforeRemoveFile","stylePanelLayout","stylePanelAspectRatio","styleItemPanelAspectRatio","styleButtonRemoveItemPosition","styleButtonProcessItemPosition","styleLoadIndicatorPosition","styleProgressIndicatorPosition","files","getItemByQuery","find","getNumericAspectRatioFromString","aspectRatio","getActiveItems","archived","Status","EMPTY","ERROR","BUSY","READY","ITEM_ERROR","ITEM_BUSY","ITEM_READY","isItemInErrorState","status","isItemInBusyState","isItemInReadyState","GET_STATUS","some","GET_ITEM","GET_ACTIVE_ITEM","GET_ACTIVE_ITEMS","GET_ITEMS","GET_ITEM_NAME","filename","GET_ITEM_SIZE","fileSize","GET_STYLES","GET_PANEL_ASPECT_RATIO","isShapeCircle","GET_ITEM_PANEL_ASPECT_RATIO","GET_ITEMS_BY_STATUS","GET_TOTAL_ITEMS","IS_ASYNC","hasRoomForItem","count","maxFileCount","limit","min","max","arrayInsert","insertItem","isBase64DataURI","getFilenameFromURL","pop","getExtensionFromFilename","guesstimateExtension","subtype","leftPad","padding","slice","getDateString","date","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getFileFromBlob","blob","extension","file","size","lastModifiedDate","getBlobBuilder","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","createBlob","arrayBuffer","mimeType","BB","bb","append","getBlob","Blob","getBlobFromByteStringWithMimeType","byteString","ab","ArrayBuffer","ia","Uint8Array","i","charCodeAt","getMimeTypeFromBase64DataURI","dataURI","getBase64DataFromBase64DataURI","getByteStringFromBase64DataURI","atob","getBlobFromBase64DataURI","getFileFromBase64DataURI","getFileNameFromHeader","matches","decodeURI","getFileSizeFromHeader","match","getTranfserIdFromHeader","getFileInfoFromHeaders","info","source","rows","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","Symbol","iterator","_step","done","err","return","createFileLoader","fetchFn","complete","progress","request","getProgress","abort","File","loadURL","body","code","response","computable","total","fileinfo","setSource","isGet","sendRequest","onheaders","onprogress","ontimeout","onabort","aborted","xhr","headersReceived","encodeURI","encodeURIComponent","stringify","XMLHttpRequest","upload","lengthComputable","loaded","onreadystatechange","readyState","open","unescape","setRequestHeader","responseType","send","createResponse","createTimeoutResponse","getAllResponseHeaders","createFetchFunction","apiUrl","res","statusText","_typeof","constructor","prototype","REACT_ELEMENT_TYPE","_jsx","defaultProps","childrenLength","propName","childArray","$$typeof","_owner","_asyncIterator","iterable","asyncIterator","call","TypeError","_AwaitValue","wrapped","_AsyncGenerator","gen","front","back","arg","resume","result","wrappedAwait","settle","_invoke","throw","_wrapAsyncGenerator","_awaitAsyncGenerator","_asyncGeneratorDelegate","awaitWrap","iter","waiting","pump","asyncGeneratorStep","_next","_throw","_asyncToGenerator","_classCallCheck","instance","Constructor","_defineProperties","descriptor","configurable","writable","_createClass","protoProps","staticProps","_defineEnumerableProperties","descs","desc","getOwnPropertySymbols","objectSymbols","sym","_defaults","_defineProperty","_extends","_objectSpread","ownKeys","enumerableOnly","symbols","_objectSpread2","getOwnPropertyDescriptors","defineProperties","_inherits","subClass","superClass","_setPrototypeOf","_inheritsLoose","__proto__","_getPrototypeOf","setPrototypeOf","getPrototypeOf","isNativeReflectConstruct","Reflect","construct","sham","Proxy","_construct","Parent","Class","Function","bind","_isNativeFunction","_wrapNativeSuper","_cache","Map","has","Wrapper","_instanceof","hasInstance","_interopRequireDefault","__esModule","default","_interopRequireWildcard","newObj","_newArrowCheck","innerThis","boundThis","_objectDestructuringEmpty","_objectWithoutPropertiesLoose","sourceKeys","_objectWithoutProperties","sourceSymbolKeys","propertyIsEnumerable","_assertThisInitialized","ReferenceError","_possibleConstructorReturn","_superPropBase","_get","receiver","base","_set","isStrict","s","Error","_taggedTemplateLiteral","strings","raw","freeze","_taggedTemplateLiteralLoose","_temporalRef","val","_temporalUndefined","_readOnlyError","_classNameTDZError","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","_slicedToArrayLoose","_iterableToArrayLimitLoose","_toArray","_iterableToArray","_toConsumableArray","_arrayWithoutHoles","_nonIterableSpread","arr2","from","_arr","_n","_d","_e","_i","_s","_skipFirstGeneratorNext","it","_toPrimitive","input","hint","prim","toPrimitive","String","Number","_toPropertyKey","_initializerWarningHelper","context","_initializerDefineProperty","initializer","_applyDecoratedDescriptor","decorators","decorator","_classPrivateFieldLooseKey","_classPrivateFieldLooseBase","privateKey","_classPrivateFieldGet","privateMap","_classPrivateFieldSet","_classPrivateFieldDestructureSet","__destrObj","v","_classStaticPrivateFieldSpecGet","classConstructor","_classStaticPrivateFieldSpecSet","_classStaticPrivateMethodGet","_classStaticPrivateMethodSet","_decorate","_getDecoratorsApi","r","initialize","O","initializeInstanceElements","decorated","elements","decorateClass","_coalesceClassElements","d","_createElementDescriptor","initializeClassElements","F","runClassFinishers","finishers","elementsDefinitionOrder","kind","placement","defineClassElement","proto","newElements","placements","static","own","addElementPlacement","_hasDecorators","elementFinishersExtras","decorateElement","extras","decorateConstructor","silent","elementObject","fromElementDescriptor","elementFinisherExtras","toElementFinisherExtras","finisher","newExtras","j","fromClassDescriptor","elementsAndFinisher","toClassDescriptor","k","toStringTag","toElementDescriptors","elementObjects","toElementDescriptor","disallowProperty","_optionalCallableProperty","newConstructor","objectType","_coalesceGetterSetter","other","isSameElement","_isDataDescriptor","_classPrivateMethodGet","privateSet","_classPrivateMethodSet","_wrapRegExp","re","groups","BabelRegExp","_RegExp","RegExp","_super","_groups","WeakMap","_this","buildGroups","substitution","_","g","ChunkStatus","QUEUED","COMPLETE","WAITING","processFileChunked","metadata","transfer","chunks","chunkTransferId","chunkServer","serverId","fd","getResponseHeader","requestTransferId","formData","FormData","requestParams","requestTransferOffset","requestUrl","lastChunkIndex","retries","completeProcessingChunks","canProcessChunk","chunk","processChunk","every","processChunks","updateTotalProgress","retryProcessChunk","totalBytesTransfered","totalSize","totalProcessing","abortChunks","createFileProcessorFunction","canChunkUpload","shouldChunkUpload","willChunkUpload","createProcessorFunction","params","createRevertFunction","uniqueFileId","getRandomNumber","createPerceivedPerformanceUpdater","tickMin","tickMax","runtime","clear","createFileProcessor","processFn","perceivedProgress","perceivedPerformanceUpdater","perceivedDuration","progressFn","completeFn","transferId","reset","getDuration","getFilenameWithoutExtension","lastIndexOf","createFileStub","isFile","deepCloneObject","createItem","origin","serverFileReference","frozen","processingAborted","activeLoader","activeProcessor","abortProcessingRequestComplete","setStatus","getFileExtension","getFileType","getFileSize","getFile","loader","meta","success","retryLoad","abortLoad","processor","onprocess","console","requestProcessing","abortProcessing","revertFileUpload","_setMetadata","setMetadata","getMetadata","filenameWithoutExtension","fileExtension","fileType","extend","handler","itemAPI","release","archive","getItemIndexByQuery","getItemById","itemId","fetchLocal","getDomainFromURL","location","protocol","isExternalURL","href","dynamicLabel","label","isMockItem","listUpdated","optionalPromise","sortItems","compare","getItemByQueryFromState","itemHandler","_ref$success","_ref$failure","failure","ABORT_ALL","DID_SET_FILES","_ref2$value","activeItems","interactionMethod","DID_UPDATE_ITEM_METADATA","_ref3","shouldPrepareOutput","ready","doUpload","SORT","_ref4","ADD_ITEMS","_ref5","_ref5$success","_ref5$failure","currentIndex","insertLocation","totalItems","isValidFile","validItems","promises","all","ADD_ITEM","_ref6","_ref6$index","_ref6$success","_ref6$failure","_ref6$options","_item","mainStatus","main","sub","handleAdd","shouldAdd","change","loadComplete","_ref7","REQUEST_PREPARE_OUTPUT","_ref8","COMPLETE_LOAD_ITEM","_ref9","RETRY_ITEM_LOAD","REQUEST_ITEM_PROCESSING","itemCanBeQueuedForProcessing","PROCESS_ITEM","totalCurrentUploads","processNext","queueEntry","itemReference","allItemsProcessed","RETRY_ITEM_PROCESSING","REQUEST_REMOVE_ITEM","shouldRemove","RELEASE_ITEM","REMOVE_ITEM","removeFromView","ABORT_ITEM_LOAD","ABORT_ITEM_PROCESSING","REQUEST_REVERT_ITEM_PROCESSING","handleRevert","shouldRevert","requestRemoveResult","REVERT_ITEM_PROCESSING","SET_OPTIONS","_ref10","formatFilename","createElement$1","tagName","text","textNode","childNodes","createTextNode","nodeValue","polarToCartesian","centerX","centerY","radius","angleInDegrees","angleInRadians","PI","x","cos","y","sin","describeArc","startAngle","endAngle","arcSweep","end","percentageArc","to","spin","svg","path","align","dataset","ringStrokeWidth","ringFrom","ringTo","coordinates","progressIndicator","create$1","innerHTML","icon","isDisabled","write$1","shouldDisable","removeAttribute","fileActionButton","toNaturalFileSize","round","MB","KB","GB","removeDecimalsWhenZero","decimalCount","toFixed","create$2","fileName","updateFile","updateFileSizeOnError","fileInfo","DID_LOAD_ITEM","DID_UPDATE_ITEM_META","DID_THROW_ITEM_LOAD_ERROR","DID_THROW_ITEM_INVALID","toPercentage","create$3","didSetItemLoadProgress","title","didSetItemProcessProgress","didRequestItemProcessing","didAbortItemProcessing","didCompleteItemProcessing","fileStatus","DID_REVERT_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_ABORT_ITEM_PROCESSING","DID_COMPLETE_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_UPDATE_ITEM_LOAD_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR","DID_THROW_ITEM_PROCESSING_REVERT_ERROR","DID_THROW_ITEM_REMOVE_ERROR","Buttons","AbortItemLoad","RetryItemLoad","RemoveItem","ProcessItem","AbortItemProcessing","RetryItemProcessing","RevertItemProcessing","ButtonKeys","calculateFileInfoOffset","buttonRect","buttonRemoveItem","calculateFileVerticalCenterOffset","calculateFileHorizontalCenterOffset","getLoadIndicatorAlignment","getProcessIndicatorAlignment","getRemoveIndicatorAligment","DefaultStyle","buttonAbortItemLoad","buttonRetryItemLoad","buttonProcessItem","buttonAbortItemProcessing","buttonRetryItemProcessing","buttonRevertItemProcessing","loadProgressIndicator","processProgressIndicator","processingCompleteIndicator","IdleStyle","ProcessingStyle","StyleMap","DID_START_ITEM_LOAD","DID_START_ITEM_REMOVE","DID_LOAD_LOCAL_ITEM","DID_START_ITEM_PROCESSING","processingCompleteIndicatorView","create$4","isAsync","enabledButtons","buttonView","classList","stopPropagation","loadIndicatorView","progressIndicatorView","activeStyles","write$2","route","stylesToApply","defaultStyles","control","DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING","DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD","DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL","buttonAbortItemRemoval","_ref11","_ref12","create$5","dataContainer","didSetDisabled","didLoadItem","didRemoveItem","didCompleteItemProcessing$1","didRevertItemProcessing","fileWrapper","DID_SET_DISABLED","DID_REMOVE_ITEM","PANEL_SPRING_PROPS","create$6","section","createSection","scalable","viewConstructor","write$3","topRect","bottomRect","center","panel","ITEM_TRANSLATE_SPRING","ITEM_SCALE_SPRING","create$7","handleClick","container","markedForRemoval","StateMap","route$1","DID_UPDATE_PANEL_HEIGHT","write$4","currentState","filepondItemState","getItemIndexByPosition","positionInView","horizontalSpace","l","itemRect","itemHorizontalMargin","itemWidth","itemsPerRow","childMid","itemVerticalMargin","itemHeight","_index","indexX","indexY","offsetX","offsetY","itemTop","itemRight","itemBottom","create$8","lastItemSpanwDate","addItemView","addIndex","spawnDate","cooldown","dist","moveItem","vx","vy","introItemView","removeItemView","route$2","DID_ADD_ITEM","write$5","dragCoordinates","dragIndex","visibleChildren","dragIndexOffset","removeIndexOffset","addIndexOffset","childRect","dragOffset","visualHeight","prevX","prevY","visualIndex","vectorX","sign","vectorY","filterSetItemActions","list","create$9","overflowing","storeDragCoordinates","scopeLeft","scopeTop","clearDragCoordinates","route$3","DID_DRAG","DID_END_DRAG","write$6","overflow","newHeight","listScroller","attrToggle","enabledValue","resetFileInput","form","create$a","handleChange","setAcceptedFileTypes","toggleAllowMultiple","toggleDisabled","doesAllowBrowse","disableField","toggleRequired","setCaptureMethod","updateRequiredStatus","shouldCheckValidity","setCustomValidity","updateFieldValidityStatus","browser","DID_SET_ALLOW_BROWSE","DID_SET_ALLOW_MULTIPLE","DID_SET_ACCEPTED_FILE_TYPES","DID_SET_CAPTURE_METHOD","DID_SET_REQUIRED","Key","ENTER","SPACE","create$b","handleKeyDown","isActivationKey","keyCode","preventDefault","click","isLabelClick","contains","updateLabelValue","caption","clickable","querySelector","dropLabel","DID_SET_LABEL_IDLE","addBlob","moveBlob","hideBlob","explodeBlob","write$7","route$4","DID_DROP","drip","getRootNode","images","text$1","zip","epub","guesstimateMimeType","requestDataTransferItems","dataTransfer","links","getLinks","hasFiles","getFiles","promisedFiles","isFileSystemItem","getFilesFromItem","returnedFileGroups","group","isEntry","entry","getAsEntry","isDirectory","isDirectoryEntry","getFilesInDirectory","getAsFile","dirCounter","fileCounter","resolveIfDone","readEntries","dirEntry","directoryReader","createReader","readBatch","entries","correctMissingFileType","webkitGetAsEntry","getLinksFromTransferMetaData","getLinksFromTransferURLData","getData","dragNDropObservers","eventPosition","pageLeft","pageX","pageTop","pageY","layerX","layerY","createDragNDropClient","scopeToObserve","filterElement","observer","getDragNDropObserver","client","ondrop","onenter","ondrag","onexit","allowdrop","addListener","newObserver","createDragNDropObserver","clients","dragenter","dragover","dragleave","drop","handlers","createHandler","elementFromPoint","point","isEventTarget","elementAtPosition","pageXOffset","pageYOffset","initialTarget","setDropEffect","effect","dropEffect","overDropTarget","allowsTransfer","createHopper","scope","validateItems","catchesDropsOnPage","requiresDropOnElement","_options$filterItems","filterItems","documentElement","lastState","filteredItems","ondragend","ondragstart","updateHopperState","hopperState","listening","listeners$1","handlePaste","clipboardData","listen","unlisten","createPaster","create$c","addFilesNotificationTimeout","notificationClearTimeout","filenames","assist","message","textContent","clear$1","listModified","isUsingFilePond","activeElement","itemAdded","itemRemoved","itemProcessed","itemProcessedUndo","itemError","assistant","toCamels","charAt","debounce","func","immidiateOnly","MAX_FILES_LIMIT","create$d","measure","bounds","widthPrevious","widthUpdated","updateHistory","previousAspectRatio","write$8","route$5","calculateRootBoundingBoxHeight","_root$ref","hopper","isMultiItem","maxItems","atMaxCapacity","addAction","listItemMargin","calculateListItemMargin","listHeight","calculateListHeight","labelHeight","currentLabelHeight","listMarginTop","listMarginBottom","visual","boundsHeight","history","MAX_BOUNCES","bounces","listAvailableHeight","fixedHeight","_listAvailableHeight","cappedHeight","isCappedHeight","panelHeight","_listAvailableHeight2","itemMargin","scrollList","itemList","newItem","removedItem","verticalItemCount","ceil","measureHeight","maxHeight","exceedsMaxFiles","totalBrowseItems","hasMaxItems","getDragIndex","toggleDrop","isAllowed","enabled","toggleBrowse","togglePaste","paster","DID_SET_ALLOW_DROP","DID_SET_ALLOW_PASTE","createApp","initialOptions","originalElement","visibilityHandler","resizeDoneTimer","isResizing","isResizingHorizontally","initialWindowWidth","currentWindowWidth","resizeHandler","isHidden","readWriteApi","innerWidth","routeActionsToEvents","createEvent","output","eventRoutes","DID_DESTROY","DID_INIT","DID_THROW_MAX_FILES","DID_PREPARE_OUTPUT","DID_COMPLETE_ITEM_PROCESSING_ALL","DID_UPDATE_ITEMS","DID_ACTIVATE_ITEM","exposeEvent","detail","pond","dispatchEvent","CustomEvent","bubbles","cancelable","composed","filtered","addFile","addFiles","removeFile","sources","lastArgument","processFile","processFiles","_len2","_key2","removeFiles","_len3","_key3","mappedQueries","browse","insertBefore$1","insertAfter$1","appendTo","replaceElement","restoreElement","isAttachedTo","createAppObject","customOptions","app","lowerCaseFirstLetter","attributeNameToPropertyName","attributeName","mapObject","propertyMap","selector","mapping","selectorRegExp","getAttributesAsObject","attributeMapping","attribute","createAppAtElement","mergedOptions","attributeOptions","nodeName","querySelectorAll","createApp$1","PRIVATE_METHODS","createAppAPI","replaceInString","replacements","createWorker","workerBlob","workerURL","URL","createObjectURL","worker","Worker","post","transferList","onmessage","postMessage","terminate","revokeObjectURL","loadImage","img","Image","renameFile","renamedFile","copyFile","registeredPlugins","createAppPlugin","plugin","pluginOutline","views","isOperaMini","operamini","hasPromises","hasBlobSlice","hasCreateObjectURL","hasVisibility","hasTiming","isBrowser","supported","isSupported","apps","FileStatus","OptionTypes","registerPlugin","updateOptionTypes","hook","indexToRemove","matchedHooks","newHooks","newHook","plugins","getOptions$1","setOptions$1"],"mappings":"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","sourcesContent":["/*!\n * FilePond 4.7.4\n * Licensed under MIT, https://opensource.org/licenses/MIT/\n * Please visit https://pqina.nl/filepond/ for details.\n */\n\n/* eslint-disable */\n\n(function(global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined'\n    ? factory(exports)\n    : typeof define === 'function' && define.amd\n    ? define(['exports'], factory)\n    : ((global = global || self), factory((global.FilePond = {})));\n})(this, function(exports) {\n  'use strict';\n\n  var isNode = function isNode(value) {\n    return value instanceof HTMLElement;\n  };\n\n  var createStore = function createStore(initialState) {\n    var queries =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var actions =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    // internal state\n    var state = Object.assign({}, initialState);\n\n    // contains all actions for next frame, is clear when actions are requested\n    var actionQueue = [];\n    var dispatchQueue = [];\n\n    // returns a duplicate of the current state\n    var getState = function getState() {\n      return Object.assign({}, state);\n    };\n\n    // returns a duplicate of the actions array and clears the actions array\n    var processActionQueue = function processActionQueue() {\n      // create copy of actions queue\n      var queue = [].concat(actionQueue);\n\n      // clear actions queue (we don't want no double actions)\n      actionQueue.length = 0;\n\n      return queue;\n    };\n\n    // processes actions that might block the main UI thread\n    var processDispatchQueue = function processDispatchQueue() {\n      // create copy of actions queue\n      var queue = [].concat(dispatchQueue);\n\n      // clear actions queue (we don't want no double actions)\n      dispatchQueue.length = 0;\n\n      // now dispatch these actions\n      queue.forEach(function(_ref) {\n        var type = _ref.type,\n          data = _ref.data;\n        dispatch(type, data);\n      });\n    };\n\n    // adds a new action, calls its handler and\n    var dispatch = function dispatch(type, data, isBlocking) {\n      // is blocking action\n      if (isBlocking) {\n        dispatchQueue.push({\n          type: type,\n          data: data\n        });\n\n        return;\n      }\n\n      // if this action has a handler, handle the action\n      if (actionHandlers[type]) {\n        actionHandlers[type](data);\n      }\n\n      // now add action\n      actionQueue.push({\n        type: type,\n        data: data\n      });\n    };\n\n    var query = function query(str) {\n      var _queryHandles;\n      for (\n        var _len = arguments.length,\n          args = new Array(_len > 1 ? _len - 1 : 0),\n          _key = 1;\n        _key < _len;\n        _key++\n      ) {\n        args[_key - 1] = arguments[_key];\n      }\n      return queryHandles[str]\n        ? (_queryHandles = queryHandles)[str].apply(_queryHandles, args)\n        : null;\n    };\n\n    var api = {\n      getState: getState,\n      processActionQueue: processActionQueue,\n      processDispatchQueue: processDispatchQueue,\n      dispatch: dispatch,\n      query: query\n    };\n\n    var queryHandles = {};\n    queries.forEach(function(query) {\n      queryHandles = Object.assign({}, query(state), {}, queryHandles);\n    });\n\n    var actionHandlers = {};\n    actions.forEach(function(action) {\n      actionHandlers = Object.assign(\n        {},\n        action(dispatch, query, state),\n        {},\n        actionHandlers\n      );\n    });\n\n    return api;\n  };\n\n  var defineProperty = function defineProperty(obj, property, definition) {\n    if (typeof definition === 'function') {\n      obj[property] = definition;\n      return;\n    }\n    Object.defineProperty(obj, property, Object.assign({}, definition));\n  };\n\n  var forin = function forin(obj, cb) {\n    for (var key in obj) {\n      if (!obj.hasOwnProperty(key)) {\n        continue;\n      }\n\n      cb(key, obj[key]);\n    }\n  };\n\n  var createObject = function createObject(definition) {\n    var obj = {};\n    forin(definition, function(property) {\n      defineProperty(obj, property, definition[property]);\n    });\n    return obj;\n  };\n\n  var attr = function attr(node, name) {\n    var value =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    if (value === null) {\n      return node.getAttribute(name) || node.hasAttribute(name);\n    }\n    node.setAttribute(name, value);\n  };\n\n  var ns = 'http://www.w3.org/2000/svg';\n  var svgElements = ['svg', 'path']; // only svg elements used\n\n  var isSVGElement = function isSVGElement(tag) {\n    return svgElements.includes(tag);\n  };\n\n  var createElement = function createElement(tag, className) {\n    var attributes =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    if (typeof className === 'object') {\n      attributes = className;\n      className = null;\n    }\n    var element = isSVGElement(tag)\n      ? document.createElementNS(ns, tag)\n      : document.createElement(tag);\n    if (className) {\n      if (isSVGElement(tag)) {\n        attr(element, 'class', className);\n      } else {\n        element.className = className;\n      }\n    }\n    forin(attributes, function(name, value) {\n      attr(element, name, value);\n    });\n    return element;\n  };\n\n  var appendChild = function appendChild(parent) {\n    return function(child, index) {\n      if (typeof index !== 'undefined' && parent.children[index]) {\n        parent.insertBefore(child, parent.children[index]);\n      } else {\n        parent.appendChild(child);\n      }\n    };\n  };\n\n  var appendChildView = function appendChildView(parent, childViews) {\n    return function(view, index) {\n      if (typeof index !== 'undefined') {\n        childViews.splice(index, 0, view);\n      } else {\n        childViews.push(view);\n      }\n\n      return view;\n    };\n  };\n\n  var removeChildView = function removeChildView(parent, childViews) {\n    return function(view) {\n      // remove from child views\n      childViews.splice(childViews.indexOf(view), 1);\n\n      // remove the element\n      if (view.element.parentNode) {\n        parent.removeChild(view.element);\n      }\n\n      return view;\n    };\n  };\n\n  var getViewRect = function getViewRect(\n    elementRect,\n    childViews,\n    offset,\n    scale\n  ) {\n    var left = offset[0] || elementRect.left;\n    var top = offset[1] || elementRect.top;\n    var right = left + elementRect.width;\n    var bottom = top + elementRect.height * (scale[1] || 1);\n\n    var rect = {\n      // the rectangle of the element itself\n      element: Object.assign({}, elementRect),\n\n      // the rectangle of the element expanded to contain its children, does not include any margins\n      inner: {\n        left: elementRect.left,\n        top: elementRect.top,\n        right: elementRect.right,\n        bottom: elementRect.bottom\n      },\n\n      // the rectangle of the element expanded to contain its children including own margin and child margins\n      // margins will be added after we've recalculated the size\n      outer: {\n        left: left,\n        top: top,\n        right: right,\n        bottom: bottom\n      }\n    };\n\n    // expand rect to fit all child rectangles\n    childViews\n      .filter(function(childView) {\n        return !childView.isRectIgnored();\n      })\n      .map(function(childView) {\n        return childView.rect;\n      })\n      .forEach(function(childViewRect) {\n        expandRect(rect.inner, Object.assign({}, childViewRect.inner));\n        expandRect(rect.outer, Object.assign({}, childViewRect.outer));\n      });\n\n    // calculate inner width and height\n    calculateRectSize(rect.inner);\n\n    // append additional margin (top and left margins are included in top and left automatically)\n    rect.outer.bottom += rect.element.marginBottom;\n    rect.outer.right += rect.element.marginRight;\n\n    // calculate outer width and height\n    calculateRectSize(rect.outer);\n\n    return rect;\n  };\n\n  var expandRect = function expandRect(parent, child) {\n    // adjust for parent offset\n    child.top += parent.top;\n    child.right += parent.left;\n    child.bottom += parent.top;\n    child.left += parent.left;\n\n    if (child.bottom > parent.bottom) {\n      parent.bottom = child.bottom;\n    }\n\n    if (child.right > parent.right) {\n      parent.right = child.right;\n    }\n  };\n\n  var calculateRectSize = function calculateRectSize(rect) {\n    rect.width = rect.right - rect.left;\n    rect.height = rect.bottom - rect.top;\n  };\n\n  var isNumber = function isNumber(value) {\n    return typeof value === 'number';\n  };\n\n  /**\n   * Determines if position is at destination\n   * @param position\n   * @param destination\n   * @param velocity\n   * @param errorMargin\n   * @returns {boolean}\n   */\n  var thereYet = function thereYet(position, destination, velocity) {\n    var errorMargin =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0.001;\n    return (\n      Math.abs(position - destination) < errorMargin &&\n      Math.abs(velocity) < errorMargin\n    );\n  };\n\n  /**\n   * Spring animation\n   */\n  var spring =\n    // default options\n    function spring() // method definition\n    {\n      var _ref =\n          arguments.length > 0 && arguments[0] !== undefined\n            ? arguments[0]\n            : {},\n        _ref$stiffness = _ref.stiffness,\n        stiffness = _ref$stiffness === void 0 ? 0.5 : _ref$stiffness,\n        _ref$damping = _ref.damping,\n        damping = _ref$damping === void 0 ? 0.75 : _ref$damping,\n        _ref$mass = _ref.mass,\n        mass = _ref$mass === void 0 ? 10 : _ref$mass;\n      var target = null;\n      var position = null;\n      var velocity = 0;\n      var resting = false;\n\n      // updates spring state\n      var interpolate = function interpolate() {\n        // in rest, don't animate\n        if (resting) {\n          return;\n        }\n\n        // need at least a target or position to do springy things\n        if (!(isNumber(target) && isNumber(position))) {\n          resting = true;\n          velocity = 0;\n          return;\n        }\n\n        // calculate spring force\n        var f = -(position - target) * stiffness;\n\n        // update velocity by adding force based on mass\n        velocity += f / mass;\n\n        // update position by adding velocity\n        position += velocity;\n\n        // slow down based on amount of damping\n        velocity *= damping;\n\n        // we've arrived if we're near target and our velocity is near zero\n        if (thereYet(position, target, velocity)) {\n          position = target;\n          velocity = 0;\n          resting = true;\n\n          // we done\n          api.onupdate(position);\n          api.oncomplete(position);\n        } else {\n          // progress update\n          api.onupdate(position);\n        }\n      };\n\n      /**\n       * Set new target value\n       * @param value\n       */\n      var setTarget = function setTarget(value) {\n        // if currently has no position, set target and position to this value\n        if (isNumber(value) && !isNumber(position)) {\n          position = value;\n        }\n\n        // next target value will not be animated to\n        if (target === null) {\n          target = value;\n          position = value;\n        }\n\n        // let start moving to target\n        target = value;\n\n        // already at target\n        if (position === target || typeof target === 'undefined') {\n          // now resting as target is current position, stop moving\n          resting = true;\n          velocity = 0;\n\n          // done!\n          api.onupdate(position);\n          api.oncomplete(position);\n\n          return;\n        }\n\n        resting = false;\n      };\n\n      // need 'api' to call onupdate callback\n      var api = createObject({\n        interpolate: interpolate,\n        target: {\n          set: setTarget,\n          get: function get() {\n            return target;\n          }\n        },\n\n        resting: {\n          get: function get() {\n            return resting;\n          }\n        },\n\n        onupdate: function onupdate(value) {},\n        oncomplete: function oncomplete(value) {}\n      });\n\n      return api;\n    };\n\n  var easeLinear = function easeLinear(t) {\n    return t;\n  };\n  var easeInOutQuad = function easeInOutQuad(t) {\n    return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n  };\n\n  var tween =\n    // default values\n    function tween() // method definition\n    {\n      var _ref =\n          arguments.length > 0 && arguments[0] !== undefined\n            ? arguments[0]\n            : {},\n        _ref$duration = _ref.duration,\n        duration = _ref$duration === void 0 ? 500 : _ref$duration,\n        _ref$easing = _ref.easing,\n        easing = _ref$easing === void 0 ? easeInOutQuad : _ref$easing,\n        _ref$delay = _ref.delay,\n        delay = _ref$delay === void 0 ? 0 : _ref$delay;\n      var start = null;\n      var t;\n      var p;\n      var resting = true;\n      var reverse = false;\n      var target = null;\n\n      var interpolate = function interpolate(ts) {\n        if (resting || target === null) {\n          return;\n        }\n\n        if (start === null) {\n          start = ts;\n        }\n\n        if (ts - start < delay) {\n          return;\n        }\n\n        t = ts - start - delay;\n\n        if (t < duration) {\n          p = t / duration;\n          api.onupdate((t >= 0 ? easing(reverse ? 1 - p : p) : 0) * target);\n        } else {\n          t = 1;\n          p = reverse ? 0 : 1;\n          api.onupdate(p * target);\n          api.oncomplete(p * target);\n          resting = true;\n        }\n      };\n\n      // need 'api' to call onupdate callback\n      var api = createObject({\n        interpolate: interpolate,\n        target: {\n          get: function get() {\n            return reverse ? 0 : target;\n          },\n          set: function set(value) {\n            // is initial value\n            if (target === null) {\n              target = value;\n              api.onupdate(value);\n              api.oncomplete(value);\n              return;\n            }\n\n            // want to tween to a smaller value and have a current value\n            if (value < target) {\n              target = 1;\n              reverse = true;\n            } else {\n              // not tweening to a smaller value\n              reverse = false;\n              target = value;\n            }\n\n            // let's go!\n            resting = false;\n            start = null;\n          }\n        },\n\n        resting: {\n          get: function get() {\n            return resting;\n          }\n        },\n\n        onupdate: function onupdate(value) {},\n        oncomplete: function oncomplete(value) {}\n      });\n\n      return api;\n    };\n\n  var animator = {\n    spring: spring,\n    tween: tween\n  };\n\n  /*\n                       { type: 'spring', stiffness: .5, damping: .75, mass: 10 };\n                       { translation: { type: 'spring', ... }, ... }\n                       { translation: { x: { type: 'spring', ... } } }\n                      */\n  var createAnimator = function createAnimator(definition, category, property) {\n    // default is single definition\n    // we check if transform is set, if so, we check if property is set\n    var def =\n      definition[category] && typeof definition[category][property] === 'object'\n        ? definition[category][property]\n        : definition[category] || definition;\n\n    var type = typeof def === 'string' ? def : def.type;\n    var props = typeof def === 'object' ? Object.assign({}, def) : {};\n\n    return animator[type] ? animator[type](props) : null;\n  };\n\n  var addGetSet = function addGetSet(keys, obj, props) {\n    var overwrite =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    obj = Array.isArray(obj) ? obj : [obj];\n    obj.forEach(function(o) {\n      keys.forEach(function(key) {\n        var name = key;\n        var getter = function getter() {\n          return props[key];\n        };\n        var setter = function setter(value) {\n          return (props[key] = value);\n        };\n\n        if (typeof key === 'object') {\n          name = key.key;\n          getter = key.getter || getter;\n          setter = key.setter || setter;\n        }\n\n        if (o[name] && !overwrite) {\n          return;\n        }\n\n        o[name] = {\n          get: getter,\n          set: setter\n        };\n      });\n    });\n  };\n\n  var isDefined = function isDefined(value) {\n    return value != null;\n  };\n\n  // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // setup animators\n\n  var animations = function animations(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI,\n      viewState = _ref.viewState;\n    // initial properties\n    var initialProps = Object.assign({}, viewProps);\n\n    // list of all active animations\n    var animations = [];\n\n    // setup animators\n    forin(mixinConfig, function(property, animation) {\n      var animator = createAnimator(animation);\n      if (!animator) {\n        return;\n      }\n\n      // when the animator updates, update the view state value\n      animator.onupdate = function(value) {\n        viewProps[property] = value;\n      };\n\n      // set animator target\n      animator.target = initialProps[property];\n\n      // when value is set, set the animator target value\n      var prop = {\n        key: property,\n        setter: function setter(value) {\n          // if already at target, we done!\n          if (animator.target === value) {\n            return;\n          }\n\n          animator.target = value;\n        },\n        getter: function getter() {\n          return viewProps[property];\n        }\n      };\n\n      // add getters and setters\n      addGetSet([prop], [viewInternalAPI, viewExternalAPI], viewProps, true);\n\n      // add it to the list for easy updating from the _write method\n      animations.push(animator);\n    });\n\n    // expose internal write api\n    return {\n      write: function write(ts) {\n        var resting = true;\n        animations.forEach(function(animation) {\n          if (!animation.resting) {\n            resting = false;\n          }\n          animation.interpolate(ts);\n        });\n        return resting;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var addEvent = function addEvent(element) {\n    return function(type, fn) {\n      element.addEventListener(type, fn);\n    };\n  };\n\n  var removeEvent = function removeEvent(element) {\n    return function(type, fn) {\n      element.removeEventListener(type, fn);\n    };\n  };\n\n  // mixin\n  var listeners = function listeners(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI,\n      viewState = _ref.viewState,\n      view = _ref.view;\n    var events = [];\n\n    var add = addEvent(view.element);\n    var remove = removeEvent(view.element);\n\n    viewExternalAPI.on = function(type, fn) {\n      events.push({\n        type: type,\n        fn: fn\n      });\n\n      add(type, fn);\n    };\n\n    viewExternalAPI.off = function(type, fn) {\n      events.splice(\n        events.findIndex(function(event) {\n          return event.type === type && event.fn === fn;\n        }),\n        1\n      );\n\n      remove(type, fn);\n    };\n\n    return {\n      write: function write() {\n        // not busy\n        return true;\n      },\n      destroy: function destroy() {\n        events.forEach(function(event) {\n          remove(event.type, event.fn);\n        });\n      }\n    };\n  };\n\n  // add to external api and link to props\n\n  var apis = function apis(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewExternalAPI = _ref.viewExternalAPI;\n    addGetSet(mixinConfig, viewExternalAPI, viewProps);\n  };\n\n  // add to state,\n  // add getters and setters to internal and external api (if not set)\n  // set initial state based on props in viewProps\n  // apply as transforms each frame\n\n  var defaults = {\n    opacity: 1,\n    scaleX: 1,\n    scaleY: 1,\n    translateX: 0,\n    translateY: 0,\n    rotateX: 0,\n    rotateY: 0,\n    rotateZ: 0,\n    originX: 0,\n    originY: 0\n  };\n\n  var styles = function styles(_ref) {\n    var mixinConfig = _ref.mixinConfig,\n      viewProps = _ref.viewProps,\n      viewInternalAPI = _ref.viewInternalAPI,\n      viewExternalAPI = _ref.viewExternalAPI,\n      view = _ref.view;\n    // initial props\n    var initialProps = Object.assign({}, viewProps);\n\n    // current props\n    var currentProps = {};\n\n    // we will add those properties to the external API and link them to the viewState\n    addGetSet(mixinConfig, [viewInternalAPI, viewExternalAPI], viewProps);\n\n    // override rect on internal and external rect getter so it takes in account transforms\n    var getOffset = function getOffset() {\n      return [viewProps['translateX'] || 0, viewProps['translateY'] || 0];\n    };\n\n    var getScale = function getScale() {\n      return [viewProps['scaleX'] || 0, viewProps['scaleY'] || 0];\n    };\n    var getRect = function getRect() {\n      return view.rect\n        ? getViewRect(view.rect, view.childViews, getOffset(), getScale())\n        : null;\n    };\n    viewInternalAPI.rect = { get: getRect };\n    viewExternalAPI.rect = { get: getRect };\n\n    // apply view props\n    mixinConfig.forEach(function(key) {\n      viewProps[key] =\n        typeof initialProps[key] === 'undefined'\n          ? defaults[key]\n          : initialProps[key];\n    });\n\n    // expose api\n    return {\n      write: function write() {\n        // see if props have changed\n        if (!propsHaveChanged(currentProps, viewProps)) {\n          return;\n        }\n\n        // moves element to correct position on screen\n        applyStyles(view.element, viewProps);\n\n        // store new transforms\n        Object.assign(currentProps, Object.assign({}, viewProps));\n\n        // no longer busy\n        return true;\n      },\n      destroy: function destroy() {}\n    };\n  };\n\n  var propsHaveChanged = function propsHaveChanged(currentProps, newProps) {\n    // different amount of keys\n    if (Object.keys(currentProps).length !== Object.keys(newProps).length) {\n      return true;\n    }\n\n    // lets analyze the individual props\n    for (var prop in newProps) {\n      if (newProps[prop] !== currentProps[prop]) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var applyStyles = function applyStyles(element, _ref2) {\n    var opacity = _ref2.opacity,\n      perspective = _ref2.perspective,\n      translateX = _ref2.translateX,\n      translateY = _ref2.translateY,\n      scaleX = _ref2.scaleX,\n      scaleY = _ref2.scaleY,\n      rotateX = _ref2.rotateX,\n      rotateY = _ref2.rotateY,\n      rotateZ = _ref2.rotateZ,\n      originX = _ref2.originX,\n      originY = _ref2.originY,\n      width = _ref2.width,\n      height = _ref2.height;\n\n    var transforms = '';\n    var styles = '';\n\n    // handle transform origin\n    if (isDefined(originX) || isDefined(originY)) {\n      styles +=\n        'transform-origin: ' + (originX || 0) + 'px ' + (originY || 0) + 'px;';\n    }\n\n    // transform order is relevant\n    // 0. perspective\n    if (isDefined(perspective)) {\n      transforms += 'perspective(' + perspective + 'px) ';\n    }\n\n    // 1. translate\n    if (isDefined(translateX) || isDefined(translateY)) {\n      transforms +=\n        'translate3d(' +\n        (translateX || 0) +\n        'px, ' +\n        (translateY || 0) +\n        'px, 0) ';\n    }\n\n    // 2. scale\n    if (isDefined(scaleX) || isDefined(scaleY)) {\n      transforms +=\n        'scale3d(' +\n        (isDefined(scaleX) ? scaleX : 1) +\n        ', ' +\n        (isDefined(scaleY) ? scaleY : 1) +\n        ', 1) ';\n    }\n\n    // 3. rotate\n    if (isDefined(rotateZ)) {\n      transforms += 'rotateZ(' + rotateZ + 'rad) ';\n    }\n\n    if (isDefined(rotateX)) {\n      transforms += 'rotateX(' + rotateX + 'rad) ';\n    }\n\n    if (isDefined(rotateY)) {\n      transforms += 'rotateY(' + rotateY + 'rad) ';\n    }\n\n    // add transforms\n    if (transforms.length) {\n      styles += 'transform:' + transforms + ';';\n    }\n\n    // add opacity\n    if (isDefined(opacity)) {\n      styles += 'opacity:' + opacity + ';';\n\n      // if we reach zero, we make the element inaccessible\n      if (opacity === 0) {\n        styles += 'visibility:hidden;';\n      }\n\n      // if we're below 100% opacity this element can't be clicked\n      if (opacity < 1) {\n        styles += 'pointer-events:none;';\n      }\n    }\n\n    // add height\n    if (isDefined(height)) {\n      styles += 'height:' + height + 'px;';\n    }\n\n    // add width\n    if (isDefined(width)) {\n      styles += 'width:' + width + 'px;';\n    }\n\n    // apply styles\n    var elementCurrentStyle = element.elementCurrentStyle || '';\n\n    // if new styles does not match current styles, lets update!\n    if (\n      styles.length !== elementCurrentStyle.length ||\n      styles !== elementCurrentStyle\n    ) {\n      element.style.cssText = styles;\n      // store current styles so we can compare them to new styles later on\n      // _not_ getting the style value is faster\n      element.elementCurrentStyle = styles;\n    }\n  };\n\n  var Mixins = {\n    styles: styles,\n    listeners: listeners,\n    animations: animations,\n    apis: apis\n  };\n\n  var updateRect = function updateRect() {\n    var rect =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var element =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var style =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n    if (!element.layoutCalculated) {\n      rect.paddingTop = parseInt(style.paddingTop, 10) || 0;\n      rect.marginTop = parseInt(style.marginTop, 10) || 0;\n      rect.marginRight = parseInt(style.marginRight, 10) || 0;\n      rect.marginBottom = parseInt(style.marginBottom, 10) || 0;\n      rect.marginLeft = parseInt(style.marginLeft, 10) || 0;\n      element.layoutCalculated = true;\n    }\n\n    rect.left = element.offsetLeft || 0;\n    rect.top = element.offsetTop || 0;\n    rect.width = element.offsetWidth || 0;\n    rect.height = element.offsetHeight || 0;\n\n    rect.right = rect.left + rect.width;\n    rect.bottom = rect.top + rect.height;\n\n    rect.scrollTop = element.scrollTop;\n\n    rect.hidden = element.offsetParent === null;\n\n    return rect;\n  };\n\n  var createView =\n    // default view definition\n    function createView() {\n      var _ref =\n          arguments.length > 0 && arguments[0] !== undefined\n            ? arguments[0]\n            : {},\n        _ref$tag = _ref.tag,\n        tag = _ref$tag === void 0 ? 'div' : _ref$tag,\n        _ref$name = _ref.name,\n        name = _ref$name === void 0 ? null : _ref$name,\n        _ref$attributes = _ref.attributes,\n        attributes = _ref$attributes === void 0 ? {} : _ref$attributes,\n        _ref$read = _ref.read,\n        read = _ref$read === void 0 ? function() {} : _ref$read,\n        _ref$write = _ref.write,\n        write = _ref$write === void 0 ? function() {} : _ref$write,\n        _ref$create = _ref.create,\n        create = _ref$create === void 0 ? function() {} : _ref$create,\n        _ref$destroy = _ref.destroy,\n        destroy = _ref$destroy === void 0 ? function() {} : _ref$destroy,\n        _ref$filterFrameActio = _ref.filterFrameActionsForChild,\n        filterFrameActionsForChild =\n          _ref$filterFrameActio === void 0\n            ? function(child, actions) {\n                return actions;\n              }\n            : _ref$filterFrameActio,\n        _ref$didCreateView = _ref.didCreateView,\n        didCreateView =\n          _ref$didCreateView === void 0 ? function() {} : _ref$didCreateView,\n        _ref$didWriteView = _ref.didWriteView,\n        didWriteView =\n          _ref$didWriteView === void 0 ? function() {} : _ref$didWriteView,\n        _ref$ignoreRect = _ref.ignoreRect,\n        ignoreRect = _ref$ignoreRect === void 0 ? false : _ref$ignoreRect,\n        _ref$ignoreRectUpdate = _ref.ignoreRectUpdate,\n        ignoreRectUpdate =\n          _ref$ignoreRectUpdate === void 0 ? false : _ref$ignoreRectUpdate,\n        _ref$mixins = _ref.mixins,\n        mixins = _ref$mixins === void 0 ? [] : _ref$mixins;\n      return function(\n        // each view requires reference to store\n        store\n      ) {\n        var props =\n          arguments.length > 1 && arguments[1] !== undefined\n            ? arguments[1]\n            : {};\n        // root element should not be changed\n        var element = createElement(tag, 'filepond--' + name, attributes);\n\n        // style reference should also not be changed\n        var style = window.getComputedStyle(element, null);\n\n        // element rectangle\n        var rect = updateRect();\n        var frameRect = null;\n\n        // rest state\n        var isResting = false;\n\n        // pretty self explanatory\n        var childViews = [];\n\n        // loaded mixins\n        var activeMixins = [];\n\n        // references to created children\n        var ref = {};\n\n        // state used for each instance\n        var state = {};\n\n        // list of writers that will be called to update this view\n        var writers = [\n          write // default writer\n        ];\n\n        var readers = [\n          read // default reader\n        ];\n\n        var destroyers = [\n          destroy // default destroy\n        ];\n\n        // core view methods\n        var getElement = function getElement() {\n          return element;\n        };\n        var getChildViews = function getChildViews() {\n          return childViews.concat();\n        };\n        var getReference = function getReference() {\n          return ref;\n        };\n        var createChildView = function createChildView(store) {\n          return function(view, props) {\n            return view(store, props);\n          };\n        };\n        var getRect = function getRect() {\n          if (frameRect) {\n            return frameRect;\n          }\n          frameRect = getViewRect(rect, childViews, [0, 0], [1, 1]);\n          return frameRect;\n        };\n        var getStyle = function getStyle() {\n          return style;\n        };\n\n        /**\n         * Read data from DOM\n         * @private\n         */\n        var _read = function _read() {\n          frameRect = null;\n\n          // read child views\n          childViews.forEach(function(child) {\n            return child._read();\n          });\n\n          var shouldUpdate = !(ignoreRectUpdate && rect.width && rect.height);\n          if (shouldUpdate) {\n            updateRect(rect, element, style);\n          }\n\n          // readers\n          var api = { root: internalAPI, props: props, rect: rect };\n          readers.forEach(function(reader) {\n            return reader(api);\n          });\n        };\n\n        /**\n         * Write data to DOM\n         * @private\n         */\n        var _write = function _write(ts, frameActions, shouldOptimize) {\n          // if no actions, we assume that the view is resting\n          var resting = frameActions.length === 0;\n\n          // writers\n          writers.forEach(function(writer) {\n            var writerResting = writer({\n              props: props,\n              root: internalAPI,\n              actions: frameActions,\n              timestamp: ts,\n              shouldOptimize: shouldOptimize\n            });\n\n            if (writerResting === false) {\n              resting = false;\n            }\n          });\n\n          // run mixins\n          activeMixins.forEach(function(mixin) {\n            // if one of the mixins is still busy after write operation, we are not resting\n            var mixinResting = mixin.write(ts);\n            if (mixinResting === false) {\n              resting = false;\n            }\n          });\n\n          // updates child views that are currently attached to the DOM\n          childViews\n            .filter(function(child) {\n              return !!child.element.parentNode;\n            })\n            .forEach(function(child) {\n              // if a child view is not resting, we are not resting\n              var childResting = child._write(\n                ts,\n                filterFrameActionsForChild(child, frameActions),\n                shouldOptimize\n              );\n\n              if (!childResting) {\n                resting = false;\n              }\n            });\n\n          // append new elements to DOM and update those\n          childViews\n            //.filter(child => !child.element.parentNode)\n            .forEach(function(child, index) {\n              // skip\n              if (child.element.parentNode) {\n                return;\n              }\n\n              // append to DOM\n              internalAPI.appendChild(child.element, index);\n\n              // call read (need to know the size of these elements)\n              child._read();\n\n              // re-call write\n              child._write(\n                ts,\n                filterFrameActionsForChild(child, frameActions),\n                shouldOptimize\n              );\n\n              // we just added somthing to the dom, no rest\n              resting = false;\n            });\n\n          // update resting state\n          isResting = resting;\n\n          didWriteView({\n            props: props,\n            root: internalAPI,\n            actions: frameActions,\n            timestamp: ts\n          });\n\n          // let parent know if we are resting\n          return resting;\n        };\n\n        var _destroy = function _destroy() {\n          activeMixins.forEach(function(mixin) {\n            return mixin.destroy();\n          });\n          destroyers.forEach(function(destroyer) {\n            destroyer({ root: internalAPI, props: props });\n          });\n          childViews.forEach(function(child) {\n            return child._destroy();\n          });\n        };\n\n        // sharedAPI\n        var sharedAPIDefinition = {\n          element: {\n            get: getElement\n          },\n\n          style: {\n            get: getStyle\n          },\n\n          childViews: {\n            get: getChildViews\n          }\n        };\n\n        // private API definition\n        var internalAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n          rect: {\n            get: getRect\n          },\n\n          // access to custom children references\n          ref: {\n            get: getReference\n          },\n\n          // dom modifiers\n          is: function is(needle) {\n            return name === needle;\n          },\n          appendChild: appendChild(element),\n          createChildView: createChildView(store),\n          linkView: function linkView(view) {\n            childViews.push(view);\n            return view;\n          },\n          unlinkView: function unlinkView(view) {\n            childViews.splice(childViews.indexOf(view), 1);\n          },\n          appendChildView: appendChildView(element, childViews),\n          removeChildView: removeChildView(element, childViews),\n          registerWriter: function registerWriter(writer) {\n            return writers.push(writer);\n          },\n          registerReader: function registerReader(reader) {\n            return readers.push(reader);\n          },\n          registerDestroyer: function registerDestroyer(destroyer) {\n            return destroyers.push(destroyer);\n          },\n          invalidateLayout: function invalidateLayout() {\n            return (element.layoutCalculated = false);\n          },\n\n          // access to data store\n          dispatch: store.dispatch,\n          query: store.query\n        });\n\n        // public view API methods\n        var externalAPIDefinition = {\n          element: {\n            get: getElement\n          },\n\n          childViews: {\n            get: getChildViews\n          },\n\n          rect: {\n            get: getRect\n          },\n\n          resting: {\n            get: function get() {\n              return isResting;\n            }\n          },\n\n          isRectIgnored: function isRectIgnored() {\n            return ignoreRect;\n          },\n          _read: _read,\n          _write: _write,\n          _destroy: _destroy\n        };\n\n        // mixin API methods\n        var mixinAPIDefinition = Object.assign({}, sharedAPIDefinition, {\n          rect: {\n            get: function get() {\n              return rect;\n            }\n          }\n        });\n\n        // add mixin functionality\n        Object.keys(mixins)\n          .sort(function(a, b) {\n            // move styles to the back of the mixin list (so adjustments of other mixins are applied to the props correctly)\n            if (a === 'styles') {\n              return 1;\n            } else if (b === 'styles') {\n              return -1;\n            }\n            return 0;\n          })\n          .forEach(function(key) {\n            var mixinAPI = Mixins[key]({\n              mixinConfig: mixins[key],\n              viewProps: props,\n              viewState: state,\n              viewInternalAPI: internalAPIDefinition,\n              viewExternalAPI: externalAPIDefinition,\n              view: createObject(mixinAPIDefinition)\n            });\n\n            if (mixinAPI) {\n              activeMixins.push(mixinAPI);\n            }\n          });\n\n        // construct private api\n        var internalAPI = createObject(internalAPIDefinition);\n\n        // create the view\n        create({\n          root: internalAPI,\n          props: props\n        });\n\n        // append created child views to root node\n        var childCount = element.children.length; // need to know the current child count so appending happens in correct order\n        childViews.forEach(function(child, index) {\n          internalAPI.appendChild(child.element, childCount + index);\n        });\n\n        // call did create\n        didCreateView(internalAPI);\n\n        // expose public api\n        return createObject(externalAPIDefinition);\n      };\n    };\n\n  var createPainter = function createPainter(read, write) {\n    var fps =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 60;\n\n    var name = '__framePainter';\n\n    // set global painter\n    if (window[name]) {\n      window[name].readers.push(read);\n      window[name].writers.push(write);\n      return;\n    }\n\n    window[name] = {\n      readers: [read],\n      writers: [write]\n    };\n\n    var painter = window[name];\n\n    var interval = 1000 / fps;\n    var last = null;\n    var id = null;\n    var requestTick = null;\n    var cancelTick = null;\n\n    var setTimerType = function setTimerType() {\n      if (document.hidden) {\n        requestTick = function requestTick() {\n          return window.setTimeout(function() {\n            return tick(performance.now());\n          }, interval);\n        };\n        cancelTick = function cancelTick() {\n          return window.clearTimeout(id);\n        };\n      } else {\n        requestTick = function requestTick() {\n          return window.requestAnimationFrame(tick);\n        };\n        cancelTick = function cancelTick() {\n          return window.cancelAnimationFrame(id);\n        };\n      }\n    };\n\n    document.addEventListener('visibilitychange', function() {\n      if (cancelTick) cancelTick();\n      setTimerType();\n      tick(performance.now());\n    });\n\n    var tick = function tick(ts) {\n      // queue next tick\n      id = requestTick(tick);\n\n      // limit fps\n      if (!last) {\n        last = ts;\n      }\n\n      var delta = ts - last;\n\n      if (delta <= interval) {\n        // skip frame\n        return;\n      }\n\n      // align next frame\n      last = ts - (delta % interval);\n\n      // update view\n      painter.readers.forEach(function(read) {\n        return read();\n      });\n      painter.writers.forEach(function(write) {\n        return write(ts);\n      });\n    };\n\n    setTimerType();\n    tick(performance.now());\n\n    return {\n      pause: function pause() {\n        cancelTick(id);\n      }\n    };\n  };\n\n  var createRoute = function createRoute(routes, fn) {\n    return function(_ref) {\n      var root = _ref.root,\n        props = _ref.props,\n        _ref$actions = _ref.actions,\n        actions = _ref$actions === void 0 ? [] : _ref$actions,\n        timestamp = _ref.timestamp,\n        shouldOptimize = _ref.shouldOptimize;\n      actions\n        .filter(function(action) {\n          return routes[action.type];\n        })\n        .forEach(function(action) {\n          return routes[action.type]({\n            root: root,\n            props: props,\n            action: action.data,\n            timestamp: timestamp,\n            shouldOptimize: shouldOptimize\n          });\n        });\n\n      if (fn) {\n        fn({\n          root: root,\n          props: props,\n          actions: actions,\n          timestamp: timestamp,\n          shouldOptimize: shouldOptimize\n        });\n      }\n    };\n  };\n\n  var insertBefore = function insertBefore(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(newNode, referenceNode);\n  };\n\n  var insertAfter = function insertAfter(newNode, referenceNode) {\n    return referenceNode.parentNode.insertBefore(\n      newNode,\n      referenceNode.nextSibling\n    );\n  };\n\n  var isArray = function isArray(value) {\n    return Array.isArray(value);\n  };\n\n  var isEmpty = function isEmpty(value) {\n    return value == null;\n  };\n\n  var trim = function trim(str) {\n    return str.trim();\n  };\n\n  var toString = function toString(value) {\n    return '' + value;\n  };\n\n  var toArray = function toArray(value) {\n    var splitter =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ',';\n    if (isEmpty(value)) {\n      return [];\n    }\n    if (isArray(value)) {\n      return value;\n    }\n    return toString(value)\n      .split(splitter)\n      .map(trim)\n      .filter(function(str) {\n        return str.length;\n      });\n  };\n\n  var isBoolean = function isBoolean(value) {\n    return typeof value === 'boolean';\n  };\n\n  var toBoolean = function toBoolean(value) {\n    return isBoolean(value) ? value : value === 'true';\n  };\n\n  var isString = function isString(value) {\n    return typeof value === 'string';\n  };\n\n  var toNumber = function toNumber(value) {\n    return isNumber(value)\n      ? value\n      : isString(value)\n      ? toString(value).replace(/[a-z]+/gi, '')\n      : 0;\n  };\n\n  var toInt = function toInt(value) {\n    return parseInt(toNumber(value), 10);\n  };\n\n  var toFloat = function toFloat(value) {\n    return parseFloat(toNumber(value));\n  };\n\n  var isInt = function isInt(value) {\n    return isNumber(value) && isFinite(value) && Math.floor(value) === value;\n  };\n\n  var toBytes = function toBytes(value) {\n    // is in bytes\n    if (isInt(value)) {\n      return value;\n    }\n\n    // is natural file size\n    var naturalFileSize = toString(value).trim();\n\n    // if is value in megabytes\n    if (/MB$/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/MB$i/, '').trim();\n      return toInt(naturalFileSize) * 1000 * 1000;\n    }\n\n    // if is value in kilobytes\n    if (/KB/i.test(naturalFileSize)) {\n      naturalFileSize = naturalFileSize.replace(/KB$i/, '').trim();\n      return toInt(naturalFileSize) * 1000;\n    }\n\n    return toInt(naturalFileSize);\n  };\n\n  var isFunction = function isFunction(value) {\n    return typeof value === 'function';\n  };\n\n  var toFunctionReference = function toFunctionReference(string) {\n    var ref = self;\n    var levels = string.split('.');\n    var level = null;\n    while ((level = levels.shift())) {\n      ref = ref[level];\n      if (!ref) {\n        return null;\n      }\n    }\n    return ref;\n  };\n\n  var methods = {\n    process: 'POST',\n    patch: 'PATCH',\n    revert: 'DELETE',\n    fetch: 'GET',\n    restore: 'GET',\n    load: 'GET'\n  };\n\n  var createServerAPI = function createServerAPI(outline) {\n    var api = {};\n\n    api.url = isString(outline) ? outline : outline.url || '';\n    api.timeout = outline.timeout ? parseInt(outline.timeout, 10) : 0;\n    api.headers = outline.headers ? outline.headers : {};\n\n    forin(methods, function(key) {\n      api[key] = createAction(\n        key,\n        outline[key],\n        methods[key],\n        api.timeout,\n        api.headers\n      );\n    });\n\n    // special treatment for remove\n    api.remove = outline.remove || null;\n\n    // remove generic headers from api object\n    delete api.headers;\n\n    return api;\n  };\n\n  var createAction = function createAction(\n    name,\n    outline,\n    method,\n    timeout,\n    headers\n  ) {\n    // is explicitely set to null so disable\n    if (outline === null) {\n      return null;\n    }\n\n    // if is custom function, done! Dev handles everything.\n    if (typeof outline === 'function') {\n      return outline;\n    }\n\n    // build action object\n    var action = {\n      url: method === 'GET' || method === 'PATCH' ? '?' + name + '=' : '',\n      method: method,\n      headers: headers,\n      withCredentials: false,\n      timeout: timeout,\n      onload: null,\n      ondata: null,\n      onerror: null\n    };\n\n    // is a single url\n    if (isString(outline)) {\n      action.url = outline;\n      return action;\n    }\n\n    // overwrite\n    Object.assign(action, outline);\n\n    // see if should reformat headers;\n    if (isString(action.headers)) {\n      var parts = action.headers.split(/:(.+)/);\n      action.headers = {\n        header: parts[0],\n        value: parts[1]\n      };\n    }\n\n    // if is bool withCredentials\n    action.withCredentials = toBoolean(action.withCredentials);\n\n    return action;\n  };\n\n  var toServerAPI = function toServerAPI(value) {\n    return createServerAPI(value);\n  };\n\n  var isNull = function isNull(value) {\n    return value === null;\n  };\n\n  var isObject = function isObject(value) {\n    return typeof value === 'object' && value !== null;\n  };\n\n  var isAPI = function isAPI(value) {\n    return (\n      isObject(value) &&\n      isString(value.url) &&\n      isObject(value.process) &&\n      isObject(value.revert) &&\n      isObject(value.restore) &&\n      isObject(value.fetch)\n    );\n  };\n\n  var getType = function getType(value) {\n    if (isArray(value)) {\n      return 'array';\n    }\n\n    if (isNull(value)) {\n      return 'null';\n    }\n\n    if (isInt(value)) {\n      return 'int';\n    }\n\n    if (/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(value)) {\n      return 'bytes';\n    }\n\n    if (isAPI(value)) {\n      return 'api';\n    }\n\n    return typeof value;\n  };\n\n  var replaceSingleQuotes = function replaceSingleQuotes(str) {\n    return str\n      .replace(/{\\s*'/g, '{\"')\n      .replace(/'\\s*}/g, '\"}')\n      .replace(/'\\s*:/g, '\":')\n      .replace(/:\\s*'/g, ':\"')\n      .replace(/,\\s*'/g, ',\"')\n      .replace(/'\\s*,/g, '\",');\n  };\n\n  var conversionTable = {\n    array: toArray,\n    boolean: toBoolean,\n    int: function int(value) {\n      return getType(value) === 'bytes' ? toBytes(value) : toInt(value);\n    },\n    number: toFloat,\n    float: toFloat,\n    bytes: toBytes,\n    string: function string(value) {\n      return isFunction(value) ? value : toString(value);\n    },\n    function: function _function(value) {\n      return toFunctionReference(value);\n    },\n    serverapi: toServerAPI,\n    object: function object(value) {\n      try {\n        return JSON.parse(replaceSingleQuotes(value));\n      } catch (e) {\n        return null;\n      }\n    }\n  };\n\n  var convertTo = function convertTo(value, type) {\n    return conversionTable[type](value);\n  };\n\n  var getValueByType = function getValueByType(\n    newValue,\n    defaultValue,\n    valueType\n  ) {\n    // can always assign default value\n    if (newValue === defaultValue) {\n      return newValue;\n    }\n\n    // get the type of the new value\n    var newValueType = getType(newValue);\n\n    // is valid type?\n    if (newValueType !== valueType) {\n      // is string input, let's attempt to convert\n      var convertedValue = convertTo(newValue, valueType);\n\n      // what is the type now\n      newValueType = getType(convertedValue);\n\n      // no valid conversions found\n      if (convertedValue === null) {\n        throw 'Trying to assign value with incorrect type to \"' +\n          option +\n          '\", allowed type: \"' +\n          valueType +\n          '\"';\n      } else {\n        newValue = convertedValue;\n      }\n    }\n\n    // assign new value\n    return newValue;\n  };\n\n  var createOption = function createOption(defaultValue, valueType) {\n    var currentValue = defaultValue;\n    return {\n      enumerable: true,\n      get: function get() {\n        return currentValue;\n      },\n      set: function set(newValue) {\n        currentValue = getValueByType(newValue, defaultValue, valueType);\n      }\n    };\n  };\n\n  var createOptions = function createOptions(options) {\n    var obj = {};\n    forin(options, function(prop) {\n      var optionDefinition = options[prop];\n      obj[prop] = createOption(optionDefinition[0], optionDefinition[1]);\n    });\n    return createObject(obj);\n  };\n\n  var createInitialState = function createInitialState(options) {\n    return {\n      // model\n      items: [],\n\n      // timeout used for calling update items\n      listUpdateTimeout: null,\n\n      // timeout used for stacking metadata updates\n      itemUpdateTimeout: null,\n\n      // queue of items waiting to be processed\n      processingQueue: [],\n\n      // options\n      options: createOptions(options)\n    };\n  };\n\n  var fromCamels = function fromCamels(string) {\n    var separator =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string\n      .split(/(?=[A-Z])/)\n      .map(function(part) {\n        return part.toLowerCase();\n      })\n      .join(separator);\n  };\n\n  var createOptionAPI = function createOptionAPI(store, options) {\n    var obj = {};\n    forin(options, function(key) {\n      obj[key] = {\n        get: function get() {\n          return store.getState().options[key];\n        },\n        set: function set(value) {\n          store.dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        }\n      };\n    });\n    return obj;\n  };\n\n  var createOptionActions = function createOptionActions(options) {\n    return function(dispatch, query, state) {\n      var obj = {};\n      forin(options, function(key) {\n        var name = fromCamels(key, '_').toUpperCase();\n\n        obj['SET_' + name] = function(action) {\n          try {\n            state.options[key] = action.value;\n          } catch (e) {} // nope, failed\n\n          // we successfully set the value of this option\n          dispatch('DID_SET_' + name, { value: state.options[key] });\n        };\n      });\n      return obj;\n    };\n  };\n\n  var createOptionQueries = function createOptionQueries(options) {\n    return function(state) {\n      var obj = {};\n      forin(options, function(key) {\n        obj['GET_' + fromCamels(key, '_').toUpperCase()] = function(action) {\n          return state.options[key];\n        };\n      });\n      return obj;\n    };\n  };\n\n  var InteractionMethod = {\n    API: 1,\n    DROP: 2,\n    BROWSE: 3,\n    PASTE: 4,\n    NONE: 5\n  };\n\n  var getUniqueId = function getUniqueId() {\n    return Math.random()\n      .toString(36)\n      .substr(2, 9);\n  };\n\n  var arrayRemove = function arrayRemove(arr, index) {\n    return arr.splice(index, 1);\n  };\n\n  var on = function on() {\n    var listeners = [];\n    var off = function off(event, cb) {\n      arrayRemove(\n        listeners,\n        listeners.findIndex(function(listener) {\n          return listener.event === event && (listener.cb === cb || !cb);\n        })\n      );\n    };\n    return {\n      fire: function fire(event) {\n        for (\n          var _len = arguments.length,\n            args = new Array(_len > 1 ? _len - 1 : 0),\n            _key = 1;\n          _key < _len;\n          _key++\n        ) {\n          args[_key - 1] = arguments[_key];\n        }\n        listeners\n          .filter(function(listener) {\n            return listener.event === event;\n          })\n          .map(function(listener) {\n            return listener.cb;\n          })\n          .forEach(function(cb) {\n            setTimeout(function() {\n              cb.apply(void 0, args);\n            }, 0);\n          });\n      },\n      on: function on(event, cb) {\n        listeners.push({ event: event, cb: cb });\n      },\n      onOnce: function onOnce(event, _cb) {\n        listeners.push({\n          event: event,\n          cb: function cb() {\n            off(event, _cb);\n            _cb.apply(void 0, arguments);\n          }\n        });\n      },\n      off: off\n    };\n  };\n\n  var copyObjectPropertiesToObject = function copyObjectPropertiesToObject(\n    src,\n    target,\n    excluded\n  ) {\n    Object.getOwnPropertyNames(src)\n      .filter(function(property) {\n        return !excluded.includes(property);\n      })\n      .forEach(function(key) {\n        return Object.defineProperty(\n          target,\n          key,\n          Object.getOwnPropertyDescriptor(src, key)\n        );\n      });\n  };\n\n  var PRIVATE = [\n    'fire',\n    'process',\n    'revert',\n    'load',\n    'on',\n    'off',\n    'onOnce',\n    'retryLoad',\n    'extend',\n    'archive',\n    'archived',\n    'release',\n    'released',\n    'requestProcessing',\n    'freeze'\n  ];\n\n  var createItemAPI = function createItemAPI(item) {\n    var api = {};\n    copyObjectPropertiesToObject(item, api, PRIVATE);\n    return api;\n  };\n\n  var removeReleasedItems = function removeReleasedItems(items) {\n    items.forEach(function(item, index) {\n      if (item.released) {\n        arrayRemove(items, index);\n      }\n    });\n  };\n\n  var ItemStatus = {\n    INIT: 1,\n    IDLE: 2,\n    PROCESSING_QUEUED: 9,\n    PROCESSING: 3,\n    PROCESSING_COMPLETE: 5,\n    PROCESSING_ERROR: 6,\n    PROCESSING_REVERT_ERROR: 10,\n    LOADING: 7,\n    LOAD_ERROR: 8\n  };\n\n  var FileOrigin = {\n    INPUT: 1,\n    LIMBO: 2,\n    LOCAL: 3\n  };\n\n  var getNonNumeric = function getNonNumeric(str) {\n    return /[^0-9]+/.exec(str);\n  };\n\n  var getDecimalSeparator = function getDecimalSeparator() {\n    return getNonNumeric((1.1).toLocaleString())[0];\n  };\n\n  var getThousandsSeparator = function getThousandsSeparator() {\n    // Added for browsers that do not return the thousands separator (happend on native browser Android 4.4.4)\n    // We check against the normal toString output and if they're the same return a comma when decimal separator is a dot\n    var decimalSeparator = getDecimalSeparator();\n    var thousandsStringWithSeparator = (1000.0).toLocaleString();\n    var thousandsStringWithoutSeparator = (1000.0).toString();\n    if (thousandsStringWithSeparator !== thousandsStringWithoutSeparator) {\n      return getNonNumeric(thousandsStringWithSeparator)[0];\n    }\n    return decimalSeparator === '.' ? ',' : '.';\n  };\n\n  var Type = {\n    BOOLEAN: 'boolean',\n    INT: 'int',\n    NUMBER: 'number',\n    STRING: 'string',\n    ARRAY: 'array',\n    OBJECT: 'object',\n    FUNCTION: 'function',\n    ACTION: 'action',\n    SERVER_API: 'serverapi',\n    REGEX: 'regex'\n  };\n\n  // all registered filters\n  var filters = [];\n\n  // loops over matching filters and passes options to each filter, returning the mapped results\n  var applyFilterChain = function applyFilterChain(key, value, utils) {\n    return new Promise(function(resolve, reject) {\n      // find matching filters for this key\n      var matchingFilters = filters\n        .filter(function(f) {\n          return f.key === key;\n        })\n        .map(function(f) {\n          return f.cb;\n        });\n\n      // resolve now\n      if (matchingFilters.length === 0) {\n        resolve(value);\n        return;\n      }\n\n      // first filter to kick things of\n      var initialFilter = matchingFilters.shift();\n\n      // chain filters\n      matchingFilters\n        .reduce(\n          // loop over promises passing value to next promise\n          function(current, next) {\n            return current.then(function(value) {\n              return next(value, utils);\n            });\n          },\n\n          // call initial filter, will return a promise\n          initialFilter(value, utils)\n\n          // all executed\n        )\n        .then(function(value) {\n          return resolve(value);\n        })\n        .catch(function(error) {\n          return reject(error);\n        });\n    });\n  };\n\n  var applyFilters = function applyFilters(key, value, utils) {\n    return filters\n      .filter(function(f) {\n        return f.key === key;\n      })\n      .map(function(f) {\n        return f.cb(value, utils);\n      });\n  };\n\n  // adds a new filter to the list\n  var addFilter = function addFilter(key, cb) {\n    return filters.push({ key: key, cb: cb });\n  };\n\n  var extendDefaultOptions = function extendDefaultOptions(additionalOptions) {\n    return Object.assign(defaultOptions, additionalOptions);\n  };\n\n  var getOptions = function getOptions() {\n    return Object.assign({}, defaultOptions);\n  };\n\n  var setOptions = function setOptions(opts) {\n    forin(opts, function(key, value) {\n      // key does not exist, so this option cannot be set\n      if (!defaultOptions[key]) {\n        return;\n      }\n      defaultOptions[key][0] = getValueByType(\n        value,\n        defaultOptions[key][0],\n        defaultOptions[key][1]\n      );\n    });\n  };\n\n  // default options on app\n  var defaultOptions = {\n    // the id to add to the root element\n    id: [null, Type.STRING],\n\n    // input field name to use\n    name: ['filepond', Type.STRING],\n\n    // disable the field\n    disabled: [false, Type.BOOLEAN],\n\n    // classname to put on wrapper\n    className: [null, Type.STRING],\n\n    // is the field required\n    required: [false, Type.BOOLEAN],\n\n    // Allow media capture when value is set\n    captureMethod: [null, Type.STRING],\n    // - \"camera\", \"microphone\" or \"camcorder\",\n    // - Does not work with multiple on apple devices\n    // - If set, acceptedFileTypes must be made to match with media wildcard \"image/*\", \"audio/*\" or \"video/*\"\n\n    // Feature toggles\n    allowDrop: [true, Type.BOOLEAN], // Allow dropping of files\n    allowBrowse: [true, Type.BOOLEAN], // Allow browsing the file system\n    allowPaste: [true, Type.BOOLEAN], // Allow pasting files\n    allowMultiple: [false, Type.BOOLEAN], // Allow multiple files (disabled by default, as multiple attribute is also required on input to allow multiple)\n    allowReplace: [true, Type.BOOLEAN], // Allow dropping a file on other file to replace it (only works when multiple is set to false)\n    allowRevert: [true, Type.BOOLEAN], // Allows user to revert file upload\n\n    // Revert mode\n    forceRevert: [false, Type.BOOLEAN], // Set to 'force' to require the file to be reverted before removal\n\n    // Input requirements\n    maxFiles: [null, Type.INT], // Max number of files\n    checkValidity: [false, Type.BOOLEAN], // Enables custom validity messages\n\n    // Where to put file\n    itemInsertLocationFreedom: [true, Type.BOOLEAN], // Set to false to always add items to begin or end of list\n    itemInsertLocation: ['before', Type.STRING], // Default index in list to add items that have been dropped at the top of the list\n    itemInsertInterval: [75, Type.INT],\n\n    // Drag 'n Drop related\n    dropOnPage: [false, Type.BOOLEAN], // Allow dropping of files anywhere on page (prevents browser from opening file if dropped outside of Up)\n    dropOnElement: [true, Type.BOOLEAN], // Drop needs to happen on element (set to false to also load drops outside of Up)\n    dropValidation: [false, Type.BOOLEAN], // Enable or disable validating files on drop\n    ignoredFiles: [['.ds_store', 'thumbs.db', 'desktop.ini'], Type.ARRAY],\n\n    // Upload related\n    instantUpload: [true, Type.BOOLEAN], // Should upload files immidiately on drop\n    maxParallelUploads: [2, Type.INT], // Maximum files to upload in parallel\n\n    // Chunks\n    chunkUploads: [false, Type.BOOLEAN], // Enable chunked uploads\n    chunkForce: [false, Type.BOOLEAN], // Force use of chunk uploads even for files smaller than chunk size\n    chunkSize: [5000000, Type.INT], // Size of chunks (5MB default)\n    chunkRetryDelays: [[500, 1000, 3000], Type.Array], // Amount of times to retry upload of a chunk when it fails\n\n    // The server api end points to use for uploading (see docs)\n    server: [null, Type.SERVER_API],\n\n    // Labels and status messages\n    labelDecimalSeparator: [getDecimalSeparator(), Type.STRING], // Default is locale separator\n    labelThousandsSeparator: [getThousandsSeparator(), Type.STRING], // Default is locale separator\n\n    labelIdle: [\n      'Drag & Drop your files or <span class=\"filepond--label-action\">Browse</span>',\n      Type.STRING\n    ],\n    labelInvalidField: ['Field contains invalid files', Type.STRING],\n    labelFileWaitingForSize: ['Waiting for size', Type.STRING],\n    labelFileSizeNotAvailable: ['Size not available', Type.STRING],\n    labelFileCountSingular: ['file in list', Type.STRING],\n    labelFileCountPlural: ['files in list', Type.STRING],\n    labelFileLoading: ['Loading', Type.STRING],\n    labelFileAdded: ['Added', Type.STRING], // assistive only\n    labelFileLoadError: ['Error during load', Type.STRING],\n    labelFileRemoved: ['Removed', Type.STRING], // assistive only\n    labelFileRemoveError: ['Error during remove', Type.STRING],\n    labelFileProcessing: ['Uploading', Type.STRING],\n    labelFileProcessingComplete: ['Upload complete', Type.STRING],\n    labelFileProcessingAborted: ['Upload cancelled', Type.STRING],\n    labelFileProcessingError: ['Error during upload', Type.STRING],\n    labelFileProcessingRevertError: ['Error during revert', Type.STRING],\n\n    labelTapToCancel: ['tap to cancel', Type.STRING],\n    labelTapToRetry: ['tap to retry', Type.STRING],\n    labelTapToUndo: ['tap to undo', Type.STRING],\n\n    labelButtonRemoveItem: ['Remove', Type.STRING],\n    labelButtonAbortItemLoad: ['Abort', Type.STRING],\n    labelButtonRetryItemLoad: ['Retry', Type.STRING],\n    labelButtonAbortItemProcessing: ['Cancel', Type.STRING],\n    labelButtonUndoItemProcessing: ['Undo', Type.STRING],\n    labelButtonRetryItemProcessing: ['Retry', Type.STRING],\n    labelButtonProcessItem: ['Upload', Type.STRING],\n\n    // make sure width and height plus viewpox are even numbers so icons are nicely centered\n    iconRemove: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    iconProcess: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z\" fill=\"currentColor\" fill-rule=\"evenodd\"/></svg>',\n      Type.STRING\n    ],\n\n    iconRetry: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    iconUndo: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    iconDone: [\n      '<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z\" fill=\"currentColor\" fill-rule=\"nonzero\"/></svg>',\n      Type.STRING\n    ],\n\n    // event handlers\n    oninit: [null, Type.FUNCTION],\n    onwarning: [null, Type.FUNCTION],\n    onerror: [null, Type.FUNCTION],\n    onactivatefile: [null, Type.FUNCTION],\n    onaddfilestart: [null, Type.FUNCTION],\n    onaddfileprogress: [null, Type.FUNCTION],\n    onaddfile: [null, Type.FUNCTION],\n    onprocessfilestart: [null, Type.FUNCTION],\n    onprocessfileprogress: [null, Type.FUNCTION],\n    onprocessfileabort: [null, Type.FUNCTION],\n    onprocessfilerevert: [null, Type.FUNCTION],\n    onprocessfile: [null, Type.FUNCTION],\n    onprocessfiles: [null, Type.FUNCTION],\n    onremovefile: [null, Type.FUNCTION],\n    onpreparefile: [null, Type.FUNCTION],\n    onupdatefiles: [null, Type.FUNCTION],\n\n    // hooks\n    beforeDropFile: [null, Type.FUNCTION],\n    beforeAddFile: [null, Type.FUNCTION],\n    beforeRemoveFile: [null, Type.FUNCTION],\n\n    // styles\n    stylePanelLayout: [null, Type.STRING], // null 'integrated', 'compact', 'circle'\n    stylePanelAspectRatio: [null, Type.STRING], // null or '3:2' or 1\n    styleItemPanelAspectRatio: [null, Type.STRING],\n    styleButtonRemoveItemPosition: ['left', Type.STRING],\n    styleButtonProcessItemPosition: ['right', Type.STRING],\n    styleLoadIndicatorPosition: ['right', Type.STRING],\n    styleProgressIndicatorPosition: ['right', Type.STRING],\n\n    // custom initial files array\n    files: [[], Type.ARRAY]\n  };\n\n  var getItemByQuery = function getItemByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return items[0] || null;\n    }\n\n    // query is index\n    if (isInt(query)) {\n      return items[query] || null;\n    }\n\n    // if query is item, get the id\n    if (typeof query === 'object') {\n      query = query.id;\n    }\n\n    // assume query is a string and return item by id\n    return (\n      items.find(function(item) {\n        return item.id === query;\n      }) || null\n    );\n  };\n\n  var getNumericAspectRatioFromString = function getNumericAspectRatioFromString(\n    aspectRatio\n  ) {\n    if (isEmpty(aspectRatio)) {\n      return aspectRatio;\n    }\n    if (/:/.test(aspectRatio)) {\n      var parts = aspectRatio.split(':');\n      return parts[1] / parts[0];\n    }\n    return parseFloat(aspectRatio);\n  };\n\n  var getActiveItems = function getActiveItems(items) {\n    return items.filter(function(item) {\n      return !item.archived;\n    });\n  };\n\n  var Status = {\n    EMPTY: 0,\n    IDLE: 1, // waiting\n    ERROR: 2, // a file is in error state\n    BUSY: 3, // busy processing or loading\n    READY: 4 // all files uploaded\n  };\n\n  var ITEM_ERROR = [\n    ItemStatus.LOAD_ERROR,\n    ItemStatus.PROCESSING_ERROR,\n    ItemStatus.PROCESSING_REVERT_ERROR\n  ];\n  var ITEM_BUSY = [\n    ItemStatus.LOADING,\n    ItemStatus.PROCESSING,\n    ItemStatus.PROCESSING_QUEUED,\n    ItemStatus.INIT\n  ];\n  var ITEM_READY = [ItemStatus.PROCESSING_COMPLETE];\n\n  var isItemInErrorState = function isItemInErrorState(item) {\n    return ITEM_ERROR.includes(item.status);\n  };\n  var isItemInBusyState = function isItemInBusyState(item) {\n    return ITEM_BUSY.includes(item.status);\n  };\n  var isItemInReadyState = function isItemInReadyState(item) {\n    return ITEM_READY.includes(item.status);\n  };\n\n  var queries = function queries(state) {\n    return {\n      GET_STATUS: function GET_STATUS() {\n        var items = getActiveItems(state.items);\n        var EMPTY = Status.EMPTY,\n          ERROR = Status.ERROR,\n          BUSY = Status.BUSY,\n          IDLE = Status.IDLE,\n          READY = Status.READY;\n\n        if (items.length === 0) return EMPTY;\n\n        if (items.some(isItemInErrorState)) return ERROR;\n\n        if (items.some(isItemInBusyState)) return BUSY;\n\n        if (items.some(isItemInReadyState)) return READY;\n\n        return IDLE;\n      },\n\n      GET_ITEM: function GET_ITEM(query) {\n        return getItemByQuery(state.items, query);\n      },\n\n      GET_ACTIVE_ITEM: function GET_ACTIVE_ITEM(query) {\n        return getItemByQuery(getActiveItems(state.items), query);\n      },\n\n      GET_ACTIVE_ITEMS: function GET_ACTIVE_ITEMS() {\n        return getActiveItems(state.items);\n      },\n\n      GET_ITEMS: function GET_ITEMS() {\n        return state.items;\n      },\n\n      GET_ITEM_NAME: function GET_ITEM_NAME(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.filename : null;\n      },\n\n      GET_ITEM_SIZE: function GET_ITEM_SIZE(query) {\n        var item = getItemByQuery(state.items, query);\n        return item ? item.fileSize : null;\n      },\n\n      GET_STYLES: function GET_STYLES() {\n        return Object.keys(state.options)\n          .filter(function(key) {\n            return /^style/.test(key);\n          })\n          .map(function(option) {\n            return {\n              name: option,\n              value: state.options[option]\n            };\n          });\n      },\n\n      GET_PANEL_ASPECT_RATIO: function GET_PANEL_ASPECT_RATIO() {\n        var isShapeCircle = /circle/.test(state.options.stylePanelLayout);\n        var aspectRatio = isShapeCircle\n          ? 1\n          : getNumericAspectRatioFromString(\n              state.options.stylePanelAspectRatio\n            );\n        return aspectRatio;\n      },\n\n      GET_ITEM_PANEL_ASPECT_RATIO: function GET_ITEM_PANEL_ASPECT_RATIO() {\n        return state.options.styleItemPanelAspectRatio;\n      },\n\n      GET_ITEMS_BY_STATUS: function GET_ITEMS_BY_STATUS(status) {\n        return getActiveItems(state.items).filter(function(item) {\n          return item.status === status;\n        });\n      },\n\n      GET_TOTAL_ITEMS: function GET_TOTAL_ITEMS() {\n        return getActiveItems(state.items).length;\n      },\n\n      IS_ASYNC: function IS_ASYNC() {\n        return (\n          isObject(state.options.server) &&\n          (isObject(state.options.server.process) ||\n            isFunction(state.options.server.process))\n        );\n      }\n    };\n  };\n\n  var hasRoomForItem = function hasRoomForItem(state) {\n    var count = getActiveItems(state.items).length;\n\n    // if cannot have multiple items, to add one item it should currently not contain items\n    if (!state.options.allowMultiple) {\n      return count === 0;\n    }\n\n    // if allows multiple items, we check if a max item count has been set, if not, there's no limit\n    var maxFileCount = state.options.maxFiles;\n    if (maxFileCount === null) {\n      return true;\n    }\n\n    // we check if the current count is smaller than the max count, if so, another file can still be added\n    if (count < maxFileCount) {\n      return true;\n    }\n\n    // no more room for another file\n    return false;\n  };\n\n  var limit = function limit(value, min, max) {\n    return Math.max(Math.min(max, value), min);\n  };\n\n  var arrayInsert = function arrayInsert(arr, index, item) {\n    return arr.splice(index, 0, item);\n  };\n\n  var insertItem = function insertItem(items, item, index) {\n    if (isEmpty(item)) {\n      return null;\n    }\n\n    // if index is undefined, append\n    if (typeof index === 'undefined') {\n      items.push(item);\n      return item;\n    }\n\n    // limit the index to the size of the items array\n    index = limit(index, 0, items.length);\n\n    // add item to array\n    arrayInsert(items, index, item);\n\n    // expose\n    return item;\n  };\n\n  var isBase64DataURI = function isBase64DataURI(str) {\n    return /^\\s*data:([a-z]+\\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\\-._~:@\\/?%\\s]*)\\s*$/i.test(\n      str\n    );\n  };\n\n  var getFilenameFromURL = function getFilenameFromURL(url) {\n    return url\n      .split('/')\n      .pop()\n      .split('?')\n      .shift();\n  };\n\n  var getExtensionFromFilename = function getExtensionFromFilename(name) {\n    return name.split('.').pop();\n  };\n\n  var guesstimateExtension = function guesstimateExtension(type) {\n    // if no extension supplied, exit here\n    if (typeof type !== 'string') {\n      return '';\n    }\n\n    // get subtype\n    var subtype = type.split('/').pop();\n\n    // is svg subtype\n    if (/svg/.test(subtype)) {\n      return 'svg';\n    }\n\n    if (/zip|compressed/.test(subtype)) {\n      return 'zip';\n    }\n\n    if (/plain/.test(subtype)) {\n      return 'txt';\n    }\n\n    if (/msword/.test(subtype)) {\n      return 'doc';\n    }\n\n    // if is valid subtype\n    if (/[a-z]+/.test(subtype)) {\n      // always use jpg extension\n      if (subtype === 'jpeg') {\n        return 'jpg';\n      }\n\n      // return subtype\n      return subtype;\n    }\n\n    return '';\n  };\n\n  var leftPad = function leftPad(value) {\n    var padding =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n    return (padding + value).slice(-padding.length);\n  };\n\n  var getDateString = function getDateString() {\n    var date =\n      arguments.length > 0 && arguments[0] !== undefined\n        ? arguments[0]\n        : new Date();\n    return (\n      date.getFullYear() +\n      '-' +\n      leftPad(date.getMonth() + 1, '00') +\n      '-' +\n      leftPad(date.getDate(), '00') +\n      '_' +\n      leftPad(date.getHours(), '00') +\n      '-' +\n      leftPad(date.getMinutes(), '00') +\n      '-' +\n      leftPad(date.getSeconds(), '00')\n    );\n  };\n\n  var getFileFromBlob = function getFileFromBlob(blob, filename) {\n    var type =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var extension =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n    var file =\n      typeof type === 'string'\n        ? blob.slice(0, blob.size, type)\n        : blob.slice(0, blob.size, blob.type);\n    file.lastModifiedDate = new Date();\n\n    // if blob has name property, use as filename if no filename supplied\n    if (!isString(filename)) {\n      filename = getDateString();\n    }\n\n    // if filename supplied but no extension and filename has extension\n    if (filename && extension === null && getExtensionFromFilename(filename)) {\n      file.name = filename;\n    } else {\n      extension = extension || guesstimateExtension(file.type);\n      file.name = filename + (extension ? '.' + extension : '');\n    }\n\n    return file;\n  };\n\n  var getBlobBuilder = function getBlobBuilder() {\n    return (window.BlobBuilder =\n      window.BlobBuilder ||\n      window.WebKitBlobBuilder ||\n      window.MozBlobBuilder ||\n      window.MSBlobBuilder);\n  };\n\n  var createBlob = function createBlob(arrayBuffer, mimeType) {\n    var BB = getBlobBuilder();\n\n    if (BB) {\n      var bb = new BB();\n      bb.append(arrayBuffer);\n      return bb.getBlob(mimeType);\n    }\n\n    return new Blob([arrayBuffer], {\n      type: mimeType\n    });\n  };\n\n  var getBlobFromByteStringWithMimeType = function getBlobFromByteStringWithMimeType(\n    byteString,\n    mimeType\n  ) {\n    var ab = new ArrayBuffer(byteString.length);\n    var ia = new Uint8Array(ab);\n\n    for (var i = 0; i < byteString.length; i++) {\n      ia[i] = byteString.charCodeAt(i);\n    }\n\n    return createBlob(ab, mimeType);\n  };\n\n  var getMimeTypeFromBase64DataURI = function getMimeTypeFromBase64DataURI(\n    dataURI\n  ) {\n    return (/^data:(.+);/.exec(dataURI) || [])[1] || null;\n  };\n\n  var getBase64DataFromBase64DataURI = function getBase64DataFromBase64DataURI(\n    dataURI\n  ) {\n    // get data part of string (remove data:image/jpeg...,)\n    var data = dataURI.split(',')[1];\n\n    // remove any whitespace as that causes InvalidCharacterError in IE\n    return data.replace(/\\s/g, '');\n  };\n\n  var getByteStringFromBase64DataURI = function getByteStringFromBase64DataURI(\n    dataURI\n  ) {\n    return atob(getBase64DataFromBase64DataURI(dataURI));\n  };\n\n  var getBlobFromBase64DataURI = function getBlobFromBase64DataURI(dataURI) {\n    var mimeType = getMimeTypeFromBase64DataURI(dataURI);\n    var byteString = getByteStringFromBase64DataURI(dataURI);\n\n    return getBlobFromByteStringWithMimeType(byteString, mimeType);\n  };\n\n  var getFileFromBase64DataURI = function getFileFromBase64DataURI(\n    dataURI,\n    filename,\n    extension\n  ) {\n    return getFileFromBlob(\n      getBlobFromBase64DataURI(dataURI),\n      filename,\n      null,\n      extension\n    );\n  };\n\n  var getFileNameFromHeader = function getFileNameFromHeader(header) {\n    // test if is content disposition header, if not exit\n    if (!/^content-disposition:/i.test(header)) return null;\n\n    // get filename parts\n    var matches = header\n      .split(/filename=|filename\\*=.+''/)\n      .splice(1)\n      .map(function(name) {\n        return name.trim().replace(/^[\"']|[;\"']{0,2}$/g, '');\n      })\n      .filter(function(name) {\n        return name.length;\n      });\n\n    return matches.length ? decodeURI(matches[matches.length - 1]) : null;\n  };\n\n  var getFileSizeFromHeader = function getFileSizeFromHeader(header) {\n    if (/content-length:/i.test(header)) {\n      var size = header.match(/[0-9]+/)[0];\n      return size ? parseInt(size, 10) : null;\n    }\n    return null;\n  };\n\n  var getTranfserIdFromHeader = function getTranfserIdFromHeader(header) {\n    if (/x-content-transfer-id:/i.test(header)) {\n      var id = (header.split(':')[1] || '').trim();\n      return id || null;\n    }\n    return null;\n  };\n\n  var getFileInfoFromHeaders = function getFileInfoFromHeaders(headers) {\n    var info = {\n      source: null,\n      name: null,\n      size: null\n    };\n\n    var rows = headers.split('\\n');\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n    try {\n      for (\n        var _iterator = rows[Symbol.iterator](), _step;\n        !(_iteratorNormalCompletion = (_step = _iterator.next()).done);\n        _iteratorNormalCompletion = true\n      ) {\n        var header = _step.value;\n\n        var name = getFileNameFromHeader(header);\n        if (name) {\n          info.name = name;\n          continue;\n        }\n\n        var size = getFileSizeFromHeader(header);\n        if (size) {\n          info.size = size;\n          continue;\n        }\n\n        var source = getTranfserIdFromHeader(header);\n        if (source) {\n          info.source = source;\n          continue;\n        }\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return != null) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    return info;\n  };\n\n  var createFileLoader = function createFileLoader(fetchFn) {\n    var state = {\n      source: null,\n      complete: false,\n      progress: 0,\n      size: null,\n      timestamp: null,\n      duration: 0,\n      request: null\n    };\n\n    var getProgress = function getProgress() {\n      return state.progress;\n    };\n    var abort = function abort() {\n      if (state.request && state.request.abort) {\n        state.request.abort();\n      }\n    };\n\n    // load source\n    var load = function load() {\n      // get quick reference\n      var source = state.source;\n\n      api.fire('init', source);\n\n      // Load Files\n      if (source instanceof File) {\n        api.fire('load', source);\n      } else if (source instanceof Blob) {\n        // Load blobs, set default name to current date\n        api.fire('load', getFileFromBlob(source, source.name));\n      } else if (isBase64DataURI(source)) {\n        // Load base 64, set default name to current date\n        api.fire('load', getFileFromBase64DataURI(source));\n      } else {\n        // Deal as if is external URL, let's load it!\n        loadURL(source);\n      }\n    };\n\n    // loads a url\n    var loadURL = function loadURL(url) {\n      // is remote url and no fetch method supplied\n      if (!fetchFn) {\n        api.fire('error', {\n          type: 'error',\n          body: \"Can't load URL\",\n          code: 400\n        });\n\n        return;\n      }\n\n      // set request start\n      state.timestamp = Date.now();\n\n      // load file\n      state.request = fetchFn(\n        url,\n        function(response) {\n          // update duration\n          state.duration = Date.now() - state.timestamp;\n\n          // done!\n          state.complete = true;\n\n          // turn blob response into a file\n          if (response instanceof Blob) {\n            response = getFileFromBlob(\n              response,\n              response.name || getFilenameFromURL(url)\n            );\n          }\n\n          api.fire('load', response instanceof Blob ? response : response.body);\n        },\n        function(error) {\n          api.fire(\n            'error',\n            typeof error === 'string'\n              ? {\n                  type: 'error',\n                  code: 0,\n                  body: error\n                }\n              : error\n          );\n        },\n        function(computable, current, total) {\n          // collected some meta data already\n          if (total) {\n            state.size = total;\n          }\n\n          // update duration\n          state.duration = Date.now() - state.timestamp;\n\n          // if we can't compute progress, we're not going to fire progress events\n          if (!computable) {\n            state.progress = null;\n            return;\n          }\n\n          // update progress percentage\n          state.progress = current / total;\n\n          // expose\n          api.fire('progress', state.progress);\n        },\n        function() {\n          api.fire('abort');\n        },\n        function(response) {\n          var fileinfo = getFileInfoFromHeaders(\n            typeof response === 'string' ? response : response.headers\n          );\n          api.fire('meta', {\n            size: state.size || fileinfo.size,\n            filename: fileinfo.name,\n            source: fileinfo.source\n          });\n        }\n      );\n    };\n\n    var api = Object.assign({}, on(), {\n      setSource: function setSource(source) {\n        return (state.source = source);\n      },\n      getProgress: getProgress, // file load progress\n      abort: abort, // abort file load\n      load: load // start load\n    });\n\n    return api;\n  };\n\n  var isGet = function isGet(method) {\n    return /GET|HEAD/.test(method);\n  };\n\n  var sendRequest = function sendRequest(data, url, options) {\n    var api = {\n      onheaders: function onheaders() {},\n      onprogress: function onprogress() {},\n      onload: function onload() {},\n      ontimeout: function ontimeout() {},\n      onerror: function onerror() {},\n      onabort: function onabort() {},\n      abort: function abort() {\n        aborted = true;\n        xhr.abort();\n      }\n    };\n\n    // timeout identifier, only used when timeout is defined\n    var aborted = false;\n    var headersReceived = false;\n\n    // set default options\n    options = Object.assign(\n      {\n        method: 'POST',\n        headers: {},\n        withCredentials: false\n      },\n      options\n    );\n\n    // encode url\n    url = encodeURI(url);\n\n    // if method is GET, add any received data to url\n\n    if (isGet(options.method) && data) {\n      url =\n        '' +\n        url +\n        encodeURIComponent(\n          typeof data === 'string' ? data : JSON.stringify(data)\n        );\n    }\n\n    // create request\n    var xhr = new XMLHttpRequest();\n\n    // progress of load\n    var process = isGet(options.method) ? xhr : xhr.upload;\n    process.onprogress = function(e) {\n      // no progress event when aborted ( onprogress is called once after abort() )\n      if (aborted) {\n        return;\n      }\n\n      api.onprogress(e.lengthComputable, e.loaded, e.total);\n    };\n\n    // tries to get header info to the app as fast as possible\n    xhr.onreadystatechange = function() {\n      // not interesting in these states ('unsent' and 'openend' as they don't give us any additional info)\n      if (xhr.readyState < 2) {\n        return;\n      }\n\n      // no server response\n      if (xhr.readyState === 4 && xhr.status === 0) {\n        return;\n      }\n\n      if (headersReceived) {\n        return;\n      }\n\n      headersReceived = true;\n\n      // we've probably received some useful data in response headers\n      api.onheaders(xhr);\n    };\n\n    // load successful\n    xhr.onload = function() {\n      // is classified as valid response\n      if (xhr.status >= 200 && xhr.status < 300) {\n        api.onload(xhr);\n      } else {\n        api.onerror(xhr);\n      }\n    };\n\n    // error during load\n    xhr.onerror = function() {\n      return api.onerror(xhr);\n    };\n\n    // request aborted\n    xhr.onabort = function() {\n      aborted = true;\n      api.onabort();\n    };\n\n    // request timeout\n    xhr.ontimeout = function() {\n      return api.ontimeout(xhr);\n    };\n\n    // open up open up!\n    xhr.open(options.method, url, true);\n\n    // set timeout if defined (do it after open so IE11 plays ball)\n    if (isInt(options.timeout)) {\n      xhr.timeout = options.timeout;\n    }\n\n    // add headers\n    Object.keys(options.headers).forEach(function(key) {\n      var value = unescape(encodeURIComponent(options.headers[key]));\n      xhr.setRequestHeader(key, value);\n    });\n\n    // set type of response\n    if (options.responseType) {\n      xhr.responseType = options.responseType;\n    }\n\n    // set credentials\n    if (options.withCredentials) {\n      xhr.withCredentials = true;\n    }\n\n    // let's send our data\n    xhr.send(data);\n\n    return api;\n  };\n\n  var createResponse = function createResponse(type, code, body, headers) {\n    return {\n      type: type,\n      code: code,\n      body: body,\n      headers: headers\n    };\n  };\n\n  var createTimeoutResponse = function createTimeoutResponse(cb) {\n    return function(xhr) {\n      cb(createResponse('error', 0, 'Timeout', xhr.getAllResponseHeaders()));\n    };\n  };\n\n  var createFetchFunction = function createFetchFunction() {\n    var apiUrl =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function') {\n      return action;\n    }\n\n    // no action supplied\n    if (!action || !isString(action.url)) {\n      return null;\n    }\n\n    // set onload hanlder\n    var onload =\n      action.onload ||\n      function(res) {\n        return res;\n      };\n    var onerror =\n      action.onerror ||\n      function(res) {\n        return null;\n      };\n\n    // internal handler\n    return function(url, load, error, progress, abort, headers) {\n      // do local or remote request based on if the url is external\n      var request = sendRequest(\n        url,\n        apiUrl + action.url,\n        Object.assign({}, action, {\n          responseType: 'blob'\n        })\n      );\n\n      request.onload = function(xhr) {\n        // get headers\n        var headers = xhr.getAllResponseHeaders();\n\n        // get filename\n        var filename =\n          getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n        // create response\n        load(\n          createResponse(\n            'load',\n            xhr.status,\n            getFileFromBlob(onload(xhr.response), filename),\n            headers\n          )\n        );\n      };\n\n      request.onerror = function(xhr) {\n        error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.onheaders = function(xhr) {\n        headers(\n          createResponse(\n            'headers',\n            xhr.status,\n            null,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort;\n\n      // should return request\n      return request;\n    };\n  };\n\n  function _typeof(obj) {\n    if (typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol') {\n      _typeof = function(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function(obj) {\n        return obj &&\n          typeof Symbol === 'function' &&\n          obj.constructor === Symbol &&\n          obj !== Symbol.prototype\n          ? 'symbol'\n          : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  var REACT_ELEMENT_TYPE;\n\n  function _jsx(type, props, key, children) {\n    if (!REACT_ELEMENT_TYPE) {\n      REACT_ELEMENT_TYPE =\n        (typeof Symbol === 'function' &&\n          Symbol['for'] &&\n          Symbol['for']('react.element')) ||\n        0xeac7;\n    }\n\n    var defaultProps = type && type.defaultProps;\n    var childrenLength = arguments.length - 3;\n\n    if (!props && childrenLength !== 0) {\n      props = {\n        children: void 0\n      };\n    }\n\n    if (props && defaultProps) {\n      for (var propName in defaultProps) {\n        if (props[propName] === void 0) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    } else if (!props) {\n      props = defaultProps || {};\n    }\n\n    if (childrenLength === 1) {\n      props.children = children;\n    } else if (childrenLength > 1) {\n      var childArray = new Array(childrenLength);\n\n      for (var i = 0; i < childrenLength; i++) {\n        childArray[i] = arguments[i + 3];\n      }\n\n      props.children = childArray;\n    }\n\n    return {\n      $$typeof: REACT_ELEMENT_TYPE,\n      type: type,\n      key: key === undefined ? null : '' + key,\n      ref: null,\n      props: props,\n      _owner: null\n    };\n  }\n\n  function _asyncIterator(iterable) {\n    var method;\n\n    if (typeof Symbol !== 'undefined') {\n      if (Symbol.asyncIterator) {\n        method = iterable[Symbol.asyncIterator];\n        if (method != null) return method.call(iterable);\n      }\n\n      if (Symbol.iterator) {\n        method = iterable[Symbol.iterator];\n        if (method != null) return method.call(iterable);\n      }\n    }\n\n    throw new TypeError('Object is not async iterable');\n  }\n\n  function _AwaitValue(value) {\n    this.wrapped = value;\n  }\n\n  function _AsyncGenerator(gen) {\n    var front, back;\n\n    function send(key, arg) {\n      return new Promise(function(resolve, reject) {\n        var request = {\n          key: key,\n          arg: arg,\n          resolve: resolve,\n          reject: reject,\n          next: null\n        };\n\n        if (back) {\n          back = back.next = request;\n        } else {\n          front = back = request;\n          resume(key, arg);\n        }\n      });\n    }\n\n    function resume(key, arg) {\n      try {\n        var result = gen[key](arg);\n        var value = result.value;\n        var wrappedAwait = value instanceof _AwaitValue;\n        Promise.resolve(wrappedAwait ? value.wrapped : value).then(\n          function(arg) {\n            if (wrappedAwait) {\n              resume('next', arg);\n              return;\n            }\n\n            settle(result.done ? 'return' : 'normal', arg);\n          },\n          function(err) {\n            resume('throw', err);\n          }\n        );\n      } catch (err) {\n        settle('throw', err);\n      }\n    }\n\n    function settle(type, value) {\n      switch (type) {\n        case 'return':\n          front.resolve({\n            value: value,\n            done: true\n          });\n          break;\n\n        case 'throw':\n          front.reject(value);\n          break;\n\n        default:\n          front.resolve({\n            value: value,\n            done: false\n          });\n          break;\n      }\n\n      front = front.next;\n\n      if (front) {\n        resume(front.key, front.arg);\n      } else {\n        back = null;\n      }\n    }\n\n    this._invoke = send;\n\n    if (typeof gen.return !== 'function') {\n      this.return = undefined;\n    }\n  }\n\n  if (typeof Symbol === 'function' && Symbol.asyncIterator) {\n    _AsyncGenerator.prototype[Symbol.asyncIterator] = function() {\n      return this;\n    };\n  }\n\n  _AsyncGenerator.prototype.next = function(arg) {\n    return this._invoke('next', arg);\n  };\n\n  _AsyncGenerator.prototype.throw = function(arg) {\n    return this._invoke('throw', arg);\n  };\n\n  _AsyncGenerator.prototype.return = function(arg) {\n    return this._invoke('return', arg);\n  };\n\n  function _wrapAsyncGenerator(fn) {\n    return function() {\n      return new _AsyncGenerator(fn.apply(this, arguments));\n    };\n  }\n\n  function _awaitAsyncGenerator(value) {\n    return new _AwaitValue(value);\n  }\n\n  function _asyncGeneratorDelegate(inner, awaitWrap) {\n    var iter = {},\n      waiting = false;\n\n    function pump(key, value) {\n      waiting = true;\n      value = new Promise(function(resolve) {\n        resolve(inner[key](value));\n      });\n      return {\n        done: false,\n        value: awaitWrap(value)\n      };\n    }\n\n    if (typeof Symbol === 'function' && Symbol.iterator) {\n      iter[Symbol.iterator] = function() {\n        return this;\n      };\n    }\n\n    iter.next = function(value) {\n      if (waiting) {\n        waiting = false;\n        return value;\n      }\n\n      return pump('next', value);\n    };\n\n    if (typeof inner.throw === 'function') {\n      iter.throw = function(value) {\n        if (waiting) {\n          waiting = false;\n          throw value;\n        }\n\n        return pump('throw', value);\n      };\n    }\n\n    if (typeof inner.return === 'function') {\n      iter.return = function(value) {\n        return pump('return', value);\n      };\n    }\n\n    return iter;\n  }\n\n  function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n    try {\n      var info = gen[key](arg);\n      var value = info.value;\n    } catch (error) {\n      reject(error);\n      return;\n    }\n\n    if (info.done) {\n      resolve(value);\n    } else {\n      Promise.resolve(value).then(_next, _throw);\n    }\n  }\n\n  function _asyncToGenerator(fn) {\n    return function() {\n      var self = this,\n        args = arguments;\n      return new Promise(function(resolve, reject) {\n        var gen = fn.apply(self, args);\n\n        function _next(value) {\n          asyncGeneratorStep(\n            gen,\n            resolve,\n            reject,\n            _next,\n            _throw,\n            'next',\n            value\n          );\n        }\n\n        function _throw(err) {\n          asyncGeneratorStep(gen, resolve, reject, _next, _throw, 'throw', err);\n        }\n\n        _next(undefined);\n      });\n    };\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError('Cannot call a class as a function');\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if ('value' in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineEnumerableProperties(obj, descs) {\n    for (var key in descs) {\n      var desc = descs[key];\n      desc.configurable = desc.enumerable = true;\n      if ('value' in desc) desc.writable = true;\n      Object.defineProperty(obj, key, desc);\n    }\n\n    if (Object.getOwnPropertySymbols) {\n      var objectSymbols = Object.getOwnPropertySymbols(descs);\n\n      for (var i = 0; i < objectSymbols.length; i++) {\n        var sym = objectSymbols[i];\n        var desc = descs[sym];\n        desc.configurable = desc.enumerable = true;\n        if ('value' in desc) desc.writable = true;\n        Object.defineProperty(obj, sym, desc);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defaults(obj, defaults) {\n    var keys = Object.getOwnPropertyNames(defaults);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n      var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n      if (value && value.configurable && obj[key] === undefined) {\n        Object.defineProperty(obj, key, value);\n      }\n    }\n\n    return obj;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function _extends() {\n    _extends =\n      Object.assign ||\n      function(target) {\n        for (var i = 1; i < arguments.length; i++) {\n          var source = arguments[i];\n\n          for (var key in source) {\n            if (Object.prototype.hasOwnProperty.call(source, key)) {\n              target[key] = source[key];\n            }\n          }\n        }\n\n        return target;\n      };\n\n    return _extends.apply(this, arguments);\n  }\n\n  function _objectSpread(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n      var ownKeys = Object.keys(source);\n\n      if (typeof Object.getOwnPropertySymbols === 'function') {\n        ownKeys = ownKeys.concat(\n          Object.getOwnPropertySymbols(source).filter(function(sym) {\n            return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n          })\n        );\n      }\n\n      ownKeys.forEach(function(key) {\n        _defineProperty(target, key, source[key]);\n      });\n    }\n\n    return target;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly)\n        symbols = symbols.filter(function(sym) {\n          return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n        });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(source, true).forEach(function(key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(\n          target,\n          Object.getOwnPropertyDescriptors(source)\n        );\n      } else {\n        ownKeys(source).forEach(function(key) {\n          Object.defineProperty(\n            target,\n            key,\n            Object.getOwnPropertyDescriptor(source, key)\n          );\n        });\n      }\n    }\n\n    return target;\n  }\n\n  function _inherits(subClass, superClass) {\n    if (typeof superClass !== 'function' && superClass !== null) {\n      throw new TypeError('Super expression must either be null or a function');\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) _setPrototypeOf(subClass, superClass);\n  }\n\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _getPrototypeOf(o) {\n    _getPrototypeOf = Object.setPrototypeOf\n      ? Object.getPrototypeOf\n      : function _getPrototypeOf(o) {\n          return o.__proto__ || Object.getPrototypeOf(o);\n        };\n    return _getPrototypeOf(o);\n  }\n\n  function _setPrototypeOf(o, p) {\n    _setPrototypeOf =\n      Object.setPrototypeOf ||\n      function _setPrototypeOf(o, p) {\n        o.__proto__ = p;\n        return o;\n      };\n\n    return _setPrototypeOf(o, p);\n  }\n\n  function isNativeReflectConstruct() {\n    if (typeof Reflect === 'undefined' || !Reflect.construct) return false;\n    if (Reflect.construct.sham) return false;\n    if (typeof Proxy === 'function') return true;\n\n    try {\n      Date.prototype.toString.call(Reflect.construct(Date, [], function() {}));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  function _construct(Parent, args, Class) {\n    if (isNativeReflectConstruct()) {\n      _construct = Reflect.construct;\n    } else {\n      _construct = function _construct(Parent, args, Class) {\n        var a = [null];\n        a.push.apply(a, args);\n        var Constructor = Function.bind.apply(Parent, a);\n        var instance = new Constructor();\n        if (Class) _setPrototypeOf(instance, Class.prototype);\n        return instance;\n      };\n    }\n\n    return _construct.apply(null, arguments);\n  }\n\n  function _isNativeFunction(fn) {\n    return Function.toString.call(fn).indexOf('[native code]') !== -1;\n  }\n\n  function _wrapNativeSuper(Class) {\n    var _cache = typeof Map === 'function' ? new Map() : undefined;\n\n    _wrapNativeSuper = function _wrapNativeSuper(Class) {\n      if (Class === null || !_isNativeFunction(Class)) return Class;\n\n      if (typeof Class !== 'function') {\n        throw new TypeError(\n          'Super expression must either be null or a function'\n        );\n      }\n\n      if (typeof _cache !== 'undefined') {\n        if (_cache.has(Class)) return _cache.get(Class);\n\n        _cache.set(Class, Wrapper);\n      }\n\n      function Wrapper() {\n        return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n      }\n\n      Wrapper.prototype = Object.create(Class.prototype, {\n        constructor: {\n          value: Wrapper,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      });\n      return _setPrototypeOf(Wrapper, Class);\n    };\n\n    return _wrapNativeSuper(Class);\n  }\n\n  function _instanceof(left, right) {\n    if (\n      right != null &&\n      typeof Symbol !== 'undefined' &&\n      right[Symbol.hasInstance]\n    ) {\n      return !!right[Symbol.hasInstance](left);\n    } else {\n      return left instanceof right;\n    }\n  }\n\n  function _interopRequireDefault(obj) {\n    return obj && obj.__esModule\n      ? obj\n      : {\n          default: obj\n        };\n  }\n\n  function _interopRequireWildcard(obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc =\n              Object.defineProperty && Object.getOwnPropertyDescriptor\n                ? Object.getOwnPropertyDescriptor(obj, key)\n                : {};\n\n            if (desc.get || desc.set) {\n              Object.defineProperty(newObj, key, desc);\n            } else {\n              newObj[key] = obj[key];\n            }\n          }\n        }\n      }\n\n      newObj.default = obj;\n      return newObj;\n    }\n  }\n\n  function _newArrowCheck(innerThis, boundThis) {\n    if (innerThis !== boundThis) {\n      throw new TypeError('Cannot instantiate an arrow function');\n    }\n  }\n\n  function _objectDestructuringEmpty(obj) {\n    if (obj == null) throw new TypeError('Cannot destructure undefined');\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\n        \"this hasn't been initialised - super() hasn't been called\"\n      );\n    }\n\n    return self;\n  }\n\n  function _possibleConstructorReturn(self, call) {\n    if (call && (typeof call === 'object' || typeof call === 'function')) {\n      return call;\n    }\n\n    return _assertThisInitialized(self);\n  }\n\n  function _superPropBase(object, property) {\n    while (!Object.prototype.hasOwnProperty.call(object, property)) {\n      object = _getPrototypeOf(object);\n      if (object === null) break;\n    }\n\n    return object;\n  }\n\n  function _get(target, property, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.get) {\n      _get = Reflect.get;\n    } else {\n      _get = function _get(target, property, receiver) {\n        var base = _superPropBase(target, property);\n\n        if (!base) return;\n        var desc = Object.getOwnPropertyDescriptor(base, property);\n\n        if (desc.get) {\n          return desc.get.call(receiver);\n        }\n\n        return desc.value;\n      };\n    }\n\n    return _get(target, property, receiver || target);\n  }\n\n  function set(target, property, value, receiver) {\n    if (typeof Reflect !== 'undefined' && Reflect.set) {\n      set = Reflect.set;\n    } else {\n      set = function set(target, property, value, receiver) {\n        var base = _superPropBase(target, property);\n\n        var desc;\n\n        if (base) {\n          desc = Object.getOwnPropertyDescriptor(base, property);\n\n          if (desc.set) {\n            desc.set.call(receiver, value);\n            return true;\n          } else if (!desc.writable) {\n            return false;\n          }\n        }\n\n        desc = Object.getOwnPropertyDescriptor(receiver, property);\n\n        if (desc) {\n          if (!desc.writable) {\n            return false;\n          }\n\n          desc.value = value;\n          Object.defineProperty(receiver, property, desc);\n        } else {\n          _defineProperty(receiver, property, value);\n        }\n\n        return true;\n      };\n    }\n\n    return set(target, property, value, receiver);\n  }\n\n  function _set(target, property, value, receiver, isStrict) {\n    var s = set(target, property, value, receiver || target);\n\n    if (!s && isStrict) {\n      throw new Error('failed to set property');\n    }\n\n    return value;\n  }\n\n  function _taggedTemplateLiteral(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    return Object.freeze(\n      Object.defineProperties(strings, {\n        raw: {\n          value: Object.freeze(raw)\n        }\n      })\n    );\n  }\n\n  function _taggedTemplateLiteralLoose(strings, raw) {\n    if (!raw) {\n      raw = strings.slice(0);\n    }\n\n    strings.raw = raw;\n    return strings;\n  }\n\n  function _temporalRef(val, name) {\n    if (val === _temporalUndefined) {\n      throw new ReferenceError(name + ' is not defined - temporal dead zone');\n    } else {\n      return val;\n    }\n  }\n\n  function _readOnlyError(name) {\n    throw new Error('\"' + name + '\" is read-only');\n  }\n\n  function _classNameTDZError(name) {\n    throw new Error(\n      'Class \"' + name + '\" cannot be referenced in computed property keys.'\n    );\n  }\n\n  var _temporalUndefined = {};\n\n  function _slicedToArray(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimit(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _slicedToArrayLoose(arr, i) {\n    return (\n      _arrayWithHoles(arr) ||\n      _iterableToArrayLimitLoose(arr, i) ||\n      _nonIterableRest()\n    );\n  }\n\n  function _toArray(arr) {\n    return _arrayWithHoles(arr) || _iterableToArray(arr) || _nonIterableRest();\n  }\n\n  function _toConsumableArray(arr) {\n    return (\n      _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread()\n    );\n  }\n\n  function _arrayWithoutHoles(arr) {\n    if (Array.isArray(arr)) {\n      for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++)\n        arr2[i] = arr[i];\n\n      return arr2;\n    }\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArray(iter) {\n    if (\n      Symbol.iterator in Object(iter) ||\n      Object.prototype.toString.call(iter) === '[object Arguments]'\n    )\n      return Array.from(iter);\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (\n        var _i = arr[Symbol.iterator](), _s;\n        !(_n = (_s = _i.next()).done);\n        _n = true\n      ) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i['return'] != null) _i['return']();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _iterableToArrayLimitLoose(arr, i) {\n    var _arr = [];\n\n    for (\n      var _iterator = arr[Symbol.iterator](), _step;\n      !(_step = _iterator.next()).done;\n\n    ) {\n      _arr.push(_step.value);\n\n      if (i && _arr.length === i) break;\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableSpread() {\n    throw new TypeError('Invalid attempt to spread non-iterable instance');\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError('Invalid attempt to destructure non-iterable instance');\n  }\n\n  function _skipFirstGeneratorNext(fn) {\n    return function() {\n      var it = fn.apply(this, arguments);\n      it.next();\n      return it;\n    };\n  }\n\n  function _toPrimitive(input, hint) {\n    if (typeof input !== 'object' || input === null) return input;\n    var prim = input[Symbol.toPrimitive];\n\n    if (prim !== undefined) {\n      var res = prim.call(input, hint || 'default');\n      if (typeof res !== 'object') return res;\n      throw new TypeError('@@toPrimitive must return a primitive value.');\n    }\n\n    return (hint === 'string' ? String : Number)(input);\n  }\n\n  function _toPropertyKey(arg) {\n    var key = _toPrimitive(arg, 'string');\n\n    return typeof key === 'symbol' ? key : String(key);\n  }\n\n  function _initializerWarningHelper(descriptor, context) {\n    throw new Error(\n      'Decorating class property failed. Please ensure that ' +\n        'proposal-class-properties is enabled and set to use loose mode. ' +\n        'To use proposal-class-properties in spec mode with decorators, wait for ' +\n        'the next major version of decorators in stage 2.'\n    );\n  }\n\n  function _initializerDefineProperty(target, property, descriptor, context) {\n    if (!descriptor) return;\n    Object.defineProperty(target, property, {\n      enumerable: descriptor.enumerable,\n      configurable: descriptor.configurable,\n      writable: descriptor.writable,\n      value: descriptor.initializer\n        ? descriptor.initializer.call(context)\n        : void 0\n    });\n  }\n\n  function _applyDecoratedDescriptor(\n    target,\n    property,\n    decorators,\n    descriptor,\n    context\n  ) {\n    var desc = {};\n    Object.keys(descriptor).forEach(function(key) {\n      desc[key] = descriptor[key];\n    });\n    desc.enumerable = !!desc.enumerable;\n    desc.configurable = !!desc.configurable;\n\n    if ('value' in desc || desc.initializer) {\n      desc.writable = true;\n    }\n\n    desc = decorators\n      .slice()\n      .reverse()\n      .reduce(function(desc, decorator) {\n        return decorator(target, property, desc) || desc;\n      }, desc);\n\n    if (context && desc.initializer !== void 0) {\n      desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n      desc.initializer = undefined;\n    }\n\n    if (desc.initializer === void 0) {\n      Object.defineProperty(target, property, desc);\n      desc = null;\n    }\n\n    return desc;\n  }\n\n  var id = 0;\n\n  function _classPrivateFieldLooseKey(name) {\n    return '__private_' + id++ + '_' + name;\n  }\n\n  function _classPrivateFieldLooseBase(receiver, privateKey) {\n    if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n      throw new TypeError('attempted to use private field on non-instance');\n    }\n\n    return receiver;\n  }\n\n  function _classPrivateFieldGet(receiver, privateMap) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    if (descriptor.get) {\n      return descriptor.get.call(receiver);\n    }\n\n    return descriptor.value;\n  }\n\n  function _classPrivateFieldSet(receiver, privateMap, value) {\n    var descriptor = privateMap.get(receiver);\n\n    if (!descriptor) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    if (descriptor.set) {\n      descriptor.set.call(receiver, value);\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      descriptor.value = value;\n    }\n\n    return value;\n  }\n\n  function _classPrivateFieldDestructureSet(receiver, privateMap) {\n    if (!privateMap.has(receiver)) {\n      throw new TypeError('attempted to set private field on non-instance');\n    }\n\n    var descriptor = privateMap.get(receiver);\n\n    if (descriptor.set) {\n      if (!('__destrObj' in descriptor)) {\n        descriptor.__destrObj = {\n          set value(v) {\n            descriptor.set.call(receiver, v);\n          }\n        };\n      }\n\n      return descriptor.__destrObj;\n    } else {\n      if (!descriptor.writable) {\n        throw new TypeError('attempted to set read only private field');\n      }\n\n      return descriptor;\n    }\n  }\n\n  function _classStaticPrivateFieldSpecGet(\n    receiver,\n    classConstructor,\n    descriptor\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return descriptor.value;\n  }\n\n  function _classStaticPrivateFieldSpecSet(\n    receiver,\n    classConstructor,\n    descriptor,\n    value\n  ) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    if (!descriptor.writable) {\n      throw new TypeError('attempted to set read only private field');\n    }\n\n    descriptor.value = value;\n    return value;\n  }\n\n  function _classStaticPrivateMethodGet(receiver, classConstructor, method) {\n    if (receiver !== classConstructor) {\n      throw new TypeError('Private static access of wrong provenance');\n    }\n\n    return method;\n  }\n\n  function _classStaticPrivateMethodSet() {\n    throw new TypeError('attempted to set read only static private field');\n  }\n\n  function _decorate(decorators, factory, superClass, mixins) {\n    var api = _getDecoratorsApi();\n\n    if (mixins) {\n      for (var i = 0; i < mixins.length; i++) {\n        api = mixins[i](api);\n      }\n    }\n\n    var r = factory(function initialize(O) {\n      api.initializeInstanceElements(O, decorated.elements);\n    }, superClass);\n    var decorated = api.decorateClass(\n      _coalesceClassElements(r.d.map(_createElementDescriptor)),\n      decorators\n    );\n    api.initializeClassElements(r.F, decorated.elements);\n    return api.runClassFinishers(r.F, decorated.finishers);\n  }\n\n  function _getDecoratorsApi() {\n    _getDecoratorsApi = function() {\n      return api;\n    };\n\n    var api = {\n      elementsDefinitionOrder: [['method'], ['field']],\n      initializeInstanceElements: function(O, elements) {\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            if (element.kind === kind && element.placement === 'own') {\n              this.defineClassElement(O, element);\n            }\n          }, this);\n        }, this);\n      },\n      initializeClassElements: function(F, elements) {\n        var proto = F.prototype;\n        ['method', 'field'].forEach(function(kind) {\n          elements.forEach(function(element) {\n            var placement = element.placement;\n\n            if (\n              element.kind === kind &&\n              (placement === 'static' || placement === 'prototype')\n            ) {\n              var receiver = placement === 'static' ? F : proto;\n              this.defineClassElement(receiver, element);\n            }\n          }, this);\n        }, this);\n      },\n      defineClassElement: function(receiver, element) {\n        var descriptor = element.descriptor;\n\n        if (element.kind === 'field') {\n          var initializer = element.initializer;\n          descriptor = {\n            enumerable: descriptor.enumerable,\n            writable: descriptor.writable,\n            configurable: descriptor.configurable,\n            value: initializer === void 0 ? void 0 : initializer.call(receiver)\n          };\n        }\n\n        Object.defineProperty(receiver, element.key, descriptor);\n      },\n      decorateClass: function(elements, decorators) {\n        var newElements = [];\n        var finishers = [];\n        var placements = {\n          static: [],\n          prototype: [],\n          own: []\n        };\n        elements.forEach(function(element) {\n          this.addElementPlacement(element, placements);\n        }, this);\n        elements.forEach(function(element) {\n          if (!_hasDecorators(element)) return newElements.push(element);\n          var elementFinishersExtras = this.decorateElement(\n            element,\n            placements\n          );\n          newElements.push(elementFinishersExtras.element);\n          newElements.push.apply(newElements, elementFinishersExtras.extras);\n          finishers.push.apply(finishers, elementFinishersExtras.finishers);\n        }, this);\n\n        if (!decorators) {\n          return {\n            elements: newElements,\n            finishers: finishers\n          };\n        }\n\n        var result = this.decorateConstructor(newElements, decorators);\n        finishers.push.apply(finishers, result.finishers);\n        result.finishers = finishers;\n        return result;\n      },\n      addElementPlacement: function(element, placements, silent) {\n        var keys = placements[element.placement];\n\n        if (!silent && keys.indexOf(element.key) !== -1) {\n          throw new TypeError('Duplicated element (' + element.key + ')');\n        }\n\n        keys.push(element.key);\n      },\n      decorateElement: function(element, placements) {\n        var extras = [];\n        var finishers = [];\n\n        for (\n          var decorators = element.decorators, i = decorators.length - 1;\n          i >= 0;\n          i--\n        ) {\n          var keys = placements[element.placement];\n          keys.splice(keys.indexOf(element.key), 1);\n          var elementObject = this.fromElementDescriptor(element);\n          var elementFinisherExtras = this.toElementFinisherExtras(\n            (0, decorators[i])(elementObject) || elementObject\n          );\n          element = elementFinisherExtras.element;\n          this.addElementPlacement(element, placements);\n\n          if (elementFinisherExtras.finisher) {\n            finishers.push(elementFinisherExtras.finisher);\n          }\n\n          var newExtras = elementFinisherExtras.extras;\n\n          if (newExtras) {\n            for (var j = 0; j < newExtras.length; j++) {\n              this.addElementPlacement(newExtras[j], placements);\n            }\n\n            extras.push.apply(extras, newExtras);\n          }\n        }\n\n        return {\n          element: element,\n          finishers: finishers,\n          extras: extras\n        };\n      },\n      decorateConstructor: function(elements, decorators) {\n        var finishers = [];\n\n        for (var i = decorators.length - 1; i >= 0; i--) {\n          var obj = this.fromClassDescriptor(elements);\n          var elementsAndFinisher = this.toClassDescriptor(\n            (0, decorators[i])(obj) || obj\n          );\n\n          if (elementsAndFinisher.finisher !== undefined) {\n            finishers.push(elementsAndFinisher.finisher);\n          }\n\n          if (elementsAndFinisher.elements !== undefined) {\n            elements = elementsAndFinisher.elements;\n\n            for (var j = 0; j < elements.length - 1; j++) {\n              for (var k = j + 1; k < elements.length; k++) {\n                if (\n                  elements[j].key === elements[k].key &&\n                  elements[j].placement === elements[k].placement\n                ) {\n                  throw new TypeError(\n                    'Duplicated element (' + elements[j].key + ')'\n                  );\n                }\n              }\n            }\n          }\n        }\n\n        return {\n          elements: elements,\n          finishers: finishers\n        };\n      },\n      fromElementDescriptor: function(element) {\n        var obj = {\n          kind: element.kind,\n          key: element.key,\n          placement: element.placement,\n          descriptor: element.descriptor\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        if (element.kind === 'field') obj.initializer = element.initializer;\n        return obj;\n      },\n      toElementDescriptors: function(elementObjects) {\n        if (elementObjects === undefined) return;\n        return _toArray(elementObjects).map(function(elementObject) {\n          var element = this.toElementDescriptor(elementObject);\n          this.disallowProperty(\n            elementObject,\n            'finisher',\n            'An element descriptor'\n          );\n          this.disallowProperty(\n            elementObject,\n            'extras',\n            'An element descriptor'\n          );\n          return element;\n        }, this);\n      },\n      toElementDescriptor: function(elementObject) {\n        var kind = String(elementObject.kind);\n\n        if (kind !== 'method' && kind !== 'field') {\n          throw new TypeError(\n            'An element descriptor\\'s .kind property must be either \"method\" or' +\n              ' \"field\", but a decorator created an element descriptor with' +\n              ' .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        var key = _toPropertyKey(elementObject.key);\n\n        var placement = String(elementObject.placement);\n\n        if (\n          placement !== 'static' &&\n          placement !== 'prototype' &&\n          placement !== 'own'\n        ) {\n          throw new TypeError(\n            'An element descriptor\\'s .placement property must be one of \"static\",' +\n              ' \"prototype\" or \"own\", but a decorator created an element descriptor' +\n              ' with .placement \"' +\n              placement +\n              '\"'\n          );\n        }\n\n        var descriptor = elementObject.descriptor;\n        this.disallowProperty(\n          elementObject,\n          'elements',\n          'An element descriptor'\n        );\n        var element = {\n          kind: kind,\n          key: key,\n          placement: placement,\n          descriptor: Object.assign({}, descriptor)\n        };\n\n        if (kind !== 'field') {\n          this.disallowProperty(\n            elementObject,\n            'initializer',\n            'A method descriptor'\n          );\n        } else {\n          this.disallowProperty(\n            descriptor,\n            'get',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'set',\n            'The property descriptor of a field descriptor'\n          );\n          this.disallowProperty(\n            descriptor,\n            'value',\n            'The property descriptor of a field descriptor'\n          );\n          element.initializer = elementObject.initializer;\n        }\n\n        return element;\n      },\n      toElementFinisherExtras: function(elementObject) {\n        var element = this.toElementDescriptor(elementObject);\n\n        var finisher = _optionalCallableProperty(elementObject, 'finisher');\n\n        var extras = this.toElementDescriptors(elementObject.extras);\n        return {\n          element: element,\n          finisher: finisher,\n          extras: extras\n        };\n      },\n      fromClassDescriptor: function(elements) {\n        var obj = {\n          kind: 'class',\n          elements: elements.map(this.fromElementDescriptor, this)\n        };\n        var desc = {\n          value: 'Descriptor',\n          configurable: true\n        };\n        Object.defineProperty(obj, Symbol.toStringTag, desc);\n        return obj;\n      },\n      toClassDescriptor: function(obj) {\n        var kind = String(obj.kind);\n\n        if (kind !== 'class') {\n          throw new TypeError(\n            'A class descriptor\\'s .kind property must be \"class\", but a decorator' +\n              ' created a class descriptor with .kind \"' +\n              kind +\n              '\"'\n          );\n        }\n\n        this.disallowProperty(obj, 'key', 'A class descriptor');\n        this.disallowProperty(obj, 'placement', 'A class descriptor');\n        this.disallowProperty(obj, 'descriptor', 'A class descriptor');\n        this.disallowProperty(obj, 'initializer', 'A class descriptor');\n        this.disallowProperty(obj, 'extras', 'A class descriptor');\n\n        var finisher = _optionalCallableProperty(obj, 'finisher');\n\n        var elements = this.toElementDescriptors(obj.elements);\n        return {\n          elements: elements,\n          finisher: finisher\n        };\n      },\n      runClassFinishers: function(constructor, finishers) {\n        for (var i = 0; i < finishers.length; i++) {\n          var newConstructor = (0, finishers[i])(constructor);\n\n          if (newConstructor !== undefined) {\n            if (typeof newConstructor !== 'function') {\n              throw new TypeError('Finishers must return a constructor.');\n            }\n\n            constructor = newConstructor;\n          }\n        }\n\n        return constructor;\n      },\n      disallowProperty: function(obj, name, objectType) {\n        if (obj[name] !== undefined) {\n          throw new TypeError(\n            objectType + \" can't have a .\" + name + ' property.'\n          );\n        }\n      }\n    };\n    return api;\n  }\n\n  function _createElementDescriptor(def) {\n    var key = _toPropertyKey(def.key);\n\n    var descriptor;\n\n    if (def.kind === 'method') {\n      descriptor = {\n        value: def.value,\n        writable: true,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'get') {\n      descriptor = {\n        get: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'set') {\n      descriptor = {\n        set: def.value,\n        configurable: true,\n        enumerable: false\n      };\n    } else if (def.kind === 'field') {\n      descriptor = {\n        configurable: true,\n        writable: true,\n        enumerable: true\n      };\n    }\n\n    var element = {\n      kind: def.kind === 'field' ? 'field' : 'method',\n      key: key,\n      placement: def.static\n        ? 'static'\n        : def.kind === 'field'\n        ? 'own'\n        : 'prototype',\n      descriptor: descriptor\n    };\n    if (def.decorators) element.decorators = def.decorators;\n    if (def.kind === 'field') element.initializer = def.value;\n    return element;\n  }\n\n  function _coalesceGetterSetter(element, other) {\n    if (element.descriptor.get !== undefined) {\n      other.descriptor.get = element.descriptor.get;\n    } else {\n      other.descriptor.set = element.descriptor.set;\n    }\n  }\n\n  function _coalesceClassElements(elements) {\n    var newElements = [];\n\n    var isSameElement = function(other) {\n      return (\n        other.kind === 'method' &&\n        other.key === element.key &&\n        other.placement === element.placement\n      );\n    };\n\n    for (var i = 0; i < elements.length; i++) {\n      var element = elements[i];\n      var other;\n\n      if (\n        element.kind === 'method' &&\n        (other = newElements.find(isSameElement))\n      ) {\n        if (\n          _isDataDescriptor(element.descriptor) ||\n          _isDataDescriptor(other.descriptor)\n        ) {\n          if (_hasDecorators(element) || _hasDecorators(other)) {\n            throw new ReferenceError(\n              'Duplicated methods (' + element.key + \") can't be decorated.\"\n            );\n          }\n\n          other.descriptor = element.descriptor;\n        } else {\n          if (_hasDecorators(element)) {\n            if (_hasDecorators(other)) {\n              throw new ReferenceError(\n                \"Decorators can't be placed on different accessors with for \" +\n                  'the same property (' +\n                  element.key +\n                  ').'\n              );\n            }\n\n            other.decorators = element.decorators;\n          }\n\n          _coalesceGetterSetter(element, other);\n        }\n      } else {\n        newElements.push(element);\n      }\n    }\n\n    return newElements;\n  }\n\n  function _hasDecorators(element) {\n    return element.decorators && element.decorators.length;\n  }\n\n  function _isDataDescriptor(desc) {\n    return (\n      desc !== undefined &&\n      !(desc.value === undefined && desc.writable === undefined)\n    );\n  }\n\n  function _optionalCallableProperty(obj, name) {\n    var value = obj[name];\n\n    if (value !== undefined && typeof value !== 'function') {\n      throw new TypeError(\"Expected '\" + name + \"' to be a function\");\n    }\n\n    return value;\n  }\n\n  function _classPrivateMethodGet(receiver, privateSet, fn) {\n    if (!privateSet.has(receiver)) {\n      throw new TypeError('attempted to get private field on non-instance');\n    }\n\n    return fn;\n  }\n\n  function _classPrivateMethodSet() {\n    throw new TypeError('attempted to reassign private method');\n  }\n\n  function _wrapRegExp(re, groups) {\n    _wrapRegExp = function(re, groups) {\n      return new BabelRegExp(re, groups);\n    };\n\n    var _RegExp = _wrapNativeSuper(RegExp);\n\n    var _super = RegExp.prototype;\n\n    var _groups = new WeakMap();\n\n    function BabelRegExp(re, groups) {\n      var _this = _RegExp.call(this, re);\n\n      _groups.set(_this, groups);\n\n      return _this;\n    }\n\n    _inherits(BabelRegExp, _RegExp);\n\n    BabelRegExp.prototype.exec = function(str) {\n      var result = _super.exec.call(this, str);\n\n      if (result) result.groups = buildGroups(result, this);\n      return result;\n    };\n\n    BabelRegExp.prototype[Symbol.replace] = function(str, substitution) {\n      if (typeof substitution === 'string') {\n        var groups = _groups.get(this);\n\n        return _super[Symbol.replace].call(\n          this,\n          str,\n          substitution.replace(/\\$<([^>]+)>/g, function(_, name) {\n            return '$' + groups[name];\n          })\n        );\n      } else if (typeof substitution === 'function') {\n        var _this = this;\n\n        return _super[Symbol.replace].call(this, str, function() {\n          var args = [];\n          args.push.apply(args, arguments);\n\n          if (typeof args[args.length - 1] !== 'object') {\n            args.push(buildGroups(args, _this));\n          }\n\n          return substitution.apply(this, args);\n        });\n      } else {\n        return _super[Symbol.replace].call(this, str, substitution);\n      }\n    };\n\n    function buildGroups(result, re) {\n      var g = _groups.get(re);\n\n      return Object.keys(g).reduce(function(groups, name) {\n        groups[name] = result[g[name]];\n        return groups;\n      }, Object.create(null));\n    }\n\n    return _wrapRegExp.apply(this, arguments);\n  }\n\n  var ChunkStatus = {\n    QUEUED: 0,\n    COMPLETE: 1,\n    PROCESSING: 2,\n    ERROR: 3,\n    WAITING: 4\n  };\n\n  /*\n                                                       function signature:\n                                                         (file, metadata, load, error, progress, abort, transfer, options) => {\n                                                           return {\n                                                           abort:() => {}\n                                                         }\n                                                       }\n                                                       */\n\n  // apiUrl, action, name, file, metadata, load, error, progress, abort, transfer, options\n  var processFileChunked = function processFileChunked(\n    apiUrl,\n    action,\n    name,\n    file,\n    metadata,\n    load,\n    error,\n    progress,\n    abort,\n    transfer,\n    options\n  ) {\n    // all chunks\n    var chunks = [];\n    var chunkTransferId = options.chunkTransferId,\n      chunkServer = options.chunkServer,\n      chunkSize = options.chunkSize,\n      chunkRetryDelays = options.chunkRetryDelays;\n\n    // default state\n    var state = {\n      serverId: chunkTransferId,\n      aborted: false\n    };\n\n    // set onload handlers\n    var ondata =\n      action.ondata ||\n      function(fd) {\n        return fd;\n      };\n    var onload =\n      action.onload ||\n      function(xhr, method) {\n        return method === 'HEAD'\n          ? xhr.getResponseHeader('Upload-Offset')\n          : xhr.response;\n      };\n    var onerror =\n      action.onerror ||\n      function(res) {\n        return null;\n      };\n\n    // create server hook\n    var requestTransferId = function requestTransferId(cb) {\n      var formData = new FormData();\n\n      // add metadata under same name\n      if (isObject(metadata)) formData.append(name, JSON.stringify(metadata));\n\n      var headers =\n        typeof action.headers === 'function'\n          ? action.headers(file, metadata)\n          : Object.assign({}, action.headers, {\n              'Upload-Length': file.size\n            });\n\n      var requestParams = Object.assign({}, action, {\n        headers: headers\n      });\n\n      // send request object\n      var request = sendRequest(\n        ondata(formData),\n        apiUrl + action.url,\n        requestParams\n      );\n\n      request.onload = function(xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function(xhr) {\n        return error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    };\n\n    var requestTransferOffset = function requestTransferOffset(cb) {\n      var requestUrl = apiUrl + chunkServer.url + state.serverId;\n\n      var headers =\n        typeof action.headers === 'function'\n          ? action.headers(state.serverId)\n          : Object.assign({}, action.headers);\n\n      var requestParams = {\n        headers: headers,\n        method: 'HEAD'\n      };\n\n      var request = sendRequest(null, requestUrl, requestParams);\n\n      request.onload = function(xhr) {\n        return cb(onload(xhr, requestParams.method));\n      };\n\n      request.onerror = function(xhr) {\n        return error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n    };\n\n    // create chunks\n    var lastChunkIndex = Math.floor(file.size / chunkSize);\n    for (var i = 0; i <= lastChunkIndex; i++) {\n      var offset = i * chunkSize;\n      var data = file.slice(\n        offset,\n        offset + chunkSize,\n        'application/offset+octet-stream'\n      );\n      chunks[i] = {\n        index: i,\n        size: data.size,\n        offset: offset,\n        data: data,\n        file: file,\n        progress: 0,\n        retries: _toConsumableArray(chunkRetryDelays),\n        status: ChunkStatus.QUEUED,\n        error: null,\n        request: null,\n        timeout: null\n      };\n    }\n\n    var completeProcessingChunks = function completeProcessingChunks() {\n      return load(state.serverId);\n    };\n\n    var canProcessChunk = function canProcessChunk(chunk) {\n      return (\n        chunk.status === ChunkStatus.QUEUED ||\n        chunk.status === ChunkStatus.ERROR\n      );\n    };\n\n    var processChunk = function processChunk(chunk) {\n      // processing is paused, wait here\n      if (state.aborted) return;\n\n      // get next chunk to process\n      chunk = chunk || chunks.find(canProcessChunk);\n\n      // no more chunks to process\n      if (!chunk) {\n        // all done?\n        if (\n          chunks.every(function(chunk) {\n            return chunk.status === ChunkStatus.COMPLETE;\n          })\n        ) {\n          completeProcessingChunks();\n        }\n\n        // no chunk to handle\n        return;\n      }\n\n      // now processing this chunk\n      chunk.status = ChunkStatus.PROCESSING;\n      chunk.progress = null;\n\n      // allow parsing of formdata\n      var ondata =\n        chunkServer.ondata ||\n        function(fd) {\n          return fd;\n        };\n      var onerror =\n        chunkServer.onerror ||\n        function(res) {\n          return null;\n        };\n\n      // send request object\n      var requestUrl = apiUrl + chunkServer.url + state.serverId;\n\n      var headers =\n        typeof chunkServer.headers === 'function'\n          ? chunkServer.headers(chunk)\n          : Object.assign({}, chunkServer.headers, {\n              'Content-Type': 'application/offset+octet-stream',\n              'Upload-Offset': chunk.offset,\n              'Upload-Length': file.size,\n              'Upload-Name': file.name\n            });\n\n      var request = (chunk.request = sendRequest(\n        ondata(chunk.data),\n        requestUrl,\n        Object.assign({}, chunkServer, {\n          headers: headers\n        })\n      ));\n\n      request.onload = function() {\n        // done!\n        chunk.status = ChunkStatus.COMPLETE;\n\n        // remove request reference\n        chunk.request = null;\n\n        // start processing more chunks\n        processChunks();\n      };\n\n      request.onprogress = function(lengthComputable, loaded, total) {\n        chunk.progress = lengthComputable ? loaded : null;\n        updateTotalProgress();\n      };\n\n      request.onerror = function(xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n        chunk.error = onerror(xhr.response) || xhr.statusText;\n        if (!retryProcessChunk(chunk)) {\n          error(\n            createResponse(\n              'error',\n              xhr.status,\n              onerror(xhr.response) || xhr.statusText,\n              xhr.getAllResponseHeaders()\n            )\n          );\n        }\n      };\n\n      request.ontimeout = function(xhr) {\n        chunk.status = ChunkStatus.ERROR;\n        chunk.request = null;\n        if (!retryProcessChunk(chunk)) {\n          createTimeoutResponse(error)(xhr);\n        }\n      };\n\n      request.onabort = function() {\n        chunk.status = ChunkStatus.QUEUED;\n        chunk.request = null;\n        abort();\n      };\n    };\n\n    var retryProcessChunk = function retryProcessChunk(chunk) {\n      // no more retries left\n      if (chunk.retries.length === 0) return false;\n\n      // new retry\n      chunk.status = ChunkStatus.WAITING;\n      clearTimeout(chunk.timeout);\n      chunk.timeout = setTimeout(function() {\n        processChunk(chunk);\n      }, chunk.retries.shift());\n\n      // we're going to retry\n      return true;\n    };\n\n    var updateTotalProgress = function updateTotalProgress() {\n      // calculate total progress fraction\n      var totalBytesTransfered = chunks.reduce(function(p, chunk) {\n        if (p === null || chunk.progress === null) return null;\n        return p + chunk.progress;\n      }, 0);\n\n      // can't compute progress\n      if (totalBytesTransfered === null) return progress(false, 0, 0);\n\n      // calculate progress values\n      var totalSize = chunks.reduce(function(total, chunk) {\n        return total + chunk.size;\n      }, 0);\n\n      // can update progress indicator\n      progress(true, totalBytesTransfered, totalSize);\n    };\n\n    // process new chunks\n    var processChunks = function processChunks() {\n      var totalProcessing = chunks.filter(function(chunk) {\n        return chunk.status === ChunkStatus.PROCESSING;\n      }).length;\n      if (totalProcessing >= 1) return;\n      processChunk();\n    };\n\n    var abortChunks = function abortChunks() {\n      chunks.forEach(function(chunk) {\n        clearTimeout(chunk.timeout);\n        if (chunk.request) {\n          chunk.request.abort();\n        }\n      });\n    };\n\n    // let's go!\n    if (!state.serverId) {\n      requestTransferId(function(serverId) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return;\n\n        // pass back to item so we can use it if something goes wrong\n        transfer(serverId);\n\n        // store internally\n        state.serverId = serverId;\n        processChunks();\n      });\n    } else {\n      requestTransferOffset(function(offset) {\n        // stop here if aborted, might have happened in between request and callback\n        if (state.aborted) return;\n\n        // mark chunks with lower offset as complete\n        chunks\n          .filter(function(chunk) {\n            return chunk.offset < offset;\n          })\n          .forEach(function(chunk) {\n            chunk.status = ChunkStatus.COMPLETE;\n            chunk.progress = chunk.size;\n          });\n\n        // continue processing\n        processChunks();\n      });\n    }\n\n    return {\n      abort: function abort() {\n        state.aborted = true;\n        abortChunks();\n      }\n    };\n  };\n\n  /*\n                                                               function signature:\n                                                                 (file, metadata, load, error, progress, abort) => {\n                                                                   return {\n                                                                   abort:() => {}\n                                                                 }\n                                                               }\n                                                               */\n  var createFileProcessorFunction = function createFileProcessorFunction(\n    apiUrl,\n    action,\n    name,\n    options\n  ) {\n    return function(file, metadata, load, error, progress, abort, transfer) {\n      // no file received\n      if (!file) return;\n\n      // if was passed a file, and we can chunk it, exit here\n      var canChunkUpload = options.chunkUploads;\n      var shouldChunkUpload = canChunkUpload && file.size > options.chunkSize;\n      var willChunkUpload =\n        canChunkUpload && (shouldChunkUpload || options.chunkForce);\n      if (file instanceof Blob && willChunkUpload)\n        return processFileChunked(\n          apiUrl,\n          action,\n          name,\n          file,\n          metadata,\n          load,\n          error,\n          progress,\n          abort,\n          transfer,\n          options\n        );\n\n      // set handlers\n      var ondata =\n        action.ondata ||\n        function(fd) {\n          return fd;\n        };\n      var onload =\n        action.onload ||\n        function(res) {\n          return res;\n        };\n      var onerror =\n        action.onerror ||\n        function(res) {\n          return null;\n        };\n\n      // create formdata object\n      var formData = new FormData();\n\n      // add metadata under same name\n      if (isObject(metadata)) {\n        formData.append(name, JSON.stringify(metadata));\n      }\n\n      // Turn into an array of objects so no matter what the input, we can handle it the same way\n      (file instanceof Blob ? [{ name: null, file: file }] : file).forEach(\n        function(item) {\n          formData.append(\n            name,\n            item.file,\n            item.name === null\n              ? item.file.name\n              : '' + item.name + item.file.name\n          );\n        }\n      );\n\n      // send request object\n      var request = sendRequest(ondata(formData), apiUrl + action.url, action);\n      request.onload = function(xhr) {\n        load(\n          createResponse(\n            'load',\n            xhr.status,\n            onload(xhr.response),\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.onerror = function(xhr) {\n        error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n      request.onprogress = progress;\n      request.onabort = abort;\n\n      // should return request\n      return request;\n    };\n  };\n\n  var createProcessorFunction = function createProcessorFunction() {\n    var apiUrl =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    var name = arguments.length > 2 ? arguments[2] : undefined;\n    var options = arguments.length > 3 ? arguments[3] : undefined;\n\n    // custom handler (should also handle file, load, error, progress and abort)\n    if (typeof action === 'function')\n      return function() {\n        for (\n          var _len = arguments.length, params = new Array(_len), _key = 0;\n          _key < _len;\n          _key++\n        ) {\n          params[_key] = arguments[_key];\n        }\n        return action.apply(void 0, [name].concat(params, [options]));\n      };\n\n    // no action supplied\n    if (!action || !isString(action.url)) return null;\n\n    // internal handler\n    return createFileProcessorFunction(apiUrl, action, name, options);\n  };\n\n  /*\n                                                      function signature:\n                                                      (uniqueFileId, load, error) => { }\n                                                      */\n  var createRevertFunction = function createRevertFunction() {\n    var apiUrl =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    var action = arguments.length > 1 ? arguments[1] : undefined;\n    // is custom implementation\n    if (typeof action === 'function') {\n      return action;\n    }\n\n    // no action supplied, return stub function, interface will work, but file won't be removed\n    if (!action || !isString(action.url)) {\n      return function(uniqueFileId, load) {\n        return load();\n      };\n    }\n\n    // set onload hanlder\n    var onload =\n      action.onload ||\n      function(res) {\n        return res;\n      };\n    var onerror =\n      action.onerror ||\n      function(res) {\n        return null;\n      };\n\n    // internal implementation\n    return function(uniqueFileId, load, error) {\n      var request = sendRequest(\n        uniqueFileId,\n        apiUrl + action.url,\n        action // contains method, headers and withCredentials properties\n      );\n      request.onload = function(xhr) {\n        load(\n          createResponse(\n            'load',\n            xhr.status,\n            onload(xhr.response),\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.onerror = function(xhr) {\n        error(\n          createResponse(\n            'error',\n            xhr.status,\n            onerror(xhr.response) || xhr.statusText,\n            xhr.getAllResponseHeaders()\n          )\n        );\n      };\n\n      request.ontimeout = createTimeoutResponse(error);\n\n      return request;\n    };\n  };\n\n  var getRandomNumber = function getRandomNumber() {\n    var min =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var max =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    return min + Math.random() * (max - min);\n  };\n\n  var createPerceivedPerformanceUpdater = function createPerceivedPerformanceUpdater(\n    cb\n  ) {\n    var duration =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1000;\n    var offset =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var tickMin =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 25;\n    var tickMax =\n      arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 250;\n    var timeout = null;\n    var start = Date.now();\n\n    var tick = function tick() {\n      var runtime = Date.now() - start;\n      var delay = getRandomNumber(tickMin, tickMax);\n\n      if (runtime + delay > duration) {\n        delay = runtime + delay - duration;\n      }\n\n      var progress = runtime / duration;\n      if (progress >= 1) {\n        cb(1);\n        return;\n      }\n\n      cb(progress);\n\n      timeout = setTimeout(tick, delay);\n    };\n\n    tick();\n\n    return {\n      clear: function clear() {\n        clearTimeout(timeout);\n      }\n    };\n  };\n\n  var createFileProcessor = function createFileProcessor(processFn) {\n    var state = {\n      complete: false,\n      perceivedProgress: 0,\n      perceivedPerformanceUpdater: null,\n      progress: null,\n      timestamp: null,\n      perceivedDuration: 0,\n      duration: 0,\n      request: null,\n      response: null\n    };\n\n    var process = function process(file, metadata) {\n      var progressFn = function progressFn() {\n        // we've not yet started the real download, stop here\n        // the request might not go through, for instance, there might be some server trouble\n        // if state.progress is null, the server does not allow computing progress and we show the spinner instead\n        if (state.duration === 0 || state.progress === null) {\n          return;\n        }\n\n        // as we're now processing, fire the progress event\n        api.fire('progress', api.getProgress());\n      };\n\n      var completeFn = function completeFn() {\n        state.complete = true;\n        api.fire('load-perceived', state.response.body);\n      };\n\n      // let's start processing\n      api.fire('start');\n\n      // set request start\n      state.timestamp = Date.now();\n\n      // create perceived performance progress indicator\n      state.perceivedPerformanceUpdater = createPerceivedPerformanceUpdater(\n        function(progress) {\n          state.perceivedProgress = progress;\n          state.perceivedDuration = Date.now() - state.timestamp;\n\n          progressFn();\n\n          // if fake progress is done, and a response has been received,\n          // and we've not yet called the complete method\n          if (\n            state.response &&\n            state.perceivedProgress === 1 &&\n            !state.complete\n          ) {\n            // we done!\n            completeFn();\n          }\n        },\n        // random delay as in a list of files you start noticing\n        // files uploading at the exact same speed\n        getRandomNumber(750, 1500)\n      );\n\n      // remember request so we can abort it later\n      state.request = processFn(\n        // the file to process\n        file,\n\n        // the metadata to send along\n        metadata,\n\n        // callbacks (load, error, progress, abort, transfer)\n        // load expects the body to be a server id if\n        // you want to make use of revert\n        function(response) {\n          // we put the response in state so we can access\n          // it outside of this method\n          state.response = isObject(response)\n            ? response\n            : {\n                type: 'load',\n                code: 200,\n                body: '' + response,\n                headers: {}\n              };\n\n          // update duration\n          state.duration = Date.now() - state.timestamp;\n\n          // force progress to 1 as we're now done\n          state.progress = 1;\n\n          // actual load is done let's share results\n          api.fire('load', state.response.body);\n\n          // we are really done\n          // if perceived progress is 1 ( wait for perceived progress to complete )\n          // or if server does not support progress ( null )\n          if (state.perceivedProgress === 1) {\n            completeFn();\n          }\n        },\n\n        // error is expected to be an object with type, code, body\n        function(error) {\n          // cancel updater\n          state.perceivedPerformanceUpdater.clear();\n\n          // update others about this error\n          api.fire(\n            'error',\n            isObject(error)\n              ? error\n              : {\n                  type: 'error',\n                  code: 0,\n                  body: '' + error\n                }\n          );\n        },\n\n        // actual processing progress\n        function(computable, current, total) {\n          // update actual duration\n          state.duration = Date.now() - state.timestamp;\n\n          // update actual progress\n          state.progress = computable ? current / total : null;\n\n          progressFn();\n        },\n\n        // abort does not expect a value\n        function() {\n          // stop updater\n          state.perceivedPerformanceUpdater.clear();\n\n          // fire the abort event so we can switch visuals\n          api.fire('abort', state.response ? state.response.body : null);\n        },\n\n        // register the id for this transfer\n        function(transferId) {\n          api.fire('transfer', transferId);\n        }\n      );\n    };\n\n    var abort = function abort() {\n      // no request running, can't abort\n      if (!state.request) return;\n\n      // stop updater\n      state.perceivedPerformanceUpdater.clear();\n\n      // abort actual request\n      state.request.abort();\n\n      // if has response object, we've completed the request\n      state.complete = true;\n    };\n\n    var reset = function reset() {\n      abort();\n      state.complete = false;\n      state.perceivedProgress = 0;\n      state.progress = 0;\n      state.timestamp = null;\n      state.perceivedDuration = 0;\n      state.duration = 0;\n      state.request = null;\n      state.response = null;\n    };\n\n    var getProgress = function getProgress() {\n      return state.progress\n        ? Math.min(state.progress, state.perceivedProgress)\n        : null;\n    };\n    var getDuration = function getDuration() {\n      return Math.min(state.duration, state.perceivedDuration);\n    };\n\n    var api = Object.assign({}, on(), {\n      process: process, // start processing file\n      abort: abort, // abort active process request\n      getProgress: getProgress,\n      getDuration: getDuration,\n      reset: reset\n    });\n\n    return api;\n  };\n\n  var getFilenameWithoutExtension = function getFilenameWithoutExtension(name) {\n    return name.substr(0, name.lastIndexOf('.')) || name;\n  };\n\n  var createFileStub = function createFileStub(source) {\n    var data = [source.name, source.size, source.type];\n\n    // is blob or base64, then we need to set the name\n    if (source instanceof Blob || isBase64DataURI(source)) {\n      data[0] = source.name || getDateString();\n    } else if (isBase64DataURI(source)) {\n      // if is base64 data uri we need to determine the average size and type\n      data[1] = source.length;\n      data[2] = getMimeTypeFromBase64DataURI(source);\n    } else if (isString(source)) {\n      // url\n      data[0] = getFilenameFromURL(source);\n      data[1] = 0;\n      data[2] = 'application/octet-stream';\n    }\n\n    return {\n      name: data[0],\n      size: data[1],\n      type: data[2]\n    };\n  };\n\n  var isFile = function isFile(value) {\n    return !!(value instanceof File || (value instanceof Blob && value.name));\n  };\n\n  var deepCloneObject = function deepCloneObject(src) {\n    if (!isObject(src)) return src;\n    var target = isArray(src) ? [] : {};\n    for (var key in src) {\n      if (!src.hasOwnProperty(key)) continue;\n      var v = src[key];\n      target[key] = v && isObject(v) ? deepCloneObject(v) : v;\n    }\n    return target;\n  };\n\n  var createItem = function createItem() {\n    var origin =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    var serverFileReference =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var file =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    // unique id for this item, is used to identify the item across views\n    var id = getUniqueId();\n\n    /**\n     * Internal item state\n     */\n    var state = {\n      // is archived\n      archived: false,\n\n      // if is frozen, no longer fires events\n      frozen: false,\n\n      // removed from view\n      released: false,\n\n      // original source\n      source: null,\n\n      // file model reference\n      file: file,\n\n      // id of file on server\n      serverFileReference: serverFileReference,\n\n      // id of file transfer on server\n      transferId: null,\n\n      // is aborted\n      processingAborted: false,\n\n      // current item status\n      status: serverFileReference\n        ? ItemStatus.PROCESSING_COMPLETE\n        : ItemStatus.INIT,\n\n      // active processes\n      activeLoader: null,\n      activeProcessor: null\n    };\n\n    // callback used when abort processing is called to link back to the resolve method\n    var abortProcessingRequestComplete = null;\n\n    /**\n     * Externally added item metadata\n     */\n    var metadata = {};\n\n    // item data\n    var setStatus = function setStatus(status) {\n      return (state.status = status);\n    };\n\n    // fire event unless the item has been archived\n    var fire = function fire(event) {\n      if (state.released || state.frozen) return;\n      for (\n        var _len = arguments.length,\n          params = new Array(_len > 1 ? _len - 1 : 0),\n          _key = 1;\n        _key < _len;\n        _key++\n      ) {\n        params[_key - 1] = arguments[_key];\n      }\n      api.fire.apply(api, [event].concat(params));\n    };\n\n    // file data\n    var getFileExtension = function getFileExtension() {\n      return getExtensionFromFilename(state.file.name);\n    };\n    var getFileType = function getFileType() {\n      return state.file.type;\n    };\n    var getFileSize = function getFileSize() {\n      return state.file.size;\n    };\n    var getFile = function getFile() {\n      return state.file;\n    };\n\n    //\n    // logic to load a file\n    //\n    var load = function load(source, loader, onload) {\n      // remember the original item source\n      state.source = source;\n\n      // file stub is already there\n      if (state.file) {\n        fire('load-skip');\n        return;\n      }\n\n      // set a stub file object while loading the actual data\n      state.file = createFileStub(source);\n\n      // starts loading\n      loader.on('init', function() {\n        fire('load-init');\n      });\n\n      // we'eve received a size indication, let's update the stub\n      loader.on('meta', function(meta) {\n        // set size of file stub\n        state.file.size = meta.size;\n\n        // set name of file stub\n        state.file.filename = meta.filename;\n\n        // if has received source, we done\n        if (meta.source) {\n          origin = FileOrigin.LIMBO;\n          state.serverFileReference = meta.source;\n          state.status = ItemStatus.PROCESSING_COMPLETE;\n        }\n\n        // size has been updated\n        fire('load-meta');\n      });\n\n      // the file is now loading we need to update the progress indicators\n      loader.on('progress', function(progress) {\n        setStatus(ItemStatus.LOADING);\n\n        fire('load-progress', progress);\n      });\n\n      // an error was thrown while loading the file, we need to switch to error state\n      loader.on('error', function(error) {\n        setStatus(ItemStatus.LOAD_ERROR);\n\n        fire('load-request-error', error);\n      });\n\n      // user or another process aborted the file load (cannot retry)\n      loader.on('abort', function() {\n        setStatus(ItemStatus.INIT);\n        fire('load-abort');\n      });\n\n      // done loading\n      loader.on('load', function(file) {\n        // as we've now loaded the file the loader is no longer required\n        state.activeLoader = null;\n\n        // called when file has loaded succesfully\n        var success = function success(result) {\n          // set (possibly) transformed file\n          state.file = isFile(result) ? result : state.file;\n\n          // file received\n          if (origin === FileOrigin.LIMBO && state.serverFileReference) {\n            setStatus(ItemStatus.PROCESSING_COMPLETE);\n          } else {\n            setStatus(ItemStatus.IDLE);\n          }\n\n          fire('load');\n        };\n\n        var error = function error(result) {\n          // set original file\n          state.file = file;\n          fire('load-meta');\n\n          setStatus(ItemStatus.LOAD_ERROR);\n          fire('load-file-error', result);\n        };\n\n        // if we already have a server file reference, we don't need to call the onload method\n        if (state.serverFileReference) {\n          success(file);\n          return;\n        }\n\n        // no server id, let's give this file the full treatment\n        onload(file, success, error);\n      });\n\n      // set loader source data\n      loader.setSource(source);\n\n      // set as active loader\n      state.activeLoader = loader;\n\n      // load the source data\n      loader.load();\n    };\n\n    var retryLoad = function retryLoad() {\n      if (!state.activeLoader) {\n        return;\n      }\n      state.activeLoader.load();\n    };\n\n    var abortLoad = function abortLoad() {\n      if (state.activeLoader) {\n        state.activeLoader.abort();\n        return;\n      }\n      setStatus(ItemStatus.INIT);\n      fire('load-abort');\n    };\n\n    //\n    // logic to process a file\n    //\n    var process = function process(processor, onprocess) {\n      // processing was aborted\n      if (state.processingAborted) {\n        state.processingAborted = false;\n        return;\n      }\n\n      // now processing\n      setStatus(ItemStatus.PROCESSING);\n\n      // reset abort callback\n      abortProcessingRequestComplete = null;\n\n      // if no file loaded we'll wait for the load event\n      if (!(state.file instanceof Blob)) {\n        api.on('load', function() {\n          process(processor, onprocess);\n        });\n        return;\n      }\n\n      // setup processor\n      processor.on('load', function(serverFileReference) {\n        // need this id to be able to revert the upload\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n      });\n\n      // register transfer id\n      processor.on('transfer', function(transferId) {\n        // need this id to be able to revert the upload\n        state.transferId = transferId;\n      });\n\n      processor.on('load-perceived', function(serverFileReference) {\n        // no longer required\n        state.activeProcessor = null;\n\n        // need this id to be able to rever the upload\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n\n        setStatus(ItemStatus.PROCESSING_COMPLETE);\n        fire('process-complete', serverFileReference);\n      });\n\n      processor.on('start', function() {\n        fire('process-start');\n      });\n\n      processor.on('error', function(error) {\n        state.activeProcessor = null;\n        setStatus(ItemStatus.PROCESSING_ERROR);\n        fire('process-error', error);\n      });\n\n      processor.on('abort', function(serverFileReference) {\n        state.activeProcessor = null;\n\n        // if file was uploaded but processing was cancelled during perceived processor time store file reference\n        state.transferId = null;\n        state.serverFileReference = serverFileReference;\n\n        setStatus(ItemStatus.IDLE);\n        fire('process-abort');\n\n        // has timeout so doesn't interfere with remove action\n        if (abortProcessingRequestComplete) {\n          abortProcessingRequestComplete();\n        }\n      });\n\n      processor.on('progress', function(progress) {\n        fire('process-progress', progress);\n      });\n\n      // when successfully transformed\n      var success = function success(file) {\n        // if was archived in the mean time, don't process\n        if (state.archived) return;\n\n        // process file!\n        processor.process(file, Object.assign({}, metadata));\n      };\n\n      // something went wrong during transform phase\n      var error = console.error;\n\n      // start processing the file\n      onprocess(state.file, success, error);\n\n      // set as active processor\n      state.activeProcessor = processor;\n    };\n\n    var requestProcessing = function requestProcessing() {\n      state.processingAborted = false;\n      setStatus(ItemStatus.PROCESSING_QUEUED);\n    };\n\n    var abortProcessing = function abortProcessing() {\n      return new Promise(function(resolve) {\n        if (!state.activeProcessor) {\n          state.processingAborted = true;\n\n          setStatus(ItemStatus.IDLE);\n          fire('process-abort');\n\n          resolve();\n          return;\n        }\n\n        abortProcessingRequestComplete = function abortProcessingRequestComplete() {\n          resolve();\n        };\n\n        state.activeProcessor.abort();\n      });\n    };\n\n    //\n    // logic to revert a processed file\n    //\n    var revert = function revert(revertFileUpload, forceRevert) {\n      return new Promise(function(resolve, reject) {\n        // cannot revert without a server id for this process\n        if (state.serverFileReference === null) {\n          resolve();\n          return;\n        }\n\n        // revert the upload (fire and forget)\n        revertFileUpload(\n          state.serverFileReference,\n          function() {\n            // reset file server id as now it's no available on the server\n            state.serverFileReference = null;\n            resolve();\n          },\n          function(error) {\n            // don't set error state when reverting is optional, it will always resolve\n            if (!forceRevert) {\n              resolve();\n              return;\n            }\n\n            // oh no errors\n            setStatus(ItemStatus.PROCESSING_REVERT_ERROR);\n            fire('process-revert-error');\n            reject(error);\n          }\n        );\n\n        // fire event\n        setStatus(ItemStatus.IDLE);\n        fire('process-revert');\n      });\n    };\n\n    // exposed methods\n    var _setMetadata = function setMetadata(key, value, silent) {\n      var keys = key.split('.');\n      var root = keys[0];\n      var last = keys.pop();\n      var data = metadata;\n      keys.forEach(function(key) {\n        return (data = data[key]);\n      });\n\n      // compare old value against new value, if they're the same, we're not updating\n      if (JSON.stringify(data[last]) === JSON.stringify(value)) return;\n\n      // update value\n      data[last] = value;\n\n      // don't fire update\n      if (silent) return;\n\n      // fire update\n      fire('metadata-update', {\n        key: root,\n        value: metadata[root]\n      });\n    };\n\n    var getMetadata = function getMetadata(key) {\n      return deepCloneObject(key ? metadata[key] : metadata);\n    };\n\n    var api = Object.assign(\n      {\n        id: {\n          get: function get() {\n            return id;\n          }\n        },\n        origin: {\n          get: function get() {\n            return origin;\n          }\n        },\n        serverId: {\n          get: function get() {\n            return state.serverFileReference;\n          }\n        },\n        transferId: {\n          get: function get() {\n            return state.transferId;\n          }\n        },\n        status: {\n          get: function get() {\n            return state.status;\n          }\n        },\n        filename: {\n          get: function get() {\n            return state.file.name;\n          }\n        },\n        filenameWithoutExtension: {\n          get: function get() {\n            return getFilenameWithoutExtension(state.file.name);\n          }\n        },\n        fileExtension: { get: getFileExtension },\n        fileType: { get: getFileType },\n        fileSize: { get: getFileSize },\n        file: { get: getFile },\n\n        source: {\n          get: function get() {\n            return state.source;\n          }\n        },\n\n        getMetadata: getMetadata,\n        setMetadata: function setMetadata(key, value, silent) {\n          if (isObject(key)) {\n            var data = key;\n            Object.keys(data).forEach(function(key) {\n              _setMetadata(key, data[key], value);\n            });\n            return key;\n          }\n          _setMetadata(key, value, silent);\n          return value;\n        },\n\n        extend: function extend(name, handler) {\n          return (itemAPI[name] = handler);\n        },\n\n        abortLoad: abortLoad,\n        retryLoad: retryLoad,\n        requestProcessing: requestProcessing,\n        abortProcessing: abortProcessing,\n\n        load: load,\n        process: process,\n        revert: revert\n      },\n\n      on(),\n      {\n        freeze: function freeze() {\n          return (state.frozen = true);\n        },\n\n        release: function release() {\n          return (state.released = true);\n        },\n        released: {\n          get: function get() {\n            return state.released;\n          }\n        },\n\n        archive: function archive() {\n          return (state.archived = true);\n        },\n        archived: {\n          get: function get() {\n            return state.archived;\n          }\n        }\n      }\n    );\n\n    // create it here instead of returning it instantly so we can extend it later\n    var itemAPI = createObject(api);\n\n    return itemAPI;\n  };\n\n  var getItemIndexByQuery = function getItemIndexByQuery(items, query) {\n    // just return first index\n    if (isEmpty(query)) {\n      return 0;\n    }\n\n    // invalid queries\n    if (!isString(query)) {\n      return -1;\n    }\n\n    // return item by id (or -1 if not found)\n    return items.findIndex(function(item) {\n      return item.id === query;\n    });\n  };\n\n  var getItemById = function getItemById(items, itemId) {\n    var index = getItemIndexByQuery(items, itemId);\n    if (index < 0) {\n      return;\n    }\n    return items[index] || null;\n  };\n\n  var fetchLocal = function fetchLocal(\n    url,\n    load,\n    error,\n    progress,\n    abort,\n    headers\n  ) {\n    var request = sendRequest(null, url, {\n      method: 'GET',\n      responseType: 'blob'\n    });\n\n    request.onload = function(xhr) {\n      // get headers\n      var headers = xhr.getAllResponseHeaders();\n\n      // get filename\n      var filename =\n        getFileInfoFromHeaders(headers).name || getFilenameFromURL(url);\n\n      // create response\n      load(\n        createResponse(\n          'load',\n          xhr.status,\n          getFileFromBlob(xhr.response, filename),\n          headers\n        )\n      );\n    };\n\n    request.onerror = function(xhr) {\n      error(\n        createResponse(\n          'error',\n          xhr.status,\n          xhr.statusText,\n          xhr.getAllResponseHeaders()\n        )\n      );\n    };\n\n    request.onheaders = function(xhr) {\n      headers(\n        createResponse('headers', xhr.status, null, xhr.getAllResponseHeaders())\n      );\n    };\n\n    request.ontimeout = createTimeoutResponse(error);\n    request.onprogress = progress;\n    request.onabort = abort;\n\n    // should return request\n    return request;\n  };\n\n  var getDomainFromURL = function getDomainFromURL(url) {\n    if (url.indexOf('//') === 0) {\n      url = location.protocol + url;\n    }\n    return url\n      .toLowerCase()\n      .replace('blob:', '')\n      .replace(/([a-z])?:\\/\\//, '$1')\n      .split('/')[0];\n  };\n\n  var isExternalURL = function isExternalURL(url) {\n    return (\n      (url.indexOf(':') > -1 || url.indexOf('//') > -1) &&\n      getDomainFromURL(location.href) !== getDomainFromURL(url)\n    );\n  };\n\n  var dynamicLabel = function dynamicLabel(label) {\n    return function() {\n      return isFunction(label) ? label.apply(void 0, arguments) : label;\n    };\n  };\n\n  var isMockItem = function isMockItem(item) {\n    return !isFile(item.file);\n  };\n\n  var listUpdated = function listUpdated(dispatch, state) {\n    clearTimeout(state.listUpdateTimeout);\n    state.listUpdateTimeout = setTimeout(function() {\n      dispatch('DID_UPDATE_ITEMS', { items: getActiveItems(state.items) });\n    }, 0);\n  };\n\n  var optionalPromise = function optionalPromise(fn) {\n    for (\n      var _len = arguments.length,\n        params = new Array(_len > 1 ? _len - 1 : 0),\n        _key = 1;\n      _key < _len;\n      _key++\n    ) {\n      params[_key - 1] = arguments[_key];\n    }\n    return new Promise(function(resolve) {\n      if (!fn) {\n        return resolve(true);\n      }\n\n      var result = fn.apply(void 0, params);\n\n      if (result == null) {\n        return resolve(true);\n      }\n\n      if (typeof result === 'boolean') {\n        return resolve(result);\n      }\n\n      if (typeof result.then === 'function') {\n        result.then(resolve);\n      }\n    });\n  };\n\n  var sortItems = function sortItems(state, compare) {\n    state.items.sort(function(a, b) {\n      return compare(createItemAPI(a), createItemAPI(b));\n    });\n  };\n\n  // returns item based on state\n  var getItemByQueryFromState = function getItemByQueryFromState(\n    state,\n    itemHandler\n  ) {\n    return function() {\n      var _ref =\n          arguments.length > 0 && arguments[0] !== undefined\n            ? arguments[0]\n            : {},\n        query = _ref.query,\n        _ref$success = _ref.success,\n        success = _ref$success === void 0 ? function() {} : _ref$success,\n        _ref$failure = _ref.failure,\n        failure = _ref$failure === void 0 ? function() {} : _ref$failure;\n      var item = getItemByQuery(state.items, query);\n      if (!item) {\n        failure({\n          error: createResponse('error', 0, 'Item not found'),\n\n          file: null\n        });\n\n        return;\n      }\n      itemHandler(item, success, failure);\n    };\n  };\n\n  var actions = function actions(dispatch, query, state) {\n    return {\n      /**\n       * Aborts all ongoing processes\n       */\n      ABORT_ALL: function ABORT_ALL() {\n        getActiveItems(state.items).forEach(function(item) {\n          item.freeze();\n          item.abortLoad();\n          item.abortProcessing();\n        });\n      },\n\n      /**\n       * Sets initial files\n       */\n      DID_SET_FILES: function DID_SET_FILES(_ref2) {\n        var _ref2$value = _ref2.value,\n          value = _ref2$value === void 0 ? [] : _ref2$value;\n\n        // map values to file objects\n        var files = value.map(function(file) {\n          return {\n            source: file.source ? file.source : file,\n            options: file.options\n          };\n        });\n\n        // loop over files, if file is in list, leave it be, if not, remove\n        // test if items should be moved\n        var activeItems = getActiveItems(state.items);\n\n        activeItems.forEach(function(item) {\n          // if item not is in new value, remove\n          if (\n            !files.find(function(file) {\n              return file.source === item.source || file.source === item.file;\n            })\n          ) {\n            dispatch('REMOVE_ITEM', { query: item });\n          }\n        });\n\n        // add new files\n        activeItems = getActiveItems(state.items);\n        files.forEach(function(file, index) {\n          // if file is already in list\n          if (\n            activeItems.find(function(item) {\n              return item.source === file.source || item.file === file.source;\n            })\n          )\n            return;\n\n          // not in list, add\n          dispatch(\n            'ADD_ITEM',\n            Object.assign({}, file, {\n              interactionMethod: InteractionMethod.NONE,\n              index: index\n            })\n          );\n        });\n      },\n\n      DID_UPDATE_ITEM_METADATA: function DID_UPDATE_ITEM_METADATA(_ref3) {\n        var id = _ref3.id;\n\n        // if is called multiple times in close succession we combined all calls together to save resources\n        clearTimeout(state.itemUpdateTimeout);\n        state.itemUpdateTimeout = setTimeout(function() {\n          var item = getItemById(state.items, id);\n\n          // only revert and attempt to upload when we're uploading to a server\n          if (!query('IS_ASYNC')) {\n            // should we update the output data\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query\n            }).then(function(shouldPrepareOutput) {\n              if (!shouldPrepareOutput) {\n                return;\n              }\n              dispatch(\n                'REQUEST_PREPARE_OUTPUT',\n                {\n                  query: id,\n                  item: item,\n                  ready: function ready(file) {\n                    dispatch('DID_PREPARE_OUTPUT', { id: id, file: file });\n                  }\n                },\n                true\n              );\n            });\n\n            return;\n          }\n\n          // for async scenarios\n          var upload = function upload() {\n            // we push this forward a bit so the interface is updated correctly\n            setTimeout(function() {\n              dispatch('REQUEST_ITEM_PROCESSING', { query: id });\n            }, 32);\n          };\n\n          var revert = function revert(doUpload) {\n            item\n              .revert(\n                createRevertFunction(\n                  state.options.server.url,\n                  state.options.server.revert\n                ),\n                query('GET_FORCE_REVERT')\n              )\n              .then(doUpload ? upload : function() {})\n              .catch(function() {});\n          };\n\n          var abort = function abort(doUpload) {\n            item.abortProcessing().then(doUpload ? upload : function() {});\n          };\n\n          // if we should re-upload the file immidiately\n          if (item.status === ItemStatus.PROCESSING_COMPLETE) {\n            return revert(state.options.instantUpload);\n          }\n\n          // if currently uploading, cancel upload\n          if (item.status === ItemStatus.PROCESSING) {\n            return abort(state.options.instantUpload);\n          }\n\n          if (state.options.instantUpload) {\n            upload();\n          }\n        }, 0);\n      },\n\n      SORT: function SORT(_ref4) {\n        var compare = _ref4.compare;\n        sortItems(state, compare);\n      },\n\n      ADD_ITEMS: function ADD_ITEMS(_ref5) {\n        var items = _ref5.items,\n          index = _ref5.index,\n          interactionMethod = _ref5.interactionMethod,\n          _ref5$success = _ref5.success,\n          success = _ref5$success === void 0 ? function() {} : _ref5$success,\n          _ref5$failure = _ref5.failure,\n          failure = _ref5$failure === void 0 ? function() {} : _ref5$failure;\n\n        var currentIndex = index;\n\n        if (index === -1 || typeof index === 'undefined') {\n          var insertLocation = query('GET_ITEM_INSERT_LOCATION');\n          var totalItems = query('GET_TOTAL_ITEMS');\n          currentIndex = insertLocation === 'before' ? 0 : totalItems;\n        }\n\n        var ignoredFiles = query('GET_IGNORED_FILES');\n        var isValidFile = function isValidFile(source) {\n          return isFile(source)\n            ? !ignoredFiles.includes(source.name.toLowerCase())\n            : !isEmpty(source);\n        };\n        var validItems = items.filter(isValidFile);\n\n        var promises = validItems.map(function(source) {\n          return new Promise(function(resolve, reject) {\n            dispatch('ADD_ITEM', {\n              interactionMethod: interactionMethod,\n              source: source.source || source,\n              success: resolve,\n              failure: reject,\n              index: currentIndex++,\n              options: source.options || {}\n            });\n          });\n        });\n\n        Promise.all(promises)\n          .then(success)\n          .catch(failure);\n      },\n\n      /**\n       * @param source\n       * @param index\n       * @param interactionMethod\n       */\n      ADD_ITEM: function ADD_ITEM(_ref6) {\n        var source = _ref6.source,\n          _ref6$index = _ref6.index,\n          index = _ref6$index === void 0 ? -1 : _ref6$index,\n          interactionMethod = _ref6.interactionMethod,\n          _ref6$success = _ref6.success,\n          success = _ref6$success === void 0 ? function() {} : _ref6$success,\n          _ref6$failure = _ref6.failure,\n          failure = _ref6$failure === void 0 ? function() {} : _ref6$failure,\n          _ref6$options = _ref6.options,\n          options = _ref6$options === void 0 ? {} : _ref6$options;\n\n        // if no source supplied\n        if (isEmpty(source)) {\n          failure({\n            error: createResponse('error', 0, 'No source'),\n\n            file: null\n          });\n\n          return;\n        }\n\n        // filter out invalid file items, used to filter dropped directory contents\n        if (\n          isFile(source) &&\n          state.options.ignoredFiles.includes(source.name.toLowerCase())\n        ) {\n          // fail silently\n          return;\n        }\n\n        // test if there's still room in the list of files\n        if (!hasRoomForItem(state)) {\n          // if multiple allowed, we can't replace\n          // or if only a single item is allowed but we're not allowed to replace it we exit\n          if (\n            state.options.allowMultiple ||\n            (!state.options.allowMultiple && !state.options.allowReplace)\n          ) {\n            var error = createResponse('warning', 0, 'Max files');\n\n            dispatch('DID_THROW_MAX_FILES', {\n              source: source,\n              error: error\n            });\n\n            failure({ error: error, file: null });\n\n            return;\n          }\n\n          // let's replace the item\n          // id of first item we're about to remove\n          var _item = getActiveItems(state.items)[0];\n\n          // if has been processed remove it from the server as well\n          if (\n            _item.status === ItemStatus.PROCESSING_COMPLETE ||\n            _item.status === ItemStatus.PROCESSING_REVERT_ERROR\n          ) {\n            var forceRevert = query('GET_FORCE_REVERT');\n            _item\n              .revert(\n                createRevertFunction(\n                  state.options.server.url,\n                  state.options.server.revert\n                ),\n                forceRevert\n              )\n              .then(function() {\n                if (!forceRevert) return;\n\n                // try to add now\n                dispatch('ADD_ITEM', {\n                  source: source,\n                  index: index,\n                  interactionMethod: interactionMethod,\n                  success: success,\n                  failure: failure,\n                  options: options\n                });\n              })\n              .catch(function() {}); // no need to handle this catch state for now\n\n            if (forceRevert) return;\n          }\n\n          // remove first item as it will be replaced by this item\n          dispatch('REMOVE_ITEM', { query: _item.id });\n        }\n\n        // where did the file originate\n        var origin =\n          options.type === 'local'\n            ? FileOrigin.LOCAL\n            : options.type === 'limbo'\n            ? FileOrigin.LIMBO\n            : FileOrigin.INPUT;\n\n        // create a new blank item\n        var item = createItem(\n          // where did this file come from\n          origin,\n\n          // an input file never has a server file reference\n          origin === FileOrigin.INPUT ? null : source,\n\n          // file mock data, if defined\n          options.file\n        );\n\n        // set initial meta data\n        Object.keys(options.metadata || {}).forEach(function(key) {\n          item.setMetadata(key, options.metadata[key]);\n        });\n\n        // created the item, let plugins add methods\n        applyFilters('DID_CREATE_ITEM', item, {\n          query: query,\n          dispatch: dispatch\n        });\n\n        // where to insert new items\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n\n        // adjust index if is not allowed to pick location\n        if (!state.options.itemInsertLocationFreedom) {\n          index = itemInsertLocation === 'before' ? -1 : state.items.length;\n        }\n\n        // add item to list\n        insertItem(state.items, item, index);\n\n        // sort items in list\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        }\n\n        // get a quick reference to the item id\n        var id = item.id;\n\n        // observe item events\n        item.on('load-init', function() {\n          dispatch('DID_START_ITEM_LOAD', { id: id });\n        });\n\n        item.on('load-meta', function() {\n          dispatch('DID_UPDATE_ITEM_META', { id: id });\n        });\n\n        item.on('load-progress', function(progress) {\n          dispatch('DID_UPDATE_ITEM_LOAD_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n\n        item.on('load-request-error', function(error) {\n          var mainStatus = dynamicLabel(state.options.labelFileLoadError)(\n            error\n          );\n\n          // is client error, no way to recover\n          if (error.code >= 400 && error.code < 500) {\n            dispatch('DID_THROW_ITEM_INVALID', {\n              id: id,\n              error: error,\n              status: {\n                main: mainStatus,\n                sub: error.code + ' (' + error.body + ')'\n              }\n            });\n\n            // reject the file so can be dealt with through API\n            failure({ error: error, file: createItemAPI(item) });\n            return;\n          }\n\n          // is possible server error, so might be possible to retry\n          dispatch('DID_THROW_ITEM_LOAD_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: mainStatus,\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n\n        item.on('load-file-error', function(error) {\n          dispatch('DID_THROW_ITEM_INVALID', {\n            id: id,\n            error: error.status,\n            status: error.status\n          });\n\n          failure({ error: error.status, file: createItemAPI(item) });\n        });\n\n        item.on('load-abort', function() {\n          dispatch('REMOVE_ITEM', { query: id });\n        });\n\n        item.on('load-skip', function() {\n          dispatch('COMPLETE_LOAD_ITEM', {\n            query: id,\n            item: item,\n            data: {\n              source: source,\n              success: success\n            }\n          });\n        });\n\n        item.on('load', function() {\n          var handleAdd = function handleAdd(shouldAdd) {\n            // no should not add this file\n            if (!shouldAdd) {\n              dispatch('REMOVE_ITEM', {\n                query: id\n              });\n\n              return;\n            }\n\n            // now interested in metadata updates\n            item.on('metadata-update', function(change) {\n              dispatch('DID_UPDATE_ITEM_METADATA', { id: id, change: change });\n            });\n\n            // let plugins decide if the output data should be prepared at this point\n            // means we'll do this and wait for idle state\n            applyFilterChain('SHOULD_PREPARE_OUTPUT', false, {\n              item: item,\n              query: query\n            }).then(function(shouldPrepareOutput) {\n              var loadComplete = function loadComplete() {\n                dispatch('COMPLETE_LOAD_ITEM', {\n                  query: id,\n                  item: item,\n                  data: {\n                    source: source,\n                    success: success\n                  }\n                });\n\n                listUpdated(dispatch, state);\n              };\n\n              // exit\n              if (shouldPrepareOutput) {\n                // wait for idle state and then run PREPARE_OUTPUT\n                dispatch(\n                  'REQUEST_PREPARE_OUTPUT',\n                  {\n                    query: id,\n                    item: item,\n                    ready: function ready(file) {\n                      dispatch('DID_PREPARE_OUTPUT', { id: id, file: file });\n                      loadComplete();\n                    }\n                  },\n                  true\n                );\n\n                return;\n              }\n\n              loadComplete();\n            });\n          };\n\n          // item loaded, allow plugins to\n          // - read data (quickly)\n          // - add metadata\n          applyFilterChain('DID_LOAD_ITEM', item, {\n            query: query,\n            dispatch: dispatch\n          })\n            .then(function() {\n              optionalPromise(\n                query('GET_BEFORE_ADD_FILE'),\n                createItemAPI(item)\n              ).then(handleAdd);\n            })\n            .catch(function() {\n              handleAdd(false);\n            });\n        });\n\n        item.on('process-start', function() {\n          dispatch('DID_START_ITEM_PROCESSING', { id: id });\n        });\n\n        item.on('process-progress', function(progress) {\n          dispatch('DID_UPDATE_ITEM_PROCESS_PROGRESS', {\n            id: id,\n            progress: progress\n          });\n        });\n\n        item.on('process-error', function(error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingError)(error),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n\n        item.on('process-revert-error', function(error) {\n          dispatch('DID_THROW_ITEM_PROCESSING_REVERT_ERROR', {\n            id: id,\n            error: error,\n            status: {\n              main: dynamicLabel(state.options.labelFileProcessingRevertError)(\n                error\n              ),\n              sub: state.options.labelTapToRetry\n            }\n          });\n        });\n\n        item.on('process-complete', function(serverFileReference) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: id,\n            error: null,\n            serverFileReference: serverFileReference\n          });\n        });\n\n        item.on('process-abort', function() {\n          dispatch('DID_ABORT_ITEM_PROCESSING', { id: id });\n        });\n\n        item.on('process-revert', function() {\n          dispatch('DID_REVERT_ITEM_PROCESSING', { id: id });\n        });\n\n        // let view know the item has been inserted\n        dispatch('DID_ADD_ITEM', {\n          id: id,\n          index: index,\n          interactionMethod: interactionMethod\n        });\n\n        listUpdated(dispatch, state);\n\n        // start loading the source\n        var _ref7 = state.options.server || {},\n          url = _ref7.url,\n          load = _ref7.load,\n          restore = _ref7.restore,\n          fetch = _ref7.fetch;\n\n        item.load(\n          source,\n\n          // this creates a function that loads the file based on the type of file (string, base64, blob, file) and location of file (local, remote, limbo)\n          createFileLoader(\n            origin === FileOrigin.INPUT\n              ? // input\n                isString(source) && isExternalURL(source)\n                ? createFetchFunction(url, fetch) // remote url\n                : fetchLocal // local url\n              : // limbo or local\n              origin === FileOrigin.LIMBO\n              ? createFetchFunction(url, restore) // limbo\n              : createFetchFunction(url, load) // local\n          ),\n\n          // called when the file is loaded so it can be piped through the filters\n          function(file, success, error) {\n            // let's process the file\n            applyFilterChain('LOAD_FILE', file, { query: query })\n              .then(success)\n              .catch(error);\n          }\n        );\n      },\n\n      REQUEST_PREPARE_OUTPUT: function REQUEST_PREPARE_OUTPUT(_ref8) {\n        var item = _ref8.item,\n          ready = _ref8.ready;\n\n        // don't handle archived items, an item could have been archived (load aborted) while waiting to be prepared\n        if (item.archived) return;\n\n        // allow plugins to alter the file data\n        applyFilterChain('PREPARE_OUTPUT', item.file, {\n          query: query,\n          item: item\n        }).then(function(result) {\n          applyFilterChain('COMPLETE_PREPARE_OUTPUT', result, {\n            query: query,\n            item: item\n          }).then(function(result) {\n            // don't handle archived items, an item could have been archived (load aborted) while being prepared\n            if (item.archived) return;\n\n            // we done!\n            ready(result);\n          });\n        });\n      },\n\n      COMPLETE_LOAD_ITEM: function COMPLETE_LOAD_ITEM(_ref9) {\n        var item = _ref9.item,\n          data = _ref9.data;\n        var success = data.success,\n          source = data.source;\n\n        // sort items in list\n        var itemInsertLocation = query('GET_ITEM_INSERT_LOCATION');\n        if (isFunction(itemInsertLocation) && source) {\n          sortItems(state, itemInsertLocation);\n        }\n\n        // let interface know the item has loaded\n        dispatch('DID_LOAD_ITEM', {\n          id: item.id,\n          error: null,\n          serverFileReference: item.origin === FileOrigin.INPUT ? null : source\n        });\n\n        // item has been successfully loaded and added to the\n        // list of items so can now be safely returned for use\n        success(createItemAPI(item));\n\n        // if this is a local server file we need to show a different state\n        if (item.origin === FileOrigin.LOCAL) {\n          dispatch('DID_LOAD_LOCAL_ITEM', { id: item.id });\n          return;\n        }\n\n        // if is a temp server file we prevent async upload call here (as the file is already on the server)\n        if (item.origin === FileOrigin.LIMBO) {\n          dispatch('DID_COMPLETE_ITEM_PROCESSING', {\n            id: item.id,\n            error: null,\n            serverFileReference: source\n          });\n\n          return;\n        }\n\n        // id we are allowed to upload the file immidiately, lets do it\n        if (query('IS_ASYNC') && state.options.instantUpload) {\n          dispatch('REQUEST_ITEM_PROCESSING', { query: item.id });\n        }\n      },\n\n      RETRY_ITEM_LOAD: getItemByQueryFromState(state, function(item) {\n        // try loading the source one more time\n        item.retryLoad();\n      }),\n\n      REQUEST_ITEM_PROCESSING: getItemByQueryFromState(state, function(\n        item,\n        success,\n        failure\n      ) {\n        // cannot be queued (or is already queued)\n        var itemCanBeQueuedForProcessing =\n          // waiting for something\n          item.status === ItemStatus.IDLE ||\n          // processing went wrong earlier\n          item.status === ItemStatus.PROCESSING_ERROR;\n\n        // not ready to be processed\n        if (!itemCanBeQueuedForProcessing) {\n          var process = function process() {\n            setTimeout(function() {\n              dispatch('REQUEST_ITEM_PROCESSING', {\n                query: item,\n                success: success,\n                failure: failure\n              });\n            }, 32);\n          };\n\n          // if already done processing or tried to revert but didn't work, try again\n          if (\n            item.status === ItemStatus.PROCESSING_COMPLETE ||\n            item.status === ItemStatus.PROCESSING_REVERT_ERROR\n          ) {\n            item\n              .revert(\n                createRevertFunction(\n                  state.options.server.url,\n                  state.options.server.revert\n                ),\n                query('GET_FORCE_REVERT')\n              )\n              .then(process)\n              .catch(function() {}); // don't continue with processing if something went wrong\n          } else if (item.status === ItemStatus.PROCESSING) {\n            item.abortProcessing().then(process);\n          }\n\n          return;\n        }\n\n        // already queued for processing\n        if (item.status === ItemStatus.PROCESSING_QUEUED) return;\n\n        item.requestProcessing();\n\n        dispatch('DID_REQUEST_ITEM_PROCESSING', { id: item.id });\n\n        dispatch(\n          'PROCESS_ITEM',\n          { query: item, success: success, failure: failure },\n          true\n        );\n      }),\n\n      PROCESS_ITEM: getItemByQueryFromState(state, function(\n        item,\n        success,\n        failure\n      ) {\n        var maxParallelUploads = query('GET_MAX_PARALLEL_UPLOADS');\n        var totalCurrentUploads = query(\n          'GET_ITEMS_BY_STATUS',\n          ItemStatus.PROCESSING\n        ).length;\n\n        // queue and wait till queue is freed up\n        if (totalCurrentUploads === maxParallelUploads) {\n          // queue for later processing\n          state.processingQueue.push({\n            id: item.id,\n            success: success,\n            failure: failure\n          });\n\n          // stop it!\n          return;\n        }\n\n        // if was not queued or is already processing exit here\n        if (item.status === ItemStatus.PROCESSING) return;\n\n        var processNext = function processNext() {\n          // process queueud items\n          var queueEntry = state.processingQueue.shift();\n\n          // no items left\n          if (!queueEntry) return;\n\n          // get item reference\n          var id = queueEntry.id,\n            success = queueEntry.success,\n            failure = queueEntry.failure;\n          var itemReference = getItemByQuery(state.items, id);\n\n          // if item was archived while in queue, jump to next\n          if (!itemReference || itemReference.archived) {\n            processNext();\n            return;\n          }\n\n          // process queued item\n          dispatch(\n            'PROCESS_ITEM',\n            { query: id, success: success, failure: failure },\n            true\n          );\n        };\n\n        // we done function\n        item.onOnce('process-complete', function() {\n          success(createItemAPI(item));\n          processNext();\n\n          // All items processed? No errors?\n          var allItemsProcessed =\n            query('GET_ITEMS_BY_STATUS', ItemStatus.PROCESSING_COMPLETE)\n              .length === state.items.length;\n          if (allItemsProcessed) {\n            dispatch('DID_COMPLETE_ITEM_PROCESSING_ALL');\n          }\n        });\n\n        // we error function\n        item.onOnce('process-error', function(error) {\n          failure({ error: error, file: createItemAPI(item) });\n          processNext();\n        });\n\n        // start file processing\n        var options = state.options;\n        item.process(\n          createFileProcessor(\n            createProcessorFunction(\n              options.server.url,\n              options.server.process,\n              options.name,\n              {\n                chunkTransferId: item.transferId,\n                chunkServer: options.server.patch,\n                chunkUploads: options.chunkUploads,\n                chunkForce: options.chunkForce,\n                chunkSize: options.chunkSize,\n                chunkRetryDelays: options.chunkRetryDelays\n              }\n            )\n          ),\n\n          // called when the file is about to be processed so it can be piped through the transform filters\n          function(file, success, error) {\n            // allow plugins to alter the file data\n            applyFilterChain('PREPARE_OUTPUT', file, {\n              query: query,\n              item: item\n            })\n              .then(function(file) {\n                dispatch('DID_PREPARE_OUTPUT', { id: item.id, file: file });\n\n                success(file);\n              })\n              .catch(error);\n          }\n        );\n      }),\n\n      RETRY_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n        dispatch('REQUEST_ITEM_PROCESSING', { query: item });\n      }),\n\n      REQUEST_REMOVE_ITEM: getItemByQueryFromState(state, function(item) {\n        optionalPromise(\n          query('GET_BEFORE_REMOVE_FILE'),\n          createItemAPI(item)\n        ).then(function(shouldRemove) {\n          if (!shouldRemove) {\n            return;\n          }\n          dispatch('REMOVE_ITEM', { query: item });\n        });\n      }),\n\n      RELEASE_ITEM: getItemByQueryFromState(state, function(item) {\n        item.release();\n      }),\n\n      REMOVE_ITEM: getItemByQueryFromState(state, function(item, success) {\n        var removeFromView = function removeFromView() {\n          // get id reference\n          var id = item.id;\n\n          // archive the item, this does not remove it from the list\n          getItemById(state.items, id).archive();\n\n          // tell the view the item has been removed\n          dispatch('DID_REMOVE_ITEM', { error: null, id: id, item: item });\n\n          // now the list has been modified\n          listUpdated(dispatch, state);\n\n          // correctly removed\n          success(createItemAPI(item));\n        };\n\n        // if this is a local file and the server.remove function has been configured, send source there so dev can remove file from server\n        var server = state.options.server;\n        if (\n          item.origin === FileOrigin.LOCAL &&\n          server &&\n          isFunction(server.remove)\n        ) {\n          dispatch('DID_START_ITEM_REMOVE', { id: item.id });\n\n          server.remove(\n            item.source,\n            function() {\n              return removeFromView();\n            },\n            function(status) {\n              dispatch('DID_THROW_ITEM_REMOVE_ERROR', {\n                id: item.id,\n                error: createResponse('error', 0, status, null),\n                status: {\n                  main: dynamicLabel(state.options.labelFileRemoveError)(\n                    status\n                  ),\n                  sub: state.options.labelTapToRetry\n                }\n              });\n            }\n          );\n        } else {\n          removeFromView();\n        }\n      }),\n\n      ABORT_ITEM_LOAD: getItemByQueryFromState(state, function(item) {\n        item.abortLoad();\n      }),\n\n      ABORT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n        // test if is already processed\n        if (item.serverId) {\n          dispatch('REVERT_ITEM_PROCESSING', { id: item.id });\n          return;\n        }\n\n        // abort\n        item.abortProcessing().then(function() {\n          var shouldRemove = state.options.instantUpload;\n          if (shouldRemove) {\n            dispatch('REMOVE_ITEM', { query: item.id });\n          }\n        });\n      }),\n\n      REQUEST_REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function(\n        item\n      ) {\n        // not instant uploading, revert immidiately\n        if (!state.options.instantUpload) {\n          dispatch('REVERT_ITEM_PROCESSING', { query: item });\n          return;\n        }\n\n        // if we're instant uploading the file will also be removed if we revert,\n        // so if a before remove file hook is defined we need to run it now\n        var handleRevert = function handleRevert(shouldRevert) {\n          if (!shouldRevert) return;\n          dispatch('REVERT_ITEM_PROCESSING', { query: item });\n        };\n\n        var fn = query('GET_BEFORE_REMOVE_FILE');\n        if (!fn) {\n          return handleRevert(true);\n        }\n\n        var requestRemoveResult = fn(createItemAPI(item));\n        if (requestRemoveResult == null) {\n          // undefined or null\n          return handleRevert(true);\n        }\n\n        if (typeof requestRemoveResult === 'boolean') {\n          return handleRevert(requestRemoveResult);\n        }\n\n        if (typeof requestRemoveResult.then === 'function') {\n          requestRemoveResult.then(handleRevert);\n        }\n      }),\n\n      REVERT_ITEM_PROCESSING: getItemByQueryFromState(state, function(item) {\n        item\n          .revert(\n            createRevertFunction(\n              state.options.server.url,\n              state.options.server.revert\n            ),\n            query('GET_FORCE_REVERT')\n          )\n          .then(function() {\n            var shouldRemove = state.options.instantUpload || isMockItem(item);\n            if (shouldRemove) {\n              dispatch('REMOVE_ITEM', { query: item.id });\n            }\n          })\n          .catch(function() {});\n      }),\n\n      SET_OPTIONS: function SET_OPTIONS(_ref10) {\n        var options = _ref10.options;\n        forin(options, function(key, value) {\n          dispatch('SET_' + fromCamels(key, '_').toUpperCase(), {\n            value: value\n          });\n        });\n      }\n    };\n  };\n\n  var formatFilename = function formatFilename(name) {\n    return name;\n  };\n\n  var createElement$1 = function createElement(tagName) {\n    return document.createElement(tagName);\n  };\n\n  var text = function text(node, value) {\n    var textNode = node.childNodes[0];\n    if (!textNode) {\n      textNode = document.createTextNode(value);\n      node.appendChild(textNode);\n    } else if (value !== textNode.nodeValue) {\n      textNode.nodeValue = value;\n    }\n  };\n\n  var polarToCartesian = function polarToCartesian(\n    centerX,\n    centerY,\n    radius,\n    angleInDegrees\n  ) {\n    var angleInRadians = (((angleInDegrees % 360) - 90) * Math.PI) / 180.0;\n    return {\n      x: centerX + radius * Math.cos(angleInRadians),\n      y: centerY + radius * Math.sin(angleInRadians)\n    };\n  };\n\n  var describeArc = function describeArc(\n    x,\n    y,\n    radius,\n    startAngle,\n    endAngle,\n    arcSweep\n  ) {\n    var start = polarToCartesian(x, y, radius, endAngle);\n    var end = polarToCartesian(x, y, radius, startAngle);\n    return [\n      'M',\n      start.x,\n      start.y,\n      'A',\n      radius,\n      radius,\n      0,\n      arcSweep,\n      0,\n      end.x,\n      end.y\n    ].join(' ');\n  };\n\n  var percentageArc = function percentageArc(x, y, radius, from, to) {\n    var arcSweep = 1;\n    if (to > from && to - from <= 0.5) {\n      arcSweep = 0;\n    }\n    if (from > to && from - to >= 0.5) {\n      arcSweep = 0;\n    }\n    return describeArc(\n      x,\n      y,\n      radius,\n      Math.min(0.9999, from) * 360,\n      Math.min(0.9999, to) * 360,\n      arcSweep\n    );\n  };\n\n  var create = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    // start at 0\n    props.spin = false;\n    props.progress = 0;\n    props.opacity = 0;\n\n    // svg\n    var svg = createElement('svg');\n    root.ref.path = createElement('path', {\n      'stroke-width': 2,\n      'stroke-linecap': 'round'\n    });\n\n    svg.appendChild(root.ref.path);\n\n    root.ref.svg = svg;\n\n    root.appendChild(svg);\n  };\n\n  var write = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n\n    if (props.opacity === 0) {\n      return;\n    }\n\n    if (props.align) {\n      root.element.dataset.align = props.align;\n    }\n\n    // get width of stroke\n    var ringStrokeWidth = parseInt(attr(root.ref.path, 'stroke-width'), 10);\n\n    // calculate size of ring\n    var size = root.rect.element.width * 0.5;\n\n    // ring state\n    var ringFrom = 0;\n    var ringTo = 0;\n\n    // now in busy mode\n    if (props.spin) {\n      ringFrom = 0;\n      ringTo = 0.5;\n    } else {\n      ringFrom = 0;\n      ringTo = props.progress;\n    }\n\n    // get arc path\n    var coordinates = percentageArc(\n      size,\n      size,\n      size - ringStrokeWidth,\n      ringFrom,\n      ringTo\n    );\n\n    // update progress bar\n    attr(root.ref.path, 'd', coordinates);\n\n    // hide while contains 0 value\n    attr(\n      root.ref.path,\n      'stroke-opacity',\n      props.spin || props.progress > 0 ? 1 : 0\n    );\n  };\n\n  var progressIndicator = createView({\n    tag: 'div',\n    name: 'progress-indicator',\n    ignoreRectUpdate: true,\n    ignoreRect: true,\n    create: create,\n    write: write,\n    mixins: {\n      apis: ['progress', 'spin', 'align'],\n      styles: ['opacity'],\n      animations: {\n        opacity: { type: 'tween', duration: 500 },\n        progress: {\n          type: 'spring',\n          stiffness: 0.95,\n          damping: 0.65,\n          mass: 10\n        }\n      }\n    }\n  });\n\n  var create$1 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.element.innerHTML =\n      (props.icon || '') + ('<span>' + props.label + '</span>');\n\n    props.isDisabled = false;\n  };\n\n  var write$1 = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    var isDisabled = props.isDisabled;\n    var shouldDisable = root.query('GET_DISABLED') || props.opacity === 0;\n\n    if (shouldDisable && !isDisabled) {\n      props.isDisabled = true;\n      attr(root.element, 'disabled', 'disabled');\n    } else if (!shouldDisable && isDisabled) {\n      props.isDisabled = false;\n      root.element.removeAttribute('disabled');\n    }\n  };\n\n  var fileActionButton = createView({\n    tag: 'button',\n    attributes: {\n      type: 'button'\n    },\n\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'file-action-button',\n    mixins: {\n      apis: ['label'],\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: { type: 'tween', duration: 250 }\n      },\n\n      listeners: true\n    },\n\n    create: create$1,\n    write: write$1\n  });\n\n  var toNaturalFileSize = function toNaturalFileSize(bytes) {\n    var decimalSeparator =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '.';\n    // nope, no negative byte sizes\n    bytes = Math.round(Math.abs(bytes));\n\n    // just bytes\n    if (bytes < 1000) {\n      return bytes + ' bytes';\n    }\n\n    // kilobytes\n    if (bytes < MB) {\n      return Math.floor(bytes / KB) + ' KB';\n    }\n\n    // megabytes\n    if (bytes < GB) {\n      return removeDecimalsWhenZero(bytes / MB, 1, decimalSeparator) + ' MB';\n    }\n\n    // gigabytes\n    return removeDecimalsWhenZero(bytes / GB, 2, decimalSeparator) + ' GB';\n  };\n\n  var KB = 1000;\n  var MB = 1000000;\n  var GB = 1000000000;\n\n  var removeDecimalsWhenZero = function removeDecimalsWhenZero(\n    value,\n    decimalCount,\n    separator\n  ) {\n    return value\n      .toFixed(decimalCount)\n      .split('.')\n      .filter(function(part) {\n        return part !== '0';\n      })\n      .join(separator);\n  };\n\n  var create$2 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    // filename\n    var fileName = createElement$1('span');\n    fileName.className = 'filepond--file-info-main';\n    // hide for screenreaders\n    // the file is contained in a fieldset with legend that contains the filename\n    // no need to read it twice\n    attr(fileName, 'aria-hidden', 'true');\n    root.appendChild(fileName);\n    root.ref.fileName = fileName;\n\n    // filesize\n    var fileSize = createElement$1('span');\n    fileSize.className = 'filepond--file-info-sub';\n    root.appendChild(fileSize);\n    root.ref.fileSize = fileSize;\n\n    // set initial values\n    text(fileSize, root.query('GET_LABEL_FILE_WAITING_FOR_SIZE'));\n    text(fileName, formatFilename(root.query('GET_ITEM_NAME', props.id)));\n  };\n\n  var updateFile = function updateFile(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    text(\n      root.ref.fileSize,\n      toNaturalFileSize(root.query('GET_ITEM_SIZE', props.id))\n    );\n\n    text(\n      root.ref.fileName,\n      formatFilename(root.query('GET_ITEM_NAME', props.id))\n    );\n  };\n\n  var updateFileSizeOnError = function updateFileSizeOnError(_ref3) {\n    var root = _ref3.root,\n      props = _ref3.props;\n    // if size is available don't fallback to unknown size message\n    if (isInt(root.query('GET_ITEM_SIZE', props.id))) {\n      return;\n    }\n\n    text(root.ref.fileSize, root.query('GET_LABEL_FILE_SIZE_NOT_AVAILABLE'));\n  };\n\n  var fileInfo = createView({\n    name: 'file-info',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: updateFile,\n      DID_UPDATE_ITEM_META: updateFile,\n      DID_THROW_ITEM_LOAD_ERROR: updateFileSizeOnError,\n      DID_THROW_ITEM_INVALID: updateFileSizeOnError\n    }),\n\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    create: create$2,\n    mixins: {\n      styles: ['translateX', 'translateY'],\n      animations: {\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var toPercentage = function toPercentage(value) {\n    return Math.round(value * 100);\n  };\n\n  var create$3 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    // main status\n    var main = createElement$1('span');\n    main.className = 'filepond--file-status-main';\n    root.appendChild(main);\n    root.ref.main = main;\n\n    // sub status\n    var sub = createElement$1('span');\n    sub.className = 'filepond--file-status-sub';\n    root.appendChild(sub);\n    root.ref.sub = sub;\n\n    didSetItemLoadProgress({ root: root, action: { progress: null } });\n  };\n\n  var didSetItemLoadProgress = function didSetItemLoadProgress(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    var title =\n      action.progress === null\n        ? root.query('GET_LABEL_FILE_LOADING')\n        : root.query('GET_LABEL_FILE_LOADING') +\n          ' ' +\n          toPercentage(action.progress) +\n          '%';\n\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didSetItemProcessProgress = function didSetItemProcessProgress(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    var title =\n      action.progress === null\n        ? root.query('GET_LABEL_FILE_PROCESSING')\n        : root.query('GET_LABEL_FILE_PROCESSING') +\n          ' ' +\n          toPercentage(action.progress) +\n          '%';\n\n    text(root.ref.main, title);\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didRequestItemProcessing = function didRequestItemProcessing(_ref4) {\n    var root = _ref4.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_CANCEL'));\n  };\n\n  var didAbortItemProcessing = function didAbortItemProcessing(_ref5) {\n    var root = _ref5.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_ABORTED'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_RETRY'));\n  };\n\n  var didCompleteItemProcessing = function didCompleteItemProcessing(_ref6) {\n    var root = _ref6.root;\n    text(root.ref.main, root.query('GET_LABEL_FILE_PROCESSING_COMPLETE'));\n    text(root.ref.sub, root.query('GET_LABEL_TAP_TO_UNDO'));\n  };\n\n  var clear = function clear(_ref7) {\n    var root = _ref7.root;\n    text(root.ref.main, '');\n    text(root.ref.sub, '');\n  };\n\n  var error = function error(_ref8) {\n    var root = _ref8.root,\n      action = _ref8.action;\n    text(root.ref.main, action.status.main);\n    text(root.ref.sub, action.status.sub);\n  };\n\n  var fileStatus = createView({\n    name: 'file-status',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: clear,\n      DID_REVERT_ITEM_PROCESSING: clear,\n      DID_REQUEST_ITEM_PROCESSING: didRequestItemProcessing,\n      DID_ABORT_ITEM_PROCESSING: didAbortItemProcessing,\n      DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing,\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: didSetItemProcessProgress,\n      DID_UPDATE_ITEM_LOAD_PROGRESS: didSetItemLoadProgress,\n      DID_THROW_ITEM_LOAD_ERROR: error,\n      DID_THROW_ITEM_INVALID: error,\n      DID_THROW_ITEM_PROCESSING_ERROR: error,\n      DID_THROW_ITEM_PROCESSING_REVERT_ERROR: error,\n      DID_THROW_ITEM_REMOVE_ERROR: error\n    }),\n\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    create: create$3,\n    mixins: {\n      styles: ['translateX', 'translateY', 'opacity'],\n      animations: {\n        opacity: { type: 'tween', duration: 250 },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  /**\n   * Button definitions for the file view\n   */\n\n  var Buttons = {\n    AbortItemLoad: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_LOAD',\n      action: 'ABORT_ITEM_LOAD',\n      className: 'filepond--action-abort-item-load',\n      align: 'LOAD_INDICATOR_POSITION' // right\n    },\n    RetryItemLoad: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_LOAD',\n      action: 'RETRY_ITEM_LOAD',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-load',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    RemoveItem: {\n      label: 'GET_LABEL_BUTTON_REMOVE_ITEM',\n      action: 'REQUEST_REMOVE_ITEM',\n      icon: 'GET_ICON_REMOVE',\n      className: 'filepond--action-remove-item',\n      align: 'BUTTON_REMOVE_ITEM_POSITION' // left\n    },\n    ProcessItem: {\n      label: 'GET_LABEL_BUTTON_PROCESS_ITEM',\n      action: 'REQUEST_ITEM_PROCESSING',\n      icon: 'GET_ICON_PROCESS',\n      className: 'filepond--action-process-item',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    AbortItemProcessing: {\n      label: 'GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING',\n      action: 'ABORT_ITEM_PROCESSING',\n      className: 'filepond--action-abort-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    RetryItemProcessing: {\n      label: 'GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING',\n      action: 'RETRY_ITEM_PROCESSING',\n      icon: 'GET_ICON_RETRY',\n      className: 'filepond--action-retry-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    },\n    RevertItemProcessing: {\n      label: 'GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING',\n      action: 'REQUEST_REVERT_ITEM_PROCESSING',\n      icon: 'GET_ICON_UNDO',\n      className: 'filepond--action-revert-item-processing',\n      align: 'BUTTON_PROCESS_ITEM_POSITION' // right\n    }\n  };\n\n  // make a list of buttons, we can then remove buttons from this list if they're disabled\n  var ButtonKeys = [];\n  forin(Buttons, function(key) {\n    ButtonKeys.push(key);\n  });\n\n  var calculateFileInfoOffset = function calculateFileInfoOffset(root) {\n    var buttonRect = root.ref.buttonRemoveItem.rect.element;\n    return buttonRect.hidden ? null : buttonRect.width + buttonRect.left;\n  };\n\n  // Force on full pixels so text stays crips\n  var calculateFileVerticalCenterOffset = function calculateFileVerticalCenterOffset(\n    root\n  ) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.height / 4);\n  };\n  var calculateFileHorizontalCenterOffset = function calculateFileHorizontalCenterOffset(\n    root\n  ) {\n    return Math.floor(root.ref.buttonRemoveItem.rect.element.left / 2);\n  };\n\n  var getLoadIndicatorAlignment = function getLoadIndicatorAlignment(root) {\n    return root.query('GET_STYLE_LOAD_INDICATOR_POSITION');\n  };\n  var getProcessIndicatorAlignment = function getProcessIndicatorAlignment(\n    root\n  ) {\n    return root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION');\n  };\n  var getRemoveIndicatorAligment = function getRemoveIndicatorAligment(root) {\n    return root.query('GET_STYLE_BUTTON_REMOVE_ITEM_POSITION');\n  };\n\n  var DefaultStyle = {\n    buttonAbortItemLoad: { opacity: 0 },\n    buttonRetryItemLoad: { opacity: 0 },\n    buttonRemoveItem: { opacity: 0 },\n    buttonProcessItem: { opacity: 0 },\n    buttonAbortItemProcessing: { opacity: 0 },\n    buttonRetryItemProcessing: { opacity: 0 },\n    buttonRevertItemProcessing: { opacity: 0 },\n    loadProgressIndicator: { opacity: 0, align: getLoadIndicatorAlignment },\n    processProgressIndicator: {\n      opacity: 0,\n      align: getProcessIndicatorAlignment\n    },\n    processingCompleteIndicator: { opacity: 0, scaleX: 0.75, scaleY: 0.75 },\n    info: { translateX: 0, translateY: 0, opacity: 0 },\n    status: { translateX: 0, translateY: 0, opacity: 0 }\n  };\n\n  var IdleStyle = {\n    buttonRemoveItem: { opacity: 1 },\n    buttonProcessItem: { opacity: 1 },\n    info: { translateX: calculateFileInfoOffset },\n    status: { translateX: calculateFileInfoOffset }\n  };\n\n  var ProcessingStyle = {\n    buttonAbortItemProcessing: { opacity: 1 },\n    processProgressIndicator: { opacity: 1 },\n    status: { opacity: 1 }\n  };\n\n  var StyleMap = {\n    DID_THROW_ITEM_INVALID: {\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { translateX: calculateFileInfoOffset, opacity: 1 }\n    },\n\n    DID_START_ITEM_LOAD: {\n      buttonAbortItemLoad: { opacity: 1 },\n      loadProgressIndicator: { opacity: 1 },\n      status: { opacity: 1 }\n    },\n\n    DID_THROW_ITEM_LOAD_ERROR: {\n      buttonRetryItemLoad: { opacity: 1 },\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 1 }\n    },\n\n    DID_START_ITEM_REMOVE: {\n      processProgressIndicator: {\n        opacity: 1,\n        align: getRemoveIndicatorAligment\n      },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 0 }\n    },\n\n    DID_THROW_ITEM_REMOVE_ERROR: {\n      processProgressIndicator: {\n        opacity: 0,\n        align: getRemoveIndicatorAligment\n      },\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 1, translateX: calculateFileInfoOffset }\n    },\n\n    DID_LOAD_ITEM: IdleStyle,\n    DID_LOAD_LOCAL_ITEM: {\n      buttonRemoveItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { translateX: calculateFileInfoOffset }\n    },\n\n    DID_START_ITEM_PROCESSING: ProcessingStyle,\n    DID_REQUEST_ITEM_PROCESSING: ProcessingStyle,\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: ProcessingStyle,\n    DID_COMPLETE_ITEM_PROCESSING: {\n      buttonRevertItemProcessing: { opacity: 1 },\n      info: { opacity: 1 },\n      status: { opacity: 1 }\n    },\n\n    DID_THROW_ITEM_PROCESSING_ERROR: {\n      buttonRemoveItem: { opacity: 1 },\n      buttonRetryItemProcessing: { opacity: 1 },\n      status: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset }\n    },\n\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: {\n      buttonRevertItemProcessing: { opacity: 1 },\n      status: { opacity: 1 },\n      info: { opacity: 1 }\n    },\n\n    DID_ABORT_ITEM_PROCESSING: {\n      buttonRemoveItem: { opacity: 1 },\n      buttonProcessItem: { opacity: 1 },\n      info: { translateX: calculateFileInfoOffset },\n      status: { opacity: 1 }\n    },\n\n    DID_REVERT_ITEM_PROCESSING: IdleStyle\n  };\n\n  // complete indicator view\n  var processingCompleteIndicatorView = createView({\n    create: function create(_ref) {\n      var root = _ref.root;\n      root.element.innerHTML = root.query('GET_ICON_DONE');\n    },\n    name: 'processing-complete-indicator',\n    ignoreRect: true,\n    mixins: {\n      styles: ['scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        opacity: { type: 'tween', duration: 250 }\n      }\n    }\n  });\n\n  /**\n   * Creates the file view\n   */\n  var create$4 = function create(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n    var id = props.id;\n\n    // allow reverting upload\n    var allowRevert = root.query('GET_ALLOW_REVERT');\n\n    // is instant uploading, need this to determine the icon of the undo button\n    var instantUpload = root.query('GET_INSTANT_UPLOAD');\n\n    // is async set up\n    var isAsync = root.query('IS_ASYNC');\n\n    // enabled buttons array\n    var enabledButtons = isAsync\n      ? ButtonKeys.concat()\n      : ButtonKeys.filter(function(key) {\n          return !/Process/.test(key);\n        });\n\n    // remove last button (revert) if not allowed\n    if (isAsync && !allowRevert) {\n      enabledButtons.splice(-1, 1);\n      var map = StyleMap['DID_COMPLETE_ITEM_PROCESSING'];\n      map.info.translateX = calculateFileHorizontalCenterOffset;\n      map.info.translateY = calculateFileVerticalCenterOffset;\n      map.status.translateY = calculateFileVerticalCenterOffset;\n      map.processingCompleteIndicator = { opacity: 1, scaleX: 1, scaleY: 1 };\n    }\n\n    // update icon and label for revert button when instant uploading\n    if (instantUpload && allowRevert) {\n      Buttons['RevertItemProcessing'].label = 'GET_LABEL_BUTTON_REMOVE_ITEM';\n      Buttons['RevertItemProcessing'].icon = 'GET_ICON_REMOVE';\n    }\n\n    // create the button views\n    forin(Buttons, function(key, definition) {\n      // create button\n      var buttonView = root.createChildView(fileActionButton, {\n        label: root.query(definition.label),\n        icon: root.query(definition.icon),\n        opacity: 0\n      });\n\n      // should be appended?\n      if (enabledButtons.includes(key)) {\n        root.appendChildView(buttonView);\n      }\n\n      // add position attribute\n      buttonView.element.dataset.align = root.query(\n        'GET_STYLE_' + definition.align\n      );\n\n      // add class\n      buttonView.element.classList.add(definition.className);\n\n      // handle interactions\n      buttonView.on('click', function(e) {\n        e.stopPropagation();\n        root.dispatch(definition.action, { query: id });\n      });\n\n      // set reference\n      root.ref['button' + key] = buttonView;\n    });\n\n    // create file info view\n    root.ref.info = root.appendChildView(\n      root.createChildView(fileInfo, { id: id })\n    );\n\n    // create file status view\n    root.ref.status = root.appendChildView(\n      root.createChildView(fileStatus, { id: id })\n    );\n\n    // checkmark\n    root.ref.processingCompleteIndicator = root.appendChildView(\n      root.createChildView(processingCompleteIndicatorView)\n    );\n    root.ref.processingCompleteIndicator.element.dataset.align = root.query(\n      'GET_STYLE_BUTTON_PROCESS_ITEM_POSITION'\n    );\n\n    // add progress indicators\n    var loadIndicatorView = root.appendChildView(\n      root.createChildView(progressIndicator, {\n        opacity: 0,\n        align: root.query('GET_STYLE_LOAD_INDICATOR_POSITION')\n      })\n    );\n\n    loadIndicatorView.element.classList.add('filepond--load-indicator');\n    root.ref.loadProgressIndicator = loadIndicatorView;\n\n    var progressIndicatorView = root.appendChildView(\n      root.createChildView(progressIndicator, {\n        opacity: 0,\n        align: root.query('GET_STYLE_PROGRESS_INDICATOR_POSITION')\n      })\n    );\n\n    progressIndicatorView.element.classList.add('filepond--process-indicator');\n    root.ref.processProgressIndicator = progressIndicatorView;\n\n    // current active styles\n    root.ref.activeStyles = [];\n  };\n\n  var write$2 = function write(_ref3) {\n    var root = _ref3.root,\n      actions = _ref3.actions,\n      props = _ref3.props;\n\n    // route actions\n    route({ root: root, actions: actions, props: props });\n\n    // select last state change action\n    var action = actions\n      .concat()\n      .filter(function(action) {\n        return /^DID_/.test(action.type);\n      })\n      .reverse()\n      .find(function(action) {\n        return StyleMap[action.type];\n      });\n\n    // a new action happened, let's get the matching styles\n    if (action) {\n      // define new active styles\n      root.ref.activeStyles = [];\n\n      var stylesToApply = StyleMap[action.type];\n      forin(DefaultStyle, function(name, defaultStyles) {\n        // get reference to control\n        var control = root.ref[name];\n\n        // loop over all styles for this control\n        forin(defaultStyles, function(key, defaultValue) {\n          var value =\n            stylesToApply[name] &&\n            typeof stylesToApply[name][key] !== 'undefined'\n              ? stylesToApply[name][key]\n              : defaultValue;\n          root.ref.activeStyles.push({\n            control: control,\n            key: key,\n            value: value\n          });\n        });\n      });\n    }\n\n    // apply active styles to element\n    root.ref.activeStyles.forEach(function(_ref4) {\n      var control = _ref4.control,\n        key = _ref4.key,\n        value = _ref4.value;\n\n      control[key] = typeof value === 'function' ? value(root) : value;\n    });\n  };\n\n  var route = createRoute({\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING: function DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING(\n      _ref5\n    ) {\n      var root = _ref5.root,\n        action = _ref5.action;\n      root.ref.buttonAbortItemProcessing.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD: function DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD(\n      _ref6\n    ) {\n      var root = _ref6.root,\n        action = _ref6.action;\n      root.ref.buttonAbortItemLoad.label = action.value;\n    },\n    DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL: function DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL(\n      _ref7\n    ) {\n      var root = _ref7.root,\n        action = _ref7.action;\n      root.ref.buttonAbortItemRemoval.label = action.value;\n    },\n    DID_REQUEST_ITEM_PROCESSING: function DID_REQUEST_ITEM_PROCESSING(_ref8) {\n      var root = _ref8.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_LOAD: function DID_START_ITEM_LOAD(_ref9) {\n      var root = _ref9.root;\n      root.ref.loadProgressIndicator.spin = true;\n      root.ref.loadProgressIndicator.progress = 0;\n    },\n    DID_START_ITEM_REMOVE: function DID_START_ITEM_REMOVE(_ref10) {\n      var root = _ref10.root;\n      root.ref.processProgressIndicator.spin = true;\n      root.ref.processProgressIndicator.progress = 0;\n    },\n    DID_UPDATE_ITEM_LOAD_PROGRESS: function DID_UPDATE_ITEM_LOAD_PROGRESS(\n      _ref11\n    ) {\n      var root = _ref11.root,\n        action = _ref11.action;\n      root.ref.loadProgressIndicator.spin = false;\n      root.ref.loadProgressIndicator.progress = action.progress;\n    },\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: function DID_UPDATE_ITEM_PROCESS_PROGRESS(\n      _ref12\n    ) {\n      var root = _ref12.root,\n        action = _ref12.action;\n      root.ref.processProgressIndicator.spin = false;\n      root.ref.processProgressIndicator.progress = action.progress;\n    }\n  });\n\n  var file = createView({\n    create: create$4,\n    write: write$2,\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    name: 'file'\n  });\n\n  /**\n   * Creates the file view\n   */\n  var create$5 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // filename\n    root.ref.fileName = createElement$1('legend');\n    root.appendChild(root.ref.fileName);\n\n    // file appended\n    root.ref.file = root.appendChildView(\n      root.createChildView(file, { id: props.id })\n    );\n\n    // create data container\n    var dataContainer = createElement$1('input');\n    dataContainer.type = 'hidden';\n    dataContainer.name = root.query('GET_NAME');\n    dataContainer.disabled = root.query('GET_DISABLED');\n    root.ref.data = dataContainer;\n    root.appendChild(dataContainer);\n  };\n\n  var didSetDisabled = function didSetDisabled(_ref2) {\n    var root = _ref2.root;\n    root.ref.data.disabled = root.query('GET_DISABLED');\n  };\n\n  /**\n   * Data storage\n   */\n  var didLoadItem = function didLoadItem(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action,\n      props = _ref3.props;\n    root.ref.data.value = action.serverFileReference;\n\n    // updates the legend of the fieldset so screenreaders can better group buttons\n    text(\n      root.ref.fileName,\n      formatFilename(root.query('GET_ITEM_NAME', props.id))\n    );\n  };\n\n  var didRemoveItem = function didRemoveItem(_ref4) {\n    var root = _ref4.root;\n    root.ref.data.removeAttribute('value');\n  };\n\n  var didCompleteItemProcessing$1 = function didCompleteItemProcessing(_ref5) {\n    var root = _ref5.root,\n      action = _ref5.action;\n    root.ref.data.value = action.serverFileReference;\n  };\n\n  var didRevertItemProcessing = function didRevertItemProcessing(_ref6) {\n    var root = _ref6.root;\n    root.ref.data.removeAttribute('value');\n  };\n\n  var fileWrapper = createView({\n    create: create$5,\n    ignoreRect: true,\n    write: createRoute({\n      DID_SET_DISABLED: didSetDisabled,\n      DID_LOAD_ITEM: didLoadItem,\n      DID_REMOVE_ITEM: didRemoveItem,\n      DID_COMPLETE_ITEM_PROCESSING: didCompleteItemProcessing$1,\n      DID_REVERT_ITEM_PROCESSING: didRevertItemProcessing\n    }),\n\n    didCreateView: function didCreateView(root) {\n      applyFilters('CREATE_VIEW', Object.assign({}, root, { view: root }));\n    },\n    tag: 'fieldset',\n    name: 'file-wrapper'\n  });\n\n  var PANEL_SPRING_PROPS = { type: 'spring', damping: 0.6, mass: 7 };\n\n  var create$6 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    [\n      {\n        name: 'top'\n      },\n\n      {\n        name: 'center',\n        props: {\n          translateY: null,\n          scaleY: null\n        },\n\n        mixins: {\n          animations: {\n            scaleY: PANEL_SPRING_PROPS\n          },\n\n          styles: ['translateY', 'scaleY']\n        }\n      },\n\n      {\n        name: 'bottom',\n        props: {\n          translateY: null\n        },\n\n        mixins: {\n          animations: {\n            translateY: PANEL_SPRING_PROPS\n          },\n\n          styles: ['translateY']\n        }\n      }\n    ].forEach(function(section) {\n      createSection(root, section, props.name);\n    });\n\n    root.element.classList.add('filepond--' + props.name);\n\n    root.ref.scalable = null;\n  };\n\n  var createSection = function createSection(root, section, className) {\n    var viewConstructor = createView({\n      name: 'panel-' + section.name + ' filepond--' + className,\n      mixins: section.mixins,\n      ignoreRectUpdate: true\n    });\n\n    var view = root.createChildView(viewConstructor, section.props);\n\n    root.ref[section.name] = root.appendChildView(view);\n  };\n\n  var write$3 = function write(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props;\n\n    // update scalable state\n    if (root.ref.scalable === null || props.scalable !== root.ref.scalable) {\n      root.ref.scalable = isBoolean(props.scalable) ? props.scalable : true;\n      root.element.dataset.scalable = root.ref.scalable;\n    }\n\n    // no height, can't set\n    if (!props.height) return;\n\n    // get child rects\n    var topRect = root.ref.top.rect.element;\n    var bottomRect = root.ref.bottom.rect.element;\n\n    // make sure height never is smaller than bottom and top seciton heights combined (will probably never happen, but who knows)\n    var height = Math.max(topRect.height + bottomRect.height, props.height);\n\n    // offset center part\n    root.ref.center.translateY = topRect.height;\n\n    // scale center part\n    // use math ceil to prevent transparent lines because of rounding errors\n    root.ref.center.scaleY =\n      (height - topRect.height - bottomRect.height) / 100;\n\n    // offset bottom part\n    root.ref.bottom.translateY = height - bottomRect.height;\n  };\n\n  var panel = createView({\n    name: 'panel',\n    write: write$3,\n    create: create$6,\n    ignoreRect: true,\n    mixins: {\n      apis: ['height', 'scalable']\n    }\n  });\n\n  var ITEM_TRANSLATE_SPRING = {\n    type: 'spring',\n    stiffness: 0.75,\n    damping: 0.45,\n    mass: 10\n  };\n\n  var ITEM_SCALE_SPRING = 'spring';\n\n  /**\n   * Creates the file view\n   */\n  var create$7 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // select\n    root.ref.handleClick = function() {\n      return root.dispatch('DID_ACTIVATE_ITEM', { id: props.id });\n    };\n\n    // set id\n    root.element.id = 'filepond--item-' + props.id;\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // file view\n    root.ref.container = root.appendChildView(\n      root.createChildView(fileWrapper, { id: props.id })\n    );\n\n    // file panel\n    root.ref.panel = root.appendChildView(\n      root.createChildView(panel, { name: 'item-panel' })\n    );\n\n    // default start height\n    root.ref.panel.height = null;\n\n    // by default not marked for removal\n    props.markedForRemoval = false;\n  };\n\n  var StateMap = {\n    DID_START_ITEM_LOAD: 'busy',\n    DID_UPDATE_ITEM_LOAD_PROGRESS: 'loading',\n    DID_THROW_ITEM_INVALID: 'load-invalid',\n    DID_THROW_ITEM_LOAD_ERROR: 'load-error',\n    DID_LOAD_ITEM: 'idle',\n    DID_THROW_ITEM_REMOVE_ERROR: 'remove-error',\n    DID_START_ITEM_REMOVE: 'busy',\n    DID_START_ITEM_PROCESSING: 'busy',\n    DID_REQUEST_ITEM_PROCESSING: 'busy',\n    DID_UPDATE_ITEM_PROCESS_PROGRESS: 'processing',\n    DID_COMPLETE_ITEM_PROCESSING: 'processing-complete',\n    DID_THROW_ITEM_PROCESSING_ERROR: 'processing-error',\n    DID_THROW_ITEM_PROCESSING_REVERT_ERROR: 'processing-revert-error',\n    DID_ABORT_ITEM_PROCESSING: 'cancelled',\n    DID_REVERT_ITEM_PROCESSING: 'idle'\n  };\n\n  var route$1 = createRoute({\n    DID_UPDATE_PANEL_HEIGHT: function DID_UPDATE_PANEL_HEIGHT(_ref2) {\n      var root = _ref2.root,\n        action = _ref2.action;\n      var height = action.height;\n      root.height = height;\n    }\n  });\n\n  var write$4 = function write(_ref3) {\n    var root = _ref3.root,\n      actions = _ref3.actions,\n      props = _ref3.props,\n      shouldOptimize = _ref3.shouldOptimize;\n\n    // select last state change action\n    var action = actions\n      .concat()\n      .filter(function(action) {\n        return /^DID_/.test(action.type);\n      })\n      .reverse()\n      .find(function(action) {\n        return StateMap[action.type];\n      });\n\n    // no need to set same state twice\n    if (action && action.type !== props.currentState) {\n      // set current state\n      props.currentState = action.type;\n\n      // set state\n      root.element.dataset.filepondItemState =\n        StateMap[props.currentState] || '';\n    }\n\n    // route actions\n    var aspectRatio =\n      root.query('GET_ITEM_PANEL_ASPECT_RATIO') ||\n      root.query('GET_PANEL_ASPECT_RATIO');\n    if (!aspectRatio) {\n      route$1({ root: root, actions: actions, props: props });\n      if (!root.height && root.ref.container.rect.element.height > 0) {\n        root.height = root.ref.container.rect.element.height;\n      }\n    } else if (!shouldOptimize) {\n      root.height = root.rect.element.width * aspectRatio;\n    }\n\n    // sync panel height with item height\n    if (shouldOptimize) {\n      root.ref.panel.height = null;\n    }\n\n    root.ref.panel.height = root.height;\n  };\n\n  var item = createView({\n    create: create$7,\n    write: write$4,\n    destroy: function destroy(_ref4) {\n      var root = _ref4.root,\n        props = _ref4.props;\n      root.element.removeEventListener('click', root.ref.handleClick);\n      root.dispatch('RELEASE_ITEM', { query: props.id });\n    },\n    tag: 'li',\n    name: 'item',\n    mixins: {\n      apis: ['id', 'interactionMethod', 'markedForRemoval', 'spawnDate'],\n      styles: [\n        'translateX',\n        'translateY',\n        'scaleX',\n        'scaleY',\n        'opacity',\n        'height'\n      ],\n\n      animations: {\n        scaleX: ITEM_SCALE_SPRING,\n        scaleY: ITEM_SCALE_SPRING,\n        translateX: ITEM_TRANSLATE_SPRING,\n        translateY: ITEM_TRANSLATE_SPRING,\n        opacity: { type: 'tween', duration: 150 }\n      }\n    }\n  });\n\n  var getItemIndexByPosition = function getItemIndexByPosition(\n    view,\n    positionInView\n  ) {\n    if (!positionInView) return;\n\n    var horizontalSpace = view.rect.element.width;\n    var children = view.childViews;\n    var l = children.length;\n    var last = null;\n\n    // -1, don't move items to accomodate (either add to top or bottom)\n    if (l === 0 || positionInView.top < children[0].rect.element.top) return -1;\n\n    // let's get the item width\n    var item = children[0];\n    var itemRect = item.rect.element;\n    var itemHorizontalMargin = itemRect.marginLeft + itemRect.marginRight;\n    var itemWidth = itemRect.width + itemHorizontalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      for (var index = 0; index < l; index++) {\n        var child = children[index];\n        var childMid = child.rect.outer.top + child.rect.element.height * 0.5;\n        if (positionInView.top < childMid) {\n          return index;\n        }\n      }\n      return l;\n    }\n\n    // grid\n    var itemVerticalMargin = itemRect.marginTop + itemRect.marginBottom;\n    var itemHeight = itemRect.height + itemVerticalMargin;\n    for (var _index = 0; _index < l; _index++) {\n      var indexX = _index % itemsPerRow;\n      var indexY = Math.floor(_index / itemsPerRow);\n\n      var offsetX = indexX * itemWidth;\n      var offsetY = indexY * itemHeight;\n\n      var itemTop = offsetY - itemRect.marginTop;\n      var itemRight = offsetX + itemWidth;\n      var itemBottom = offsetY + itemHeight + itemRect.marginBottom;\n\n      if (positionInView.top < itemBottom && positionInView.top > itemTop) {\n        if (positionInView.left < itemRight) {\n          return _index;\n        } else if (_index !== l - 1) {\n          last = _index;\n        } else {\n          last = null;\n        }\n      }\n    }\n\n    if (last !== null) {\n      return last;\n    }\n\n    return l;\n  };\n\n  var create$8 = function create(_ref) {\n    var root = _ref.root;\n    // need to set role to list as otherwise it won't be read as a list by VoiceOver\n    attr(root.element, 'role', 'list');\n\n    root.ref.lastItemSpanwDate = Date.now();\n  };\n\n  /**\n   * Inserts a new item\n   * @param root\n   * @param action\n   */\n  var addItemView = function addItemView(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    var id = action.id,\n      index = action.index,\n      interactionMethod = action.interactionMethod;\n\n    root.ref.addIndex = index;\n\n    var now = Date.now();\n    var spawnDate = now;\n    var opacity = 1;\n\n    if (interactionMethod !== InteractionMethod.NONE) {\n      opacity = 0;\n      var cooldown = root.query('GET_ITEM_INSERT_INTERVAL');\n      var dist = now - root.ref.lastItemSpanwDate;\n      spawnDate = dist < cooldown ? now + (cooldown - dist) : now;\n    }\n\n    root.ref.lastItemSpanwDate = spawnDate;\n\n    root.appendChildView(\n      root.createChildView(\n        // view type\n        item,\n\n        // props\n        {\n          spawnDate: spawnDate,\n          id: id,\n          opacity: opacity,\n          interactionMethod: interactionMethod\n        }\n      ),\n\n      index\n    );\n  };\n\n  var moveItem = function moveItem(item, x, y) {\n    var vx =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    var vy =\n      arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n\n    item.translateX = x;\n    item.translateY = y;\n\n    if (Date.now() > item.spawnDate) {\n      // reveal element\n      if (item.opacity === 0) {\n        introItemView(item, x, y, vx, vy);\n      }\n\n      // make sure is default scale every frame\n      item.scaleX = 1;\n      item.scaleY = 1;\n      item.opacity = 1;\n    }\n  };\n\n  var introItemView = function introItemView(item, x, y, vx, vy) {\n    if (item.interactionMethod === InteractionMethod.NONE) {\n      item.translateX = null;\n      item.translateX = x;\n      item.translateY = null;\n      item.translateY = y;\n    } else if (item.interactionMethod === InteractionMethod.DROP) {\n      item.translateX = null;\n      item.translateX = x - vx * 20;\n\n      item.translateY = null;\n      item.translateY = y - vy * 10;\n\n      item.scaleX = 0.8;\n      item.scaleY = 0.8;\n    } else if (item.interactionMethod === InteractionMethod.BROWSE) {\n      item.translateY = null;\n      item.translateY = y - 30;\n    } else if (item.interactionMethod === InteractionMethod.API) {\n      item.translateX = null;\n      item.translateX = x - 30;\n      item.translateY = null;\n    }\n  };\n\n  /**\n   * Removes an existing item\n   * @param root\n   * @param action\n   */\n  var removeItemView = function removeItemView(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    var id = action.id;\n\n    // get the view matching the given id\n    var view = root.childViews.find(function(child) {\n      return child.id === id;\n    });\n\n    // if no view found, exit\n    if (!view) {\n      return;\n    }\n\n    // animate view out of view\n    view.scaleX = 0.9;\n    view.scaleY = 0.9;\n    view.opacity = 0;\n\n    // mark for removal\n    view.markedForRemoval = true;\n  };\n\n  /**\n   * Setup action routes\n   */\n  var route$2 = createRoute({\n    DID_ADD_ITEM: addItemView,\n    DID_REMOVE_ITEM: removeItemView\n  });\n\n  /**\n   * Write to view\n   * @param root\n   * @param actions\n   * @param props\n   */\n  var write$5 = function write(_ref4) {\n    var root = _ref4.root,\n      props = _ref4.props,\n      actions = _ref4.actions,\n      shouldOptimize = _ref4.shouldOptimize;\n\n    // route actions\n    route$2({ root: root, props: props, actions: actions });\n    var dragCoordinates = props.dragCoordinates;\n\n    // get index\n    var dragIndex = dragCoordinates\n      ? getItemIndexByPosition(root, dragCoordinates)\n      : null;\n\n    // available space on horizontal axis\n    var horizontalSpace = root.rect.element.width;\n\n    // only draw children that have dimensions\n    var visibleChildren = root.childViews.filter(function(child) {\n      return child.rect.element.height;\n    });\n\n    // sort based on current active items\n    var children = root\n      .query('GET_ACTIVE_ITEMS')\n      .map(function(item) {\n        return visibleChildren.find(function(child) {\n          return child.id === item.id;\n        });\n      })\n      .filter(function(item) {\n        return item;\n      });\n\n    // add index is used to reserve the dropped/added item index till the actual item is rendered\n    var addIndex = root.ref.addIndex || null;\n\n    // add index no longer needed till possibly next draw\n    root.ref.addIndex = null;\n\n    var dragIndexOffset = 0;\n    var removeIndexOffset = 0;\n    var addIndexOffset = 0;\n\n    if (children.length === 0) return;\n\n    var childRect = children[0].rect.element;\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      var offsetY = 0;\n      var dragOffset = 0;\n\n      children.forEach(function(child, index) {\n        if (dragIndex) {\n          var dist = index - dragIndex;\n          if (dist === -2) {\n            dragOffset = -itemVerticalMargin * 0.25;\n          } else if (dist === -1) {\n            dragOffset = -itemVerticalMargin * 0.75;\n          } else if (dist === 0) {\n            dragOffset = itemVerticalMargin * 0.75;\n          } else if (dist === 1) {\n            dragOffset = itemVerticalMargin * 0.25;\n          } else {\n            dragOffset = 0;\n          }\n        }\n\n        if (shouldOptimize) {\n          child.translateX = null;\n          child.translateY = null;\n        }\n\n        if (!child.markedForRemoval) {\n          moveItem(child, 0, offsetY + dragOffset);\n        }\n\n        var itemHeight = child.rect.element.height + itemVerticalMargin;\n\n        var visualHeight =\n          itemHeight * (child.markedForRemoval ? child.opacity : 1);\n\n        offsetY += visualHeight;\n      });\n    }\n    // grid\n    else {\n      var prevX = 0;\n      var prevY = 0;\n\n      children.forEach(function(child, index) {\n        if (index === dragIndex) {\n          dragIndexOffset = 1;\n        }\n\n        if (index === addIndex) {\n          addIndexOffset += 1;\n        }\n\n        if (child.markedForRemoval && child.opacity < 0.5) {\n          removeIndexOffset -= 1;\n        }\n\n        var visualIndex =\n          index + addIndexOffset + dragIndexOffset + removeIndexOffset;\n\n        var indexX = visualIndex % itemsPerRow;\n        var indexY = Math.floor(visualIndex / itemsPerRow);\n\n        var offsetX = indexX * itemWidth;\n        var offsetY = indexY * itemHeight;\n\n        var vectorX = Math.sign(offsetX - prevX);\n        var vectorY = Math.sign(offsetY - prevY);\n\n        prevX = offsetX;\n        prevY = offsetY;\n\n        if (child.markedForRemoval) return;\n\n        if (shouldOptimize) {\n          child.translateX = null;\n          child.translateY = null;\n        }\n\n        moveItem(child, offsetX, offsetY, vectorX, vectorY);\n      });\n    }\n  };\n\n  /**\n   * Filters actions that are meant specifically for a certain child of the list\n   * @param child\n   * @param actions\n   */\n  var filterSetItemActions = function filterSetItemActions(child, actions) {\n    return actions.filter(function(action) {\n      // if action has an id, filter out actions that don't have this child id\n      if (action.data && action.data.id) {\n        return child.id === action.data.id;\n      }\n\n      // allow all other actions\n      return true;\n    });\n  };\n\n  var list = createView({\n    create: create$8,\n    write: write$5,\n    tag: 'ul',\n    name: 'list',\n    didWriteView: function didWriteView(_ref5) {\n      var root = _ref5.root;\n      root.childViews\n        .filter(function(view) {\n          return view.markedForRemoval && view.opacity === 0 && view.resting;\n        })\n        .forEach(function(view) {\n          view._destroy();\n          root.removeChildView(view);\n        });\n    },\n    filterFrameActionsForChild: filterSetItemActions,\n    mixins: {\n      apis: ['dragCoordinates']\n    }\n  });\n\n  var create$9 = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.ref.list = root.appendChildView(root.createChildView(list));\n    props.dragCoordinates = null;\n    props.overflowing = false;\n  };\n\n  var storeDragCoordinates = function storeDragCoordinates(_ref2) {\n    var root = _ref2.root,\n      props = _ref2.props,\n      action = _ref2.action;\n    if (!root.query('GET_ITEM_INSERT_LOCATION_FREEDOM')) return;\n    props.dragCoordinates = {\n      left: action.position.scopeLeft - root.ref.list.rect.element.left,\n      top:\n        action.position.scopeTop -\n        (root.rect.outer.top +\n          root.rect.element.marginTop +\n          root.rect.element.scrollTop)\n    };\n  };\n\n  var clearDragCoordinates = function clearDragCoordinates(_ref3) {\n    var props = _ref3.props;\n    props.dragCoordinates = null;\n  };\n\n  var route$3 = createRoute({\n    DID_DRAG: storeDragCoordinates,\n    DID_END_DRAG: clearDragCoordinates\n  });\n\n  var write$6 = function write(_ref4) {\n    var root = _ref4.root,\n      props = _ref4.props,\n      actions = _ref4.actions;\n\n    // route actions\n    route$3({ root: root, props: props, actions: actions });\n\n    // current drag position\n    root.ref.list.dragCoordinates = props.dragCoordinates;\n\n    // if currently overflowing but no longer received overflow\n    if (props.overflowing && !props.overflow) {\n      props.overflowing = false;\n\n      // reset overflow state\n      root.element.dataset.state = '';\n      root.height = null;\n    }\n\n    // if is not overflowing currently but does receive overflow value\n    if (props.overflow) {\n      var newHeight = Math.round(props.overflow);\n      if (newHeight !== root.height) {\n        props.overflowing = true;\n        root.element.dataset.state = 'overflow';\n        root.height = newHeight;\n      }\n    }\n  };\n\n  var listScroller = createView({\n    create: create$9,\n    write: write$6,\n    name: 'list-scroller',\n    mixins: {\n      apis: ['overflow', 'dragCoordinates'],\n      styles: ['height', 'translateY'],\n      animations: {\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var attrToggle = function attrToggle(element, name, state) {\n    var enabledValue =\n      arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : '';\n    if (state) {\n      attr(element, name, enabledValue);\n    } else {\n      element.removeAttribute(name);\n    }\n  };\n\n  var resetFileInput = function resetFileInput(input) {\n    // no value, no need to reset\n    if (!input || input.value === '') {\n      return;\n    }\n\n    try {\n      // for modern browsers\n      input.value = '';\n    } catch (err) {}\n\n    // for IE10\n    if (input.value) {\n      // quickly append input to temp form and reset form\n      var form = createElement$1('form');\n      var parentNode = input.parentNode;\n      var ref = input.nextSibling;\n      form.appendChild(input);\n      form.reset();\n\n      // re-inject input where it originally was\n      if (ref) {\n        parentNode.insertBefore(input, ref);\n      } else {\n        parentNode.appendChild(input);\n      }\n    }\n  };\n\n  var create$a = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // set id so can be referenced from outside labels\n    root.element.id = 'filepond--browser-' + props.id;\n\n    // set name of element (is removed when a value is set)\n    attr(root.element, 'name', root.query('GET_NAME'));\n\n    // we have to link this element to the status element\n    attr(root.element, 'aria-controls', 'filepond--assistant-' + props.id);\n\n    // set label, we use labelled by as otherwise the screenreader does not read the \"browse\" text in the label (as it has tabindex: 0)\n    attr(root.element, 'aria-labelledby', 'filepond--drop-label-' + props.id);\n\n    // handle changes to the input field\n    root.ref.handleChange = function(e) {\n      if (!root.element.value) {\n        return;\n      }\n\n      // extract files\n      var files = Array.from(root.element.files);\n\n      // we add a little delay so the OS file select window can move out of the way before we add our file\n      setTimeout(function() {\n        // load files\n        props.onload(files);\n\n        // reset input, it's just for exposing a method to drop files, should not retain any state\n        resetFileInput(root.element);\n      }, 250);\n    };\n    root.element.addEventListener('change', root.ref.handleChange);\n  };\n\n  var setAcceptedFileTypes = function setAcceptedFileTypes(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    attrToggle(\n      root.element,\n      'accept',\n      !!action.value,\n      action.value ? action.value.join(',') : ''\n    );\n  };\n\n  var toggleAllowMultiple = function toggleAllowMultiple(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    attrToggle(root.element, 'multiple', action.value);\n  };\n\n  var toggleDisabled = function toggleDisabled(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    var isDisabled = root.query('GET_DISABLED');\n    var doesAllowBrowse = root.query('GET_ALLOW_BROWSE');\n    var disableField = isDisabled || !doesAllowBrowse;\n    attrToggle(root.element, 'disabled', disableField);\n  };\n\n  var toggleRequired = function toggleRequired(_ref5) {\n    var root = _ref5.root,\n      action = _ref5.action;\n    // want to remove required, always possible\n    if (!action.value) {\n      attrToggle(root.element, 'required', false);\n    }\n    // if want to make required, only possible when zero items\n    else if (root.query('GET_TOTAL_ITEMS') === 0) {\n      attrToggle(root.element, 'required', true);\n    }\n  };\n\n  var setCaptureMethod = function setCaptureMethod(_ref6) {\n    var root = _ref6.root,\n      action = _ref6.action;\n    attrToggle(\n      root.element,\n      'capture',\n      !!action.value,\n      action.value === true ? '' : action.value\n    );\n  };\n\n  var updateRequiredStatus = function updateRequiredStatus(_ref7) {\n    var root = _ref7.root;\n    var element = root.element;\n    // always remove the required attribute when more than zero items\n    if (root.query('GET_TOTAL_ITEMS') > 0) {\n      attrToggle(element, 'required', false);\n      attrToggle(element, 'name', false);\n    } else {\n      // add name attribute\n      attrToggle(element, 'name', true, root.query('GET_NAME'));\n\n      // remove any validation messages\n      var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n      if (shouldCheckValidity) {\n        element.setCustomValidity('');\n      }\n\n      // we only add required if the field has been deemed required\n      if (root.query('GET_REQUIRED')) {\n        attrToggle(element, 'required', true);\n      }\n    }\n  };\n\n  var updateFieldValidityStatus = function updateFieldValidityStatus(_ref8) {\n    var root = _ref8.root;\n    var shouldCheckValidity = root.query('GET_CHECK_VALIDITY');\n    if (!shouldCheckValidity) return;\n    root.element.setCustomValidity(root.query('GET_LABEL_INVALID_FIELD'));\n  };\n\n  var browser = createView({\n    tag: 'input',\n    name: 'browser',\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    attributes: {\n      type: 'file'\n    },\n\n    create: create$a,\n    destroy: function destroy(_ref9) {\n      var root = _ref9.root;\n      root.element.removeEventListener('change', root.ref.handleChange);\n    },\n    write: createRoute({\n      DID_LOAD_ITEM: updateRequiredStatus,\n      DID_REMOVE_ITEM: updateRequiredStatus,\n      DID_THROW_ITEM_INVALID: updateFieldValidityStatus,\n\n      DID_SET_DISABLED: toggleDisabled,\n      DID_SET_ALLOW_BROWSE: toggleDisabled,\n      DID_SET_ALLOW_MULTIPLE: toggleAllowMultiple,\n      DID_SET_ACCEPTED_FILE_TYPES: setAcceptedFileTypes,\n      DID_SET_CAPTURE_METHOD: setCaptureMethod,\n      DID_SET_REQUIRED: toggleRequired\n    })\n  });\n\n  var Key = {\n    ENTER: 13,\n    SPACE: 32\n  };\n\n  var create$b = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // create the label and link it to the file browser\n    var label = createElement$1('label');\n    attr(label, 'for', 'filepond--browser-' + props.id);\n\n    // use for labeling file input (aria-labelledby on file input)\n    attr(label, 'id', 'filepond--drop-label-' + props.id);\n\n    // hide the label for screenreaders, the input element will read the contents of the label when it's focussed. If we don't set aria-hidden the screenreader will also navigate the contents of the label separately from the input.\n    attr(label, 'aria-hidden', 'true');\n\n    // handle keys\n    root.ref.handleKeyDown = function(e) {\n      var isActivationKey = e.keyCode === Key.ENTER || e.keyCode === Key.SPACE;\n      if (!isActivationKey) return;\n      // stops from triggering the element a second time\n      e.preventDefault();\n\n      // click link (will then in turn activate file input)\n      root.ref.label.click();\n    };\n\n    root.ref.handleClick = function(e) {\n      var isLabelClick = e.target === label || label.contains(e.target);\n\n      // don't want to click twice\n      if (isLabelClick) return;\n\n      // click link (will then in turn activate file input)\n      root.ref.label.click();\n    };\n\n    // attach events\n    label.addEventListener('keydown', root.ref.handleKeyDown);\n    root.element.addEventListener('click', root.ref.handleClick);\n\n    // update\n    updateLabelValue(label, props.caption);\n\n    // add!\n    root.appendChild(label);\n    root.ref.label = label;\n  };\n\n  var updateLabelValue = function updateLabelValue(label, value) {\n    label.innerHTML = value;\n    var clickable = label.querySelector('.filepond--label-action');\n    if (clickable) {\n      attr(clickable, 'tabindex', '0');\n    }\n    return value;\n  };\n\n  var dropLabel = createView({\n    name: 'drop-label',\n    ignoreRect: true,\n    create: create$b,\n    destroy: function destroy(_ref2) {\n      var root = _ref2.root;\n      root.ref.label.addEventListener('keydown', root.ref.handleKeyDown);\n      root.element.removeEventListener('click', root.ref.handleClick);\n    },\n    write: createRoute({\n      DID_SET_LABEL_IDLE: function DID_SET_LABEL_IDLE(_ref3) {\n        var root = _ref3.root,\n          action = _ref3.action;\n        updateLabelValue(root.ref.label, action.value);\n      }\n    }),\n\n    mixins: {\n      styles: ['opacity', 'translateX', 'translateY'],\n      animations: {\n        opacity: { type: 'tween', duration: 150 },\n        translateX: 'spring',\n        translateY: 'spring'\n      }\n    }\n  });\n\n  var blob = createView({\n    name: 'drip-blob',\n    ignoreRect: true,\n    mixins: {\n      styles: ['translateX', 'translateY', 'scaleX', 'scaleY', 'opacity'],\n      animations: {\n        scaleX: 'spring',\n        scaleY: 'spring',\n        translateX: 'spring',\n        translateY: 'spring',\n        opacity: { type: 'tween', duration: 250 }\n      }\n    }\n  });\n\n  var addBlob = function addBlob(_ref) {\n    var root = _ref.root;\n    var centerX = root.rect.element.width * 0.5;\n    var centerY = root.rect.element.height * 0.5;\n\n    root.ref.blob = root.appendChildView(\n      root.createChildView(blob, {\n        opacity: 0,\n        scaleX: 2.5,\n        scaleY: 2.5,\n        translateX: centerX,\n        translateY: centerY\n      })\n    );\n  };\n\n  var moveBlob = function moveBlob(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    if (!root.ref.blob) {\n      addBlob({ root: root });\n      return;\n    }\n\n    root.ref.blob.translateX = action.position.scopeLeft;\n    root.ref.blob.translateY = action.position.scopeTop;\n    root.ref.blob.scaleX = 1;\n    root.ref.blob.scaleY = 1;\n    root.ref.blob.opacity = 1;\n  };\n\n  var hideBlob = function hideBlob(_ref3) {\n    var root = _ref3.root;\n    if (!root.ref.blob) {\n      return;\n    }\n    root.ref.blob.opacity = 0;\n  };\n\n  var explodeBlob = function explodeBlob(_ref4) {\n    var root = _ref4.root;\n    if (!root.ref.blob) {\n      return;\n    }\n    root.ref.blob.scaleX = 2.5;\n    root.ref.blob.scaleY = 2.5;\n    root.ref.blob.opacity = 0;\n  };\n\n  var write$7 = function write(_ref5) {\n    var root = _ref5.root,\n      props = _ref5.props,\n      actions = _ref5.actions;\n    route$4({ root: root, props: props, actions: actions });\n    var blob = root.ref.blob;\n\n    if (actions.length === 0 && blob && blob.opacity === 0) {\n      root.removeChildView(blob);\n      root.ref.blob = null;\n    }\n  };\n\n  var route$4 = createRoute({\n    DID_DRAG: moveBlob,\n    DID_DROP: explodeBlob,\n    DID_END_DRAG: hideBlob\n  });\n\n  var drip = createView({\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    name: 'drip',\n    write: write$7\n  });\n\n  var getRootNode = function getRootNode(element) {\n    return 'getRootNode' in element ? element.getRootNode() : document;\n  };\n\n  var images = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'tiff'];\n  var text$1 = ['css', 'csv', 'html', 'txt'];\n  var map = {\n    zip: 'zip|compressed',\n    epub: 'application/epub+zip'\n  };\n\n  var guesstimateMimeType = function guesstimateMimeType() {\n    var extension =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n    extension = extension.toLowerCase();\n    if (images.includes(extension)) {\n      return (\n        'image/' +\n        (extension === 'jpg'\n          ? 'jpeg'\n          : extension === 'svg'\n          ? 'svg+xml'\n          : extension)\n      );\n    }\n    if (text$1.includes(extension)) {\n      return 'text/' + extension;\n    }\n    return map[extension] || null;\n  };\n\n  var requestDataTransferItems = function requestDataTransferItems(\n    dataTransfer\n  ) {\n    return new Promise(function(resolve, reject) {\n      // try to get links from transfer, if found we'll exit immidiately (unless a file is in the dataTransfer as well, this is because Firefox could represent the file as a URL and a file object at the same time)\n      var links = getLinks(dataTransfer);\n      if (links.length && !hasFiles(dataTransfer)) {\n        return resolve(links);\n      }\n      // try to get files from the transfer\n      getFiles(dataTransfer).then(resolve);\n    });\n  };\n\n  /**\n   * Test if datatransfer has files\n   */\n  var hasFiles = function hasFiles(dataTransfer) {\n    if (dataTransfer.files) return dataTransfer.files.length > 0;\n    return false;\n  };\n\n  /**\n   * Extracts files from a DataTransfer object\n   */\n  var getFiles = function getFiles(dataTransfer) {\n    return new Promise(function(resolve, reject) {\n      // get the transfer items as promises\n      var promisedFiles = (dataTransfer.items\n        ? Array.from(dataTransfer.items)\n        : []\n      )\n        // only keep file system items (files and directories)\n        .filter(function(item) {\n          return isFileSystemItem(item);\n        })\n\n        // map each item to promise\n        .map(function(item) {\n          return getFilesFromItem(item);\n        });\n\n      // if is empty, see if we can extract some info from the files property as a fallback\n      if (!promisedFiles.length) {\n        // TODO: test for directories (should not be allowed)\n        // Use FileReader, problem is that the files property gets lost in the process\n\n        resolve(dataTransfer.files ? Array.from(dataTransfer.files) : []);\n        return;\n      }\n\n      // done!\n      Promise.all(promisedFiles)\n        .then(function(returnedFileGroups) {\n          // flatten groups\n          var files = [];\n          returnedFileGroups.forEach(function(group) {\n            files.push.apply(files, group);\n          });\n\n          // done (filter out empty files)!\n          resolve(\n            files.filter(function(file) {\n              return file;\n            })\n          );\n        })\n        .catch(console.error);\n    });\n  };\n\n  var isFileSystemItem = function isFileSystemItem(item) {\n    if (isEntry(item)) {\n      var entry = getAsEntry(item);\n      if (entry) {\n        return entry.isFile || entry.isDirectory;\n      }\n    }\n    return item.kind === 'file';\n  };\n\n  var getFilesFromItem = function getFilesFromItem(item) {\n    return new Promise(function(resolve, reject) {\n      if (isDirectoryEntry(item)) {\n        getFilesInDirectory(getAsEntry(item))\n          .then(resolve)\n          .catch(reject);\n        return;\n      }\n\n      resolve([item.getAsFile()]);\n    });\n  };\n\n  var getFilesInDirectory = function getFilesInDirectory(entry) {\n    return new Promise(function(resolve, reject) {\n      var files = [];\n\n      // the total entries to read\n      var dirCounter = 0;\n      var fileCounter = 0;\n\n      var resolveIfDone = function resolveIfDone() {\n        if (fileCounter === 0 && dirCounter === 0) {\n          resolve(files);\n        }\n      };\n\n      // the recursive function\n      var readEntries = function readEntries(dirEntry) {\n        dirCounter++;\n\n        var directoryReader = dirEntry.createReader();\n\n        // directories are returned in batches, we need to process all batches before we're done\n        var readBatch = function readBatch() {\n          directoryReader.readEntries(function(entries) {\n            if (entries.length === 0) {\n              dirCounter--;\n              resolveIfDone();\n              return;\n            }\n\n            entries.forEach(function(entry) {\n              // recursively read more directories\n              if (entry.isDirectory) {\n                readEntries(entry);\n              } else {\n                // read as file\n                fileCounter++;\n\n                entry.file(function(file) {\n                  files.push(correctMissingFileType(file));\n                  fileCounter--;\n                  resolveIfDone();\n                });\n              }\n            });\n\n            // try to get next batch of files\n            readBatch();\n          }, reject);\n        };\n\n        // read first batch of files\n        readBatch();\n      };\n\n      // go!\n      readEntries(entry);\n    });\n  };\n\n  var correctMissingFileType = function correctMissingFileType(file) {\n    if (file.type.length) return file;\n    var date = file.lastModifiedDate;\n    var name = file.name;\n    file = file.slice(\n      0,\n      file.size,\n      guesstimateMimeType(getExtensionFromFilename(file.name))\n    );\n    file.name = name;\n    file.lastModifiedDate = date;\n    return file;\n  };\n\n  var isDirectoryEntry = function isDirectoryEntry(item) {\n    return isEntry(item) && (getAsEntry(item) || {}).isDirectory;\n  };\n\n  var isEntry = function isEntry(item) {\n    return 'webkitGetAsEntry' in item;\n  };\n\n  var getAsEntry = function getAsEntry(item) {\n    return item.webkitGetAsEntry();\n  };\n\n  /**\n   * Extracts links from a DataTransfer object\n   */\n  var getLinks = function getLinks(dataTransfer) {\n    var links = [];\n    try {\n      // look in meta data property\n      links = getLinksFromTransferMetaData(dataTransfer);\n      if (links.length) {\n        return links;\n      }\n      links = getLinksFromTransferURLData(dataTransfer);\n    } catch (e) {\n      // nope nope nope (probably IE trouble)\n    }\n    return links;\n  };\n\n  var getLinksFromTransferURLData = function getLinksFromTransferURLData(\n    dataTransfer\n  ) {\n    var data = dataTransfer.getData('url');\n    if (typeof data === 'string' && data.length) {\n      return [data];\n    }\n    return [];\n  };\n\n  var getLinksFromTransferMetaData = function getLinksFromTransferMetaData(\n    dataTransfer\n  ) {\n    var data = dataTransfer.getData('text/html');\n    if (typeof data === 'string' && data.length) {\n      var matches = data.match(/src\\s*=\\s*\"(.+?)\"/);\n      if (matches) {\n        return [matches[1]];\n      }\n    }\n    return [];\n  };\n\n  var dragNDropObservers = [];\n\n  var eventPosition = function eventPosition(e) {\n    return {\n      pageLeft: e.pageX,\n      pageTop: e.pageY,\n      scopeLeft: e.offsetX || e.layerX,\n      scopeTop: e.offsetY || e.layerY\n    };\n  };\n\n  var createDragNDropClient = function createDragNDropClient(\n    element,\n    scopeToObserve,\n    filterElement\n  ) {\n    var observer = getDragNDropObserver(scopeToObserve);\n\n    var client = {\n      element: element,\n      filterElement: filterElement,\n      state: null,\n      ondrop: function ondrop() {},\n      onenter: function onenter() {},\n      ondrag: function ondrag() {},\n      onexit: function onexit() {},\n      onload: function onload() {},\n      allowdrop: function allowdrop() {}\n    };\n\n    client.destroy = observer.addListener(client);\n\n    return client;\n  };\n\n  var getDragNDropObserver = function getDragNDropObserver(element) {\n    // see if already exists, if so, return\n    var observer = dragNDropObservers.find(function(item) {\n      return item.element === element;\n    });\n    if (observer) {\n      return observer;\n    }\n\n    // create new observer, does not yet exist for this element\n    var newObserver = createDragNDropObserver(element);\n    dragNDropObservers.push(newObserver);\n    return newObserver;\n  };\n\n  var createDragNDropObserver = function createDragNDropObserver(element) {\n    var clients = [];\n\n    var routes = {\n      dragenter: dragenter,\n      dragover: dragover,\n      dragleave: dragleave,\n      drop: drop\n    };\n\n    var handlers = {};\n\n    forin(routes, function(event, createHandler) {\n      handlers[event] = createHandler(element, clients);\n      element.addEventListener(event, handlers[event], false);\n    });\n\n    var observer = {\n      element: element,\n      addListener: function addListener(client) {\n        // add as client\n        clients.push(client);\n\n        // return removeListener function\n        return function() {\n          // remove client\n          clients.splice(clients.indexOf(client), 1);\n\n          // if no more clients, clean up observer\n          if (clients.length === 0) {\n            dragNDropObservers.splice(dragNDropObservers.indexOf(observer), 1);\n\n            forin(routes, function(event) {\n              element.removeEventListener(event, handlers[event], false);\n            });\n          }\n        };\n      }\n    };\n\n    return observer;\n  };\n\n  var elementFromPoint = function elementFromPoint(root, point) {\n    if (!('elementFromPoint' in root)) {\n      root = document;\n    }\n    return root.elementFromPoint(point.x, point.y);\n  };\n\n  var isEventTarget = function isEventTarget(e, target) {\n    // get root\n    var root = getRootNode(target);\n\n    // get element at position\n    // if root is not actual shadow DOM and does not have elementFromPoint method, use the one on document\n    var elementAtPosition = elementFromPoint(root, {\n      x: e.pageX - window.pageXOffset,\n      y: e.pageY - window.pageYOffset\n    });\n\n    // test if target is the element or if one of its children is\n    return elementAtPosition === target || target.contains(elementAtPosition);\n  };\n\n  var initialTarget = null;\n\n  var setDropEffect = function setDropEffect(dataTransfer, effect) {\n    // is in try catch as IE11 will throw error if not\n    try {\n      dataTransfer.dropEffect = effect;\n    } catch (e) {}\n  };\n\n  var dragenter = function dragenter(root, clients) {\n    return function(e) {\n      e.preventDefault();\n\n      initialTarget = e.target;\n\n      clients.forEach(function(client) {\n        var element = client.element,\n          onenter = client.onenter;\n\n        if (isEventTarget(e, element)) {\n          client.state = 'enter';\n\n          // fire enter event\n          onenter(eventPosition(e));\n        }\n      });\n    };\n  };\n\n  var dragover = function dragover(root, clients) {\n    return function(e) {\n      e.preventDefault();\n\n      var dataTransfer = e.dataTransfer;\n\n      requestDataTransferItems(dataTransfer).then(function(items) {\n        var overDropTarget = false;\n\n        clients.some(function(client) {\n          var filterElement = client.filterElement,\n            element = client.element,\n            onenter = client.onenter,\n            onexit = client.onexit,\n            ondrag = client.ondrag,\n            allowdrop = client.allowdrop;\n\n          // by default we can drop\n          setDropEffect(dataTransfer, 'copy');\n\n          // allow transfer of these items\n          var allowsTransfer = allowdrop(items);\n\n          // only used when can be dropped on page\n          if (!allowsTransfer) {\n            setDropEffect(dataTransfer, 'none');\n            return;\n          }\n\n          // targetting this client\n          if (isEventTarget(e, element)) {\n            overDropTarget = true;\n\n            // had no previous state, means we are entering this client\n            if (client.state === null) {\n              client.state = 'enter';\n              onenter(eventPosition(e));\n              return;\n            }\n\n            // now over element (no matter if it allows the drop or not)\n            client.state = 'over';\n\n            // needs to allow transfer\n            if (filterElement && !allowsTransfer) {\n              setDropEffect(dataTransfer, 'none');\n              return;\n            }\n\n            // dragging\n            ondrag(eventPosition(e));\n          } else {\n            // should be over an element to drop\n            if (filterElement && !overDropTarget) {\n              setDropEffect(dataTransfer, 'none');\n            }\n\n            // might have just left this client?\n            if (client.state) {\n              client.state = null;\n              onexit(eventPosition(e));\n            }\n          }\n        });\n      });\n    };\n  };\n\n  var drop = function drop(root, clients) {\n    return function(e) {\n      e.preventDefault();\n\n      var dataTransfer = e.dataTransfer;\n\n      requestDataTransferItems(dataTransfer).then(function(items) {\n        clients.forEach(function(client) {\n          var filterElement = client.filterElement,\n            element = client.element,\n            ondrop = client.ondrop,\n            onexit = client.onexit,\n            allowdrop = client.allowdrop;\n\n          client.state = null;\n\n          // if we're filtering on element we need to be over the element to drop\n          if (filterElement && !isEventTarget(e, element)) return;\n\n          // no transfer for this client\n          if (!allowdrop(items)) return onexit(eventPosition(e));\n\n          // we can drop these items on this client\n          ondrop(eventPosition(e), items);\n        });\n      });\n    };\n  };\n\n  var dragleave = function dragleave(root, clients) {\n    return function(e) {\n      if (initialTarget !== e.target) {\n        return;\n      }\n\n      clients.forEach(function(client) {\n        var onexit = client.onexit;\n\n        client.state = null;\n\n        onexit(eventPosition(e));\n      });\n    };\n  };\n\n  var createHopper = function createHopper(scope, validateItems, options) {\n    // is now hopper scope\n    scope.classList.add('filepond--hopper');\n\n    // shortcuts\n    var catchesDropsOnPage = options.catchesDropsOnPage,\n      requiresDropOnElement = options.requiresDropOnElement,\n      _options$filterItems = options.filterItems,\n      filterItems =\n        _options$filterItems === void 0\n          ? function(items) {\n              return items;\n            }\n          : _options$filterItems;\n\n    // create a dnd client\n    var client = createDragNDropClient(\n      scope,\n      catchesDropsOnPage ? document.documentElement : scope,\n      requiresDropOnElement\n    );\n\n    // current client state\n    var lastState = '';\n    var currentState = '';\n\n    // determines if a file may be dropped\n    client.allowdrop = function(items) {\n      // TODO: if we can, throw error to indicate the items cannot by dropped\n\n      return validateItems(filterItems(items));\n    };\n\n    client.ondrop = function(position, items) {\n      var filteredItems = filterItems(items);\n\n      if (!validateItems(filteredItems)) {\n        api.ondragend(position);\n        return;\n      }\n\n      currentState = 'drag-drop';\n\n      api.onload(filteredItems, position);\n    };\n\n    client.ondrag = function(position) {\n      api.ondrag(position);\n    };\n\n    client.onenter = function(position) {\n      currentState = 'drag-over';\n\n      api.ondragstart(position);\n    };\n\n    client.onexit = function(position) {\n      currentState = 'drag-exit';\n\n      api.ondragend(position);\n    };\n\n    var api = {\n      updateHopperState: function updateHopperState() {\n        if (lastState !== currentState) {\n          scope.dataset.hopperState = currentState;\n          lastState = currentState;\n        }\n      },\n      onload: function onload() {},\n      ondragstart: function ondragstart() {},\n      ondrag: function ondrag() {},\n      ondragend: function ondragend() {},\n      destroy: function destroy() {\n        // destroy client\n        client.destroy();\n      }\n    };\n\n    return api;\n  };\n\n  var listening = false;\n  var listeners$1 = [];\n\n  var handlePaste = function handlePaste(e) {\n    requestDataTransferItems(e.clipboardData).then(function(files) {\n      // no files received\n      if (!files.length) {\n        return;\n      }\n\n      // notify listeners of received files\n      listeners$1.forEach(function(listener) {\n        return listener(files);\n      });\n    });\n  };\n\n  var listen = function listen(cb) {\n    // can't add twice\n    if (listeners$1.includes(cb)) {\n      return;\n    }\n\n    // add initial listener\n    listeners$1.push(cb);\n\n    // setup paste listener for entire page\n    if (listening) {\n      return;\n    }\n\n    listening = true;\n    document.addEventListener('paste', handlePaste);\n  };\n\n  var unlisten = function unlisten(listener) {\n    arrayRemove(listeners$1, listeners$1.indexOf(listener));\n\n    // clean up\n    if (listeners$1.length === 0) {\n      document.removeEventListener('paste', handlePaste);\n      listening = false;\n    }\n  };\n\n  var createPaster = function createPaster() {\n    var cb = function cb(files) {\n      api.onload(files);\n    };\n\n    var api = {\n      destroy: function destroy() {\n        unlisten(cb);\n      },\n      onload: function onload() {}\n    };\n\n    listen(cb);\n\n    return api;\n  };\n\n  /**\n   * Creates the file view\n   */\n  var create$c = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n    root.element.id = 'filepond--assistant-' + props.id;\n    attr(root.element, 'role', 'status');\n    attr(root.element, 'aria-live', 'polite');\n    attr(root.element, 'aria-relevant', 'additions');\n  };\n\n  var addFilesNotificationTimeout = null;\n  var notificationClearTimeout = null;\n\n  var filenames = [];\n\n  var assist = function assist(root, message) {\n    root.element.textContent = message;\n  };\n\n  var clear$1 = function clear(root) {\n    root.element.textContent = '';\n  };\n\n  var listModified = function listModified(root, filename, label) {\n    var total = root.query('GET_TOTAL_ITEMS');\n    assist(\n      root,\n      label +\n        ' ' +\n        filename +\n        ', ' +\n        total +\n        ' ' +\n        (total === 1\n          ? root.query('GET_LABEL_FILE_COUNT_SINGULAR')\n          : root.query('GET_LABEL_FILE_COUNT_PLURAL'))\n    );\n\n    // clear group after set amount of time so the status is not read twice\n    clearTimeout(notificationClearTimeout);\n    notificationClearTimeout = setTimeout(function() {\n      clear$1(root);\n    }, 1500);\n  };\n\n  var isUsingFilePond = function isUsingFilePond(root) {\n    return root.element.parentNode.contains(document.activeElement);\n  };\n\n  var itemAdded = function itemAdded(_ref2) {\n    var root = _ref2.root,\n      action = _ref2.action;\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    root.element.textContent = '';\n    var item = root.query('GET_ITEM', action.id);\n    filenames.push(item.filename);\n\n    clearTimeout(addFilesNotificationTimeout);\n    addFilesNotificationTimeout = setTimeout(function() {\n      listModified(\n        root,\n        filenames.join(', '),\n        root.query('GET_LABEL_FILE_ADDED')\n      );\n\n      filenames.length = 0;\n    }, 750);\n  };\n\n  var itemRemoved = function itemRemoved(_ref3) {\n    var root = _ref3.root,\n      action = _ref3.action;\n    if (!isUsingFilePond(root)) {\n      return;\n    }\n\n    var item = action.item;\n    listModified(root, item.filename, root.query('GET_LABEL_FILE_REMOVED'));\n  };\n\n  var itemProcessed = function itemProcessed(_ref4) {\n    var root = _ref4.root,\n      action = _ref4.action;\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_COMPLETE');\n\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemProcessedUndo = function itemProcessedUndo(_ref5) {\n    var root = _ref5.root,\n      action = _ref5.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n    var label = root.query('GET_LABEL_FILE_PROCESSING_ABORTED');\n\n    assist(root, filename + ' ' + label);\n  };\n\n  var itemError = function itemError(_ref6) {\n    var root = _ref6.root,\n      action = _ref6.action;\n    var item = root.query('GET_ITEM', action.id);\n    var filename = item.filename;\n\n    // will also notify the user when FilePond is not being used, as the user might be occupied with other activities while uploading a file\n\n    assist(root, action.status.main + ' ' + filename + ' ' + action.status.sub);\n  };\n\n  var assistant = createView({\n    create: create$c,\n    ignoreRect: true,\n    ignoreRectUpdate: true,\n    write: createRoute({\n      DID_LOAD_ITEM: itemAdded,\n      DID_REMOVE_ITEM: itemRemoved,\n      DID_COMPLETE_ITEM_PROCESSING: itemProcessed,\n\n      DID_ABORT_ITEM_PROCESSING: itemProcessedUndo,\n      DID_REVERT_ITEM_PROCESSING: itemProcessedUndo,\n\n      DID_THROW_ITEM_REMOVE_ERROR: itemError,\n      DID_THROW_ITEM_LOAD_ERROR: itemError,\n      DID_THROW_ITEM_INVALID: itemError,\n      DID_THROW_ITEM_PROCESSING_ERROR: itemError\n    }),\n\n    tag: 'span',\n    name: 'assistant'\n  });\n\n  var toCamels = function toCamels(string) {\n    var separator =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '-';\n    return string.replace(new RegExp(separator + '.', 'g'), function(sub) {\n      return sub.charAt(1).toUpperCase();\n    });\n  };\n\n  var debounce = function debounce(func) {\n    var interval =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;\n    var immidiateOnly =\n      arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    var last = Date.now();\n    var timeout = null;\n\n    return function() {\n      for (\n        var _len = arguments.length, args = new Array(_len), _key = 0;\n        _key < _len;\n        _key++\n      ) {\n        args[_key] = arguments[_key];\n      }\n      clearTimeout(timeout);\n\n      var dist = Date.now() - last;\n\n      var fn = function fn() {\n        last = Date.now();\n        func.apply(void 0, args);\n      };\n\n      if (dist < interval) {\n        // we need to delay by the difference between interval and dist\n        // for example: if distance is 10 ms and interval is 16 ms,\n        // we need to wait an additional 6ms before calling the function)\n        if (!immidiateOnly) {\n          timeout = setTimeout(fn, interval - dist);\n        }\n      } else {\n        // go!\n        fn();\n      }\n    };\n  };\n\n  var MAX_FILES_LIMIT = 1000000;\n\n  var create$d = function create(_ref) {\n    var root = _ref.root,\n      props = _ref.props;\n\n    // Add id\n    var id = root.query('GET_ID');\n    if (id) {\n      root.element.id = id;\n    }\n\n    // Add className\n    var className = root.query('GET_CLASS_NAME');\n    if (className) {\n      className.split(' ').forEach(function(name) {\n        root.element.classList.add(name);\n      });\n    }\n\n    // Field label\n    root.ref.label = root.appendChildView(\n      root.createChildView(\n        dropLabel,\n        Object.assign({}, props, {\n          translateY: null,\n          caption: root.query('GET_LABEL_IDLE')\n        })\n      )\n    );\n\n    // List of items\n    root.ref.list = root.appendChildView(\n      root.createChildView(listScroller, { translateY: null })\n    );\n\n    // Background panel\n    root.ref.panel = root.appendChildView(\n      root.createChildView(panel, { name: 'panel-root' })\n    );\n\n    // Assistant notifies assistive tech when content changes\n    root.ref.assistant = root.appendChildView(\n      root.createChildView(assistant, Object.assign({}, props))\n    );\n\n    // Measure (tests if fixed height was set)\n    // DOCTYPE needs to be set for this to work\n    root.ref.measure = createElement$1('div');\n    root.ref.measure.style.height = '100%';\n    root.element.appendChild(root.ref.measure);\n\n    // information on the root height or fixed height status\n    root.ref.bounds = null;\n\n    // apply initial style properties\n    root\n      .query('GET_STYLES')\n      .filter(function(style) {\n        return !isEmpty(style.value);\n      })\n      .map(function(_ref2) {\n        var name = _ref2.name,\n          value = _ref2.value;\n        root.element.dataset[name] = value;\n      });\n\n    // determine if width changed\n    root.ref.widthPrevious = null;\n    root.ref.widthUpdated = debounce(function() {\n      root.ref.updateHistory = [];\n      root.dispatch('DID_RESIZE_ROOT');\n    }, 250);\n\n    // history of updates\n    root.ref.previousAspectRatio = null;\n    root.ref.updateHistory = [];\n  };\n\n  var write$8 = function write(_ref3) {\n    var root = _ref3.root,\n      props = _ref3.props,\n      actions = _ref3.actions;\n\n    // route actions\n    route$5({ root: root, props: props, actions: actions });\n\n    // apply style properties\n    actions\n      .filter(function(action) {\n        return /^DID_SET_STYLE_/.test(action.type);\n      })\n      .filter(function(action) {\n        return !isEmpty(action.data.value);\n      })\n      .map(function(_ref4) {\n        var type = _ref4.type,\n          data = _ref4.data;\n        var name = toCamels(type.substr(8).toLowerCase(), '_');\n        root.element.dataset[name] = data.value;\n        root.invalidateLayout();\n      });\n\n    if (root.rect.element.hidden) return;\n\n    if (root.rect.element.width !== root.ref.widthPrevious) {\n      root.ref.widthPrevious = root.rect.element.width;\n      root.ref.widthUpdated();\n    }\n\n    // get box bounds, we do this only once\n    var bounds = root.ref.bounds;\n    if (!bounds) {\n      bounds = root.ref.bounds = calculateRootBoundingBoxHeight(root);\n\n      // destroy measure element\n      root.element.removeChild(root.ref.measure);\n      root.ref.measure = null;\n    }\n\n    // get quick references to various high level parts of the upload tool\n    var _root$ref = root.ref,\n      hopper = _root$ref.hopper,\n      label = _root$ref.label,\n      list = _root$ref.list,\n      panel = _root$ref.panel;\n\n    // sets correct state to hopper scope\n    if (hopper) {\n      hopper.updateHopperState();\n    }\n\n    // bool to indicate if we're full or not\n    var aspectRatio = root.query('GET_PANEL_ASPECT_RATIO');\n    var isMultiItem = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = isMultiItem\n      ? root.query('GET_MAX_FILES') || MAX_FILES_LIMIT\n      : 1;\n    var atMaxCapacity = totalItems === maxItems;\n\n    // action used to add item\n    var addAction = actions.find(function(action) {\n      return action.type === 'DID_ADD_ITEM';\n    });\n\n    // if reached max capacity and we've just reached it\n    if (atMaxCapacity && addAction) {\n      // get interaction type\n      var interactionMethod = addAction.data.interactionMethod;\n\n      // hide label\n      label.opacity = 0;\n\n      if (isMultiItem) {\n        label.translateY = -40;\n      } else {\n        if (interactionMethod === InteractionMethod.API) {\n          label.translateX = 40;\n        } else if (interactionMethod === InteractionMethod.BROWSE) {\n          label.translateY = 40;\n        } else {\n          label.translateY = 30;\n        }\n      }\n    } else if (!atMaxCapacity) {\n      label.opacity = 1;\n      label.translateX = 0;\n      label.translateY = 0;\n    }\n\n    var listItemMargin = calculateListItemMargin(root);\n\n    var listHeight = calculateListHeight(root);\n\n    var labelHeight = label.rect.element.height;\n    var currentLabelHeight = !isMultiItem || atMaxCapacity ? 0 : labelHeight;\n\n    var listMarginTop = atMaxCapacity ? list.rect.element.marginTop : 0;\n    var listMarginBottom =\n      totalItems === 0 ? 0 : list.rect.element.marginBottom;\n\n    var visualHeight =\n      currentLabelHeight + listMarginTop + listHeight.visual + listMarginBottom;\n    var boundsHeight =\n      currentLabelHeight + listMarginTop + listHeight.bounds + listMarginBottom;\n\n    // link list to label bottom position\n    list.translateY =\n      Math.max(0, currentLabelHeight - list.rect.element.marginTop) -\n      listItemMargin.top;\n\n    if (aspectRatio) {\n      // fixed aspect ratio\n\n      // calculate height based on width\n      var width = root.rect.element.width;\n      var height = width * aspectRatio;\n\n      // clear history if aspect ratio has changed\n      if (aspectRatio !== root.ref.previousAspectRatio) {\n        root.ref.previousAspectRatio = aspectRatio;\n        root.ref.updateHistory = [];\n      }\n\n      // remember this width\n      var history = root.ref.updateHistory;\n      history.push(width);\n\n      var MAX_BOUNCES = 2;\n      if (history.length > MAX_BOUNCES * 2) {\n        var l = history.length;\n        var bottom = l - 10;\n        var bounces = 0;\n        for (var i = l; i >= bottom; i--) {\n          if (history[i] === history[i - 2]) {\n            bounces++;\n          }\n\n          if (bounces >= MAX_BOUNCES) {\n            // dont adjust height\n            return;\n          }\n        }\n      }\n\n      // fix height of panel so it adheres to aspect ratio\n      panel.scalable = false;\n      panel.height = height;\n\n      // available height for list\n      var listAvailableHeight =\n        // the height of the panel minus the label height\n        height -\n        currentLabelHeight -\n        // the room we leave open between the end of the list and the panel bottom\n        (listMarginBottom - listItemMargin.bottom) -\n        // if we're full we need to leave some room between the top of the panel and the list\n        (atMaxCapacity ? listMarginTop : 0);\n\n      if (listHeight.visual > listAvailableHeight) {\n        list.overflow = listAvailableHeight;\n      } else {\n        list.overflow = null;\n      }\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = height;\n    } else if (bounds.fixedHeight) {\n      // fixed height\n\n      // fix height of panel\n      panel.scalable = false;\n\n      // available height for list\n      var _listAvailableHeight =\n        // the height of the panel minus the label height\n        bounds.fixedHeight -\n        currentLabelHeight -\n        // the room we leave open between the end of the list and the panel bottom\n        (listMarginBottom - listItemMargin.bottom) -\n        // if we're full we need to leave some room between the top of the panel and the list\n        (atMaxCapacity ? listMarginTop : 0);\n\n      // set list height\n      if (listHeight.visual > _listAvailableHeight) {\n        list.overflow = _listAvailableHeight;\n      } else {\n        list.overflow = null;\n      }\n\n      // no need to set container bounds as these are handles by CSS fixed height\n    } else if (bounds.cappedHeight) {\n      // max-height\n\n      // not a fixed height panel\n      var isCappedHeight = visualHeight >= bounds.cappedHeight;\n      var panelHeight = Math.min(bounds.cappedHeight, visualHeight);\n      panel.scalable = true;\n      panel.height = isCappedHeight\n        ? panelHeight\n        : panelHeight - listItemMargin.top - listItemMargin.bottom;\n\n      // available height for list\n      var _listAvailableHeight2 =\n        // the height of the panel minus the label height\n        panelHeight -\n        currentLabelHeight -\n        // the room we leave open between the end of the list and the panel bottom\n        (listMarginBottom - listItemMargin.bottom) -\n        // if we're full we need to leave some room between the top of the panel and the list\n        (atMaxCapacity ? listMarginTop : 0);\n\n      // set list height (if is overflowing)\n      if (\n        visualHeight > bounds.cappedHeight &&\n        listHeight.visual > _listAvailableHeight2\n      ) {\n        list.overflow = _listAvailableHeight2;\n      } else {\n        list.overflow = null;\n      }\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = Math.min(\n        bounds.cappedHeight,\n        boundsHeight - listItemMargin.top - listItemMargin.bottom\n      );\n    } else {\n      // flexible height\n\n      // not a fixed height panel\n      var itemMargin =\n        totalItems > 0 ? listItemMargin.top + listItemMargin.bottom : 0;\n      panel.scalable = true;\n      panel.height = Math.max(labelHeight, visualHeight - itemMargin);\n\n      // set container bounds (so pushes siblings downwards)\n      root.height = Math.max(labelHeight, boundsHeight - itemMargin);\n    }\n  };\n\n  var calculateListItemMargin = function calculateListItemMargin(root) {\n    var item = root.ref.list.childViews[0].childViews[0];\n    return item\n      ? {\n          top: item.rect.element.marginTop,\n          bottom: item.rect.element.marginBottom\n        }\n      : {\n          top: 0,\n          bottom: 0\n        };\n  };\n\n  var calculateListHeight = function calculateListHeight(root) {\n    var visual = 0;\n    var bounds = 0;\n\n    // get file list reference\n    var scrollList = root.ref.list;\n    var itemList = scrollList.childViews[0];\n    var children = itemList.childViews;\n\n    // no children, done!\n    if (children.length === 0) return { visual: visual, bounds: bounds };\n\n    var horizontalSpace = itemList.rect.element.width;\n    var dragIndex = getItemIndexByPosition(\n      itemList,\n      scrollList.dragCoordinates\n    );\n\n    var childRect = children[0].rect.element;\n\n    var itemVerticalMargin = childRect.marginTop + childRect.marginBottom;\n    var itemHorizontalMargin = childRect.marginLeft + childRect.marginRight;\n\n    var itemWidth = childRect.width + itemHorizontalMargin;\n    var itemHeight = childRect.height + itemVerticalMargin;\n\n    var newItem = typeof dragIndex !== 'undefined' && dragIndex >= 0 ? 1 : 0;\n    var removedItem = children.find(function(child) {\n      return child.markedForRemoval && child.opacity < 0.45;\n    })\n      ? -1\n      : 0;\n    var verticalItemCount = children.length + newItem + removedItem;\n    var itemsPerRow = Math.round(horizontalSpace / itemWidth);\n\n    // stack\n    if (itemsPerRow === 1) {\n      children.forEach(function(item) {\n        var height = item.rect.element.height + itemVerticalMargin;\n        bounds += height;\n        visual += height * item.opacity;\n      });\n    }\n    // grid\n    else {\n      bounds = Math.ceil(verticalItemCount / itemsPerRow) * itemHeight;\n      visual = bounds;\n    }\n\n    return { visual: visual, bounds: bounds };\n  };\n\n  var calculateRootBoundingBoxHeight = function calculateRootBoundingBoxHeight(\n    root\n  ) {\n    var height = root.ref.measureHeight || null;\n    var cappedHeight = parseInt(root.style.maxHeight, 10) || null;\n    var fixedHeight = height === 0 ? null : height;\n\n    return {\n      cappedHeight: cappedHeight,\n      fixedHeight: fixedHeight\n    };\n  };\n\n  var exceedsMaxFiles = function exceedsMaxFiles(root, items) {\n    var allowReplace = root.query('GET_ALLOW_REPLACE');\n    var allowMultiple = root.query('GET_ALLOW_MULTIPLE');\n    var totalItems = root.query('GET_TOTAL_ITEMS');\n    var maxItems = root.query('GET_MAX_FILES');\n\n    // total amount of items being dragged\n    var totalBrowseItems = items.length;\n\n    // if does not allow multiple items and dragging more than one item\n    if (!allowMultiple && totalBrowseItems > 1) {\n      return true;\n    }\n\n    // limit max items to one if not allowed to drop multiple items\n    maxItems = allowMultiple ? maxItems : allowReplace ? maxItems : 1;\n\n    // no more room?\n    var hasMaxItems = isInt(maxItems);\n    if (hasMaxItems && totalItems + totalBrowseItems > maxItems) {\n      root.dispatch('DID_THROW_MAX_FILES', {\n        source: items,\n        error: createResponse('warning', 0, 'Max files')\n      });\n\n      return true;\n    }\n\n    return false;\n  };\n\n  var getDragIndex = function getDragIndex(list, position) {\n    var itemList = list.childViews[0];\n    return getItemIndexByPosition(itemList, {\n      left: position.scopeLeft - itemList.rect.element.left,\n      top:\n        position.scopeTop -\n        (list.rect.outer.top +\n          list.rect.element.marginTop +\n          list.rect.element.scrollTop)\n    });\n  };\n\n  /**\n   * Enable or disable file drop functionality\n   */\n  var toggleDrop = function toggleDrop(root) {\n    var isAllowed = root.query('GET_ALLOW_DROP');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.hopper) {\n      var hopper = createHopper(\n        root.element,\n        function(items) {\n          // these files don't fit so stop here\n          if (exceedsMaxFiles(root, items)) return false;\n\n          // allow quick validation of dropped items\n          var beforeDropFile =\n            root.query('GET_BEFORE_DROP_FILE') ||\n            function() {\n              return true;\n            };\n\n          // all items should be validated by all filters as valid\n          var dropValidation = root.query('GET_DROP_VALIDATION');\n          return dropValidation\n            ? items.every(function(item) {\n                return (\n                  applyFilters('ALLOW_HOPPER_ITEM', item, {\n                    query: root.query\n                  }).every(function(result) {\n                    return result === true;\n                  }) && beforeDropFile(item)\n                );\n              })\n            : true;\n        },\n        {\n          filterItems: function filterItems(items) {\n            var ignoredFiles = root.query('GET_IGNORED_FILES');\n            return items.filter(function(item) {\n              if (isFile(item)) {\n                return !ignoredFiles.includes(item.name.toLowerCase());\n              }\n              return true;\n            });\n          },\n          catchesDropsOnPage: root.query('GET_DROP_ON_PAGE'),\n          requiresDropOnElement: root.query('GET_DROP_ON_ELEMENT')\n        }\n      );\n\n      hopper.onload = function(items, position) {\n        root.dispatch('ADD_ITEMS', {\n          items: items,\n          index: getDragIndex(root.ref.list, position),\n          interactionMethod: InteractionMethod.DROP\n        });\n\n        root.dispatch('DID_DROP', { position: position });\n\n        root.dispatch('DID_END_DRAG', { position: position });\n      };\n\n      hopper.ondragstart = function(position) {\n        root.dispatch('DID_START_DRAG', { position: position });\n      };\n\n      hopper.ondrag = debounce(function(position) {\n        root.dispatch('DID_DRAG', { position: position });\n      });\n\n      hopper.ondragend = function(position) {\n        root.dispatch('DID_END_DRAG', { position: position });\n      };\n\n      root.ref.hopper = hopper;\n\n      root.ref.drip = root.appendChildView(root.createChildView(drip));\n    } else if (!enabled && root.ref.hopper) {\n      root.ref.hopper.destroy();\n      root.ref.hopper = null;\n      root.removeChildView(root.ref.drip);\n    }\n  };\n\n  /**\n   * Enable or disable browse functionality\n   */\n  var toggleBrowse = function toggleBrowse(root, props) {\n    var isAllowed = root.query('GET_ALLOW_BROWSE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.browser) {\n      root.ref.browser = root.appendChildView(\n        root.createChildView(\n          browser,\n          Object.assign({}, props, {\n            onload: function onload(items) {\n              // these files don't fit so stop here\n              if (exceedsMaxFiles(root, items)) return false;\n\n              // add items!\n              root.dispatch('ADD_ITEMS', {\n                items: items,\n                index: -1,\n                interactionMethod: InteractionMethod.BROWSE\n              });\n            }\n          })\n        ),\n\n        0\n      );\n    } else if (!enabled && root.ref.browser) {\n      root.removeChildView(root.ref.browser);\n      root.ref.browser = null;\n    }\n  };\n\n  /**\n   * Enable or disable paste functionality\n   */\n  var togglePaste = function togglePaste(root) {\n    var isAllowed = root.query('GET_ALLOW_PASTE');\n    var isDisabled = root.query('GET_DISABLED');\n    var enabled = isAllowed && !isDisabled;\n    if (enabled && !root.ref.paster) {\n      root.ref.paster = createPaster();\n      root.ref.paster.onload = function(items) {\n        root.dispatch('ADD_ITEMS', {\n          items: items,\n          index: -1,\n          interactionMethod: InteractionMethod.PASTE\n        });\n      };\n    } else if (!enabled && root.ref.paster) {\n      root.ref.paster.destroy();\n      root.ref.paster = null;\n    }\n  };\n\n  /**\n   * Route actions\n   */\n  var route$5 = createRoute({\n    DID_SET_ALLOW_BROWSE: function DID_SET_ALLOW_BROWSE(_ref5) {\n      var root = _ref5.root,\n        props = _ref5.props;\n      toggleBrowse(root, props);\n    },\n    DID_SET_ALLOW_DROP: function DID_SET_ALLOW_DROP(_ref6) {\n      var root = _ref6.root;\n      toggleDrop(root);\n    },\n    DID_SET_ALLOW_PASTE: function DID_SET_ALLOW_PASTE(_ref7) {\n      var root = _ref7.root;\n      togglePaste(root);\n    },\n    DID_SET_DISABLED: function DID_SET_DISABLED(_ref8) {\n      var root = _ref8.root,\n        props = _ref8.props;\n      toggleDrop(root);\n      togglePaste(root);\n      toggleBrowse(root, props);\n      var isDisabled = root.query('GET_DISABLED');\n      if (isDisabled) {\n        root.element.dataset.disabled = 'disabled';\n      } else {\n        // delete root.element.dataset.disabled; <= this does not work on iOS 10\n        root.element.removeAttribute('data-disabled');\n      }\n    }\n  });\n\n  var root = createView({\n    name: 'root',\n    read: function read(_ref9) {\n      var root = _ref9.root;\n      if (root.ref.measure) {\n        root.ref.measureHeight = root.ref.measure.offsetHeight;\n      }\n    },\n    create: create$d,\n    write: write$8,\n    destroy: function destroy(_ref10) {\n      var root = _ref10.root;\n      if (root.ref.paster) {\n        root.ref.paster.destroy();\n      }\n      if (root.ref.hopper) {\n        root.ref.hopper.destroy();\n      }\n    },\n    mixins: {\n      styles: ['height']\n    }\n  });\n\n  // creates the app\n  var createApp = function createApp() {\n    var initialOptions =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    // let element\n    var originalElement = null;\n\n    // get default options\n    var defaultOptions = getOptions();\n\n    // create the data store, this will contain all our app info\n    var store = createStore(\n      // initial state (should be serializable)\n      createInitialState(defaultOptions),\n\n      // queries\n      [queries, createOptionQueries(defaultOptions)],\n\n      // action handlers\n      [actions, createOptionActions(defaultOptions)]\n    );\n\n    // set initial options\n    store.dispatch('SET_OPTIONS', { options: initialOptions });\n\n    // kick thread if visibility changes\n    var visibilityHandler = function visibilityHandler() {\n      if (document.hidden) return;\n      store.dispatch('KICK');\n    };\n    document.addEventListener('visibilitychange', visibilityHandler);\n\n    // re-render on window resize start and finish\n    var resizeDoneTimer = null;\n    var isResizing = false;\n    var isResizingHorizontally = false;\n    var initialWindowWidth = null;\n    var currentWindowWidth = null;\n    var resizeHandler = function resizeHandler() {\n      if (!isResizing) {\n        isResizing = true;\n      }\n      clearTimeout(resizeDoneTimer);\n      resizeDoneTimer = setTimeout(function() {\n        isResizing = false;\n        initialWindowWidth = null;\n        currentWindowWidth = null;\n        if (isResizingHorizontally) {\n          isResizingHorizontally = false;\n          store.dispatch('DID_STOP_RESIZE');\n        }\n      }, 500);\n    };\n    window.addEventListener('resize', resizeHandler);\n\n    // render initial view\n    var view = root(store, { id: getUniqueId() });\n\n    //\n    // PRIVATE API -------------------------------------------------------------------------------------\n    //\n    var isResting = false;\n    var isHidden = false;\n\n    var readWriteApi = {\n      // necessary for update loop\n\n      /**\n       * Reads from dom (never call manually)\n       * @private\n       */\n      _read: function _read() {\n        // test if we're resizing horizontally\n        // TODO: see if we can optimize this by measuring root rect\n        if (isResizing) {\n          currentWindowWidth = window.innerWidth;\n          if (!initialWindowWidth) {\n            initialWindowWidth = currentWindowWidth;\n          }\n\n          if (\n            !isResizingHorizontally &&\n            currentWindowWidth !== initialWindowWidth\n          ) {\n            store.dispatch('DID_START_RESIZE');\n            isResizingHorizontally = true;\n          }\n        }\n\n        if (isHidden && isResting) {\n          // test if is no longer hidden\n          isResting = view.element.offsetParent === null;\n        }\n\n        // if resting, no need to read as numbers will still all be correct\n        if (isResting) return;\n\n        // read view data\n        view._read();\n\n        // if is hidden we need to know so we exit rest mode when revealed\n        isHidden = view.rect.element.hidden;\n      },\n\n      /**\n       * Writes to dom (never call manually)\n       * @private\n       */\n      _write: function _write(ts) {\n        // get all actions from store\n        var actions = store\n          .processActionQueue()\n\n          // filter out set actions (these will automatically trigger DID_SET)\n          .filter(function(action) {\n            return !/^SET_/.test(action.type);\n          });\n\n        // if was idling and no actions stop here\n        if (isResting && !actions.length) return;\n\n        // some actions might trigger events\n        routeActionsToEvents(actions);\n\n        // update the view\n        isResting = view._write(ts, actions, isResizingHorizontally);\n\n        // will clean up all archived items\n        removeReleasedItems(store.query('GET_ITEMS'));\n\n        // now idling\n        if (isResting) {\n          store.processDispatchQueue();\n        }\n      }\n    };\n\n    //\n    // EXPOSE EVENTS -------------------------------------------------------------------------------------\n    //\n    var createEvent = function createEvent(name) {\n      return function(data) {\n        // create default event\n        var event = {\n          type: name\n        };\n\n        // no data to add\n        if (!data) {\n          return event;\n        }\n\n        // copy relevant props\n        if (data.hasOwnProperty('error')) {\n          event.error = data.error ? Object.assign({}, data.error) : null;\n        }\n\n        if (data.status) {\n          event.status = Object.assign({}, data.status);\n        }\n\n        if (data.file) {\n          event.output = data.file;\n        }\n\n        // only source is available, else add item if possible\n        if (data.source) {\n          event.file = data.source;\n        } else if (data.item || data.id) {\n          var item = data.item ? data.item : store.query('GET_ITEM', data.id);\n          event.file = item ? createItemAPI(item) : null;\n        }\n\n        // map all items in a possible items array\n        if (data.items) {\n          event.items = data.items.map(createItemAPI);\n        }\n\n        // if this is a progress event add the progress amount\n        if (/progress/.test(name)) {\n          event.progress = data.progress;\n        }\n\n        return event;\n      };\n    };\n\n    var eventRoutes = {\n      DID_DESTROY: createEvent('destroy'),\n\n      DID_INIT: createEvent('init'),\n\n      DID_THROW_MAX_FILES: createEvent('warning'),\n\n      DID_START_ITEM_LOAD: createEvent('addfilestart'),\n      DID_UPDATE_ITEM_LOAD_PROGRESS: createEvent('addfileprogress'),\n      DID_LOAD_ITEM: createEvent('addfile'),\n\n      DID_THROW_ITEM_INVALID: [createEvent('error'), createEvent('addfile')],\n\n      DID_THROW_ITEM_LOAD_ERROR: [createEvent('error'), createEvent('addfile')],\n\n      DID_THROW_ITEM_REMOVE_ERROR: [\n        createEvent('error'),\n        createEvent('removefile')\n      ],\n\n      DID_PREPARE_OUTPUT: createEvent('preparefile'),\n\n      DID_START_ITEM_PROCESSING: createEvent('processfilestart'),\n      DID_UPDATE_ITEM_PROCESS_PROGRESS: createEvent('processfileprogress'),\n      DID_ABORT_ITEM_PROCESSING: createEvent('processfileabort'),\n      DID_COMPLETE_ITEM_PROCESSING: createEvent('processfile'),\n      DID_COMPLETE_ITEM_PROCESSING_ALL: createEvent('processfiles'),\n      DID_REVERT_ITEM_PROCESSING: createEvent('processfilerevert'),\n\n      DID_THROW_ITEM_PROCESSING_ERROR: [\n        createEvent('error'),\n        createEvent('processfile')\n      ],\n\n      DID_REMOVE_ITEM: createEvent('removefile'),\n\n      DID_UPDATE_ITEMS: createEvent('updatefiles'),\n\n      DID_ACTIVATE_ITEM: createEvent('activatefile')\n    };\n\n    var exposeEvent = function exposeEvent(event) {\n      // create event object to be dispatched\n      var detail = Object.assign({ pond: exports }, event);\n      delete detail.type;\n      view.element.dispatchEvent(\n        new CustomEvent('FilePond:' + event.type, {\n          // event info\n          detail: detail,\n\n          // event behaviour\n          bubbles: true,\n          cancelable: true,\n          composed: true // triggers listeners outside of shadow root\n        })\n      );\n\n      // event object to params used for `on()` event handlers and callbacks `oninit()`\n      var params = [];\n\n      // if is possible error event, make it the first param\n      if (event.hasOwnProperty('error')) {\n        params.push(event.error);\n      }\n\n      // file is always section\n      if (event.hasOwnProperty('file')) {\n        params.push(event.file);\n      }\n\n      // append other props\n      var filtered = ['type', 'error', 'file'];\n      Object.keys(event)\n        .filter(function(key) {\n          return !filtered.includes(key);\n        })\n        .forEach(function(key) {\n          return params.push(event[key]);\n        });\n\n      // on(type, () => { })\n      exports.fire.apply(exports, [event.type].concat(params));\n\n      // oninit = () => {}\n      var handler = store.query('GET_ON' + event.type.toUpperCase());\n      if (handler) {\n        handler.apply(void 0, params);\n      }\n    };\n\n    var routeActionsToEvents = function routeActionsToEvents(actions) {\n      if (!actions.length) {\n        return;\n      }\n\n      actions.forEach(function(action) {\n        if (!eventRoutes[action.type]) {\n          return;\n        }\n        var routes = eventRoutes[action.type];\n        (Array.isArray(routes) ? routes : [routes]).forEach(function(route) {\n          setTimeout(function() {\n            exposeEvent(route(action.data));\n          }, 0);\n        });\n      });\n    };\n\n    //\n    // PUBLIC API -------------------------------------------------------------------------------------\n    //\n    var setOptions = function setOptions(options) {\n      return store.dispatch('SET_OPTIONS', { options: options });\n    };\n\n    var getFile = function getFile(query) {\n      return store.query('GET_ACTIVE_ITEM', query);\n    };\n\n    var addFile = function addFile(source) {\n      var options =\n        arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return new Promise(function(resolve, reject) {\n        addFiles([{ source: source, options: options }], {\n          index: options.index\n        })\n          .then(function(items) {\n            return resolve(items && items[0]);\n          })\n          .catch(reject);\n      });\n    };\n\n    var removeFile = function removeFile(query) {\n      // request item removal\n      store.dispatch('REMOVE_ITEM', { query: query });\n\n      // see if item has been removed\n      return store.query('GET_ACTIVE_ITEM', query) === null;\n    };\n\n    var addFiles = function addFiles() {\n      for (\n        var _len = arguments.length, args = new Array(_len), _key = 0;\n        _key < _len;\n        _key++\n      ) {\n        args[_key] = arguments[_key];\n      }\n      return new Promise(function(resolve, reject) {\n        var sources = [];\n        var options = {};\n\n        // user passed a sources array\n        if (isArray(args[0])) {\n          sources.push.apply(sources, args[0]);\n          Object.assign(options, args[1] || {});\n        } else {\n          // user passed sources as arguments, last one might be options object\n          var lastArgument = args[args.length - 1];\n          if (\n            typeof lastArgument === 'object' &&\n            !(lastArgument instanceof Blob)\n          ) {\n            Object.assign(options, args.pop());\n          }\n\n          // add rest to sources\n          sources.push.apply(sources, args);\n        }\n\n        store.dispatch('ADD_ITEMS', {\n          items: sources,\n          index: options.index,\n          interactionMethod: InteractionMethod.API,\n          success: resolve,\n          failure: reject\n        });\n      });\n    };\n\n    var getFiles = function getFiles() {\n      return store.query('GET_ACTIVE_ITEMS');\n    };\n\n    var processFile = function processFile(query) {\n      return new Promise(function(resolve, reject) {\n        store.dispatch('REQUEST_ITEM_PROCESSING', {\n          query: query,\n          success: function success(item) {\n            resolve(item);\n          },\n          failure: function failure(error) {\n            reject(error);\n          }\n        });\n      });\n    };\n\n    var processFiles = function processFiles() {\n      for (\n        var _len2 = arguments.length, args = new Array(_len2), _key2 = 0;\n        _key2 < _len2;\n        _key2++\n      ) {\n        args[_key2] = arguments[_key2];\n      }\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      if (!queries.length) {\n        var files = getFiles().filter(function(item) {\n          return (\n            !(\n              item.status === ItemStatus.IDLE &&\n              item.origin === FileOrigin.LOCAL\n            ) &&\n            item.status !== ItemStatus.PROCESSING &&\n            item.status !== ItemStatus.PROCESSING_COMPLETE &&\n            item.status !== ItemStatus.PROCESSING_REVERT_ERROR\n          );\n        });\n\n        return Promise.all(files.map(processFile));\n      }\n      return Promise.all(queries.map(processFile));\n    };\n\n    var removeFiles = function removeFiles() {\n      for (\n        var _len3 = arguments.length, args = new Array(_len3), _key3 = 0;\n        _key3 < _len3;\n        _key3++\n      ) {\n        args[_key3] = arguments[_key3];\n      }\n      var queries = Array.isArray(args[0]) ? args[0] : args;\n      var files = getFiles();\n\n      if (!queries.length) {\n        return Promise.all(files.map(removeFile));\n      }\n\n      // when removing by index the indexes shift after each file removal so we need to convert indexes to ids\n      var mappedQueries = queries\n        .map(function(query) {\n          return isNumber(query)\n            ? files[query]\n              ? files[query].id\n              : null\n            : query;\n        })\n        .filter(function(query) {\n          return query;\n        });\n\n      return mappedQueries.map(removeFile);\n    };\n\n    var exports = Object.assign(\n      {},\n\n      on(),\n      {},\n\n      readWriteApi,\n      {},\n\n      createOptionAPI(store, defaultOptions),\n      {\n        /**\n         * Override options defined in options object\n         * @param options\n         */\n        setOptions: setOptions,\n\n        /**\n         * Load the given file\n         * @param source - the source of the file (either a File, base64 data uri or url)\n         * @param options - object, { index: 0 }\n         */\n        addFile: addFile,\n\n        /**\n         * Load the given files\n         * @param sources - the sources of the files to load\n         * @param options - object, { index: 0 }\n         */\n        addFiles: addFiles,\n\n        /**\n         * Returns the file objects matching the given query\n         * @param query { string, number, null }\n         */\n        getFile: getFile,\n\n        /**\n         * Upload file with given name\n         * @param query { string, number, null  }\n         */\n        processFile: processFile,\n\n        /**\n         * Removes a file by its name\n         * @param query { string, number, null  }\n         */\n        removeFile: removeFile,\n\n        /**\n         * Returns all files (wrapped in public api)\n         */\n        getFiles: getFiles,\n\n        /**\n         * Starts uploading all files\n         */\n        processFiles: processFiles,\n\n        /**\n         * Clears all files from the files list\n         */\n        removeFiles: removeFiles,\n\n        /**\n         * Sort list of files\n         */\n        sort: function sort(compare) {\n          return store.dispatch('SORT', { compare: compare });\n        },\n\n        /**\n         * Browse the file system for a file\n         */\n        browse: function browse() {\n          // needs to be trigger directly as user action needs to be traceable (is not traceable in requestAnimationFrame)\n          var input = view.element.querySelector('input[type=file]');\n          if (input) {\n            input.click();\n          }\n        },\n\n        /**\n         * Destroys the app\n         */\n        destroy: function destroy() {\n          // request destruction\n          exports.fire('destroy', view.element);\n\n          // stop active processes (file uploads, fetches, stuff like that)\n          // loop over items and depending on states call abort for ongoing processes\n          store.dispatch('ABORT_ALL');\n\n          // destroy view\n          view._destroy();\n\n          // stop listening to resize\n          window.removeEventListener('resize', resizeHandler);\n\n          // stop listening to the visiblitychange event\n          document.removeEventListener('visibilitychange', visibilityHandler);\n\n          // dispatch destroy\n          store.dispatch('DID_DESTROY');\n        },\n\n        /**\n         * Inserts the plugin before the target element\n         */\n        insertBefore: function insertBefore$1(element) {\n          return insertBefore(view.element, element);\n        },\n\n        /**\n         * Inserts the plugin after the target element\n         */\n        insertAfter: function insertAfter$1(element) {\n          return insertAfter(view.element, element);\n        },\n\n        /**\n         * Appends the plugin to the target element\n         */\n        appendTo: function appendTo(element) {\n          return element.appendChild(view.element);\n        },\n\n        /**\n         * Replaces an element with the app\n         */\n        replaceElement: function replaceElement(element) {\n          // insert the app before the element\n          insertBefore(view.element, element);\n\n          // remove the original element\n          element.parentNode.removeChild(element);\n\n          // remember original element\n          originalElement = element;\n        },\n\n        /**\n         * Restores the original element\n         */\n        restoreElement: function restoreElement() {\n          if (!originalElement) {\n            return; // no element to restore\n          }\n\n          // restore original element\n          insertAfter(originalElement, view.element);\n\n          // remove our element\n          view.element.parentNode.removeChild(view.element);\n\n          // remove reference\n          originalElement = null;\n        },\n\n        /**\n         * Returns true if the app root is attached to given element\n         * @param element\n         */\n        isAttachedTo: function isAttachedTo(element) {\n          return view.element === element || originalElement === element;\n        },\n\n        /**\n         * Returns the root element\n         */\n        element: {\n          get: function get() {\n            return view.element;\n          }\n        },\n\n        /**\n         * Returns the current pond status\n         */\n        status: {\n          get: function get() {\n            return store.query('GET_STATUS');\n          }\n        }\n      }\n    );\n\n    // Done!\n    store.dispatch('DID_INIT');\n\n    // create actual api object\n    return createObject(exports);\n  };\n\n  var createAppObject = function createAppObject() {\n    var customOptions =\n      arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    // default options\n    var defaultOptions = {};\n    forin(getOptions(), function(key, value) {\n      defaultOptions[key] = value[0];\n    });\n\n    // set app options\n    var app = createApp(\n      Object.assign(\n        {},\n\n        defaultOptions,\n        {},\n\n        customOptions\n      )\n    );\n\n    // return the plugin instance\n    return app;\n  };\n\n  var lowerCaseFirstLetter = function lowerCaseFirstLetter(string) {\n    return string.charAt(0).toLowerCase() + string.slice(1);\n  };\n\n  var attributeNameToPropertyName = function attributeNameToPropertyName(\n    attributeName\n  ) {\n    return toCamels(attributeName.replace(/^data-/, ''));\n  };\n\n  var mapObject = function mapObject(object, propertyMap) {\n    // remove unwanted\n    forin(propertyMap, function(selector, mapping) {\n      forin(object, function(property, value) {\n        // create regexp shortcut\n        var selectorRegExp = new RegExp(selector);\n\n        // tests if\n        var matches = selectorRegExp.test(property);\n\n        // no match, skip\n        if (!matches) {\n          return;\n        }\n\n        // if there's a mapping, the original property is always removed\n        delete object[property];\n\n        // should only remove, we done!\n        if (mapping === false) {\n          return;\n        }\n\n        // move value to new property\n        if (isString(mapping)) {\n          object[mapping] = value;\n          return;\n        }\n\n        // move to group\n        var group = mapping.group;\n        if (isObject(mapping) && !object[group]) {\n          object[group] = {};\n        }\n\n        object[group][\n          lowerCaseFirstLetter(property.replace(selectorRegExp, ''))\n        ] = value;\n      });\n\n      // do submapping\n      if (mapping.mapping) {\n        mapObject(object[mapping.group], mapping.mapping);\n      }\n    });\n  };\n\n  var getAttributesAsObject = function getAttributesAsObject(node) {\n    var attributeMapping =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    // turn attributes into object\n    var attributes = [];\n    forin(node.attributes, function(index) {\n      attributes.push(node.attributes[index]);\n    });\n\n    var output = attributes\n      .filter(function(attribute) {\n        return attribute.name;\n      })\n      .reduce(function(obj, attribute) {\n        var value = attr(node, attribute.name);\n\n        obj[attributeNameToPropertyName(attribute.name)] =\n          value === attribute.name ? true : value;\n        return obj;\n      }, {});\n\n    // do mapping of object properties\n    mapObject(output, attributeMapping);\n\n    return output;\n  };\n\n  var createAppAtElement = function createAppAtElement(element) {\n    var options =\n      arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    // how attributes of the input element are mapped to the options for the plugin\n    var attributeMapping = {\n      // translate to other name\n      '^class$': 'className',\n      '^multiple$': 'allowMultiple',\n      '^capture$': 'captureMethod',\n\n      // group under single property\n      '^server': {\n        group: 'server',\n        mapping: {\n          '^process': {\n            group: 'process'\n          },\n\n          '^revert': {\n            group: 'revert'\n          },\n\n          '^fetch': {\n            group: 'fetch'\n          },\n\n          '^restore': {\n            group: 'restore'\n          },\n\n          '^load': {\n            group: 'load'\n          }\n        }\n      },\n\n      // don't include in object\n      '^type$': false,\n      '^files$': false\n    };\n\n    // add additional option translators\n    applyFilters('SET_ATTRIBUTE_TO_OPTION_MAP', attributeMapping);\n\n    // create final options object by setting options object and then overriding options supplied on element\n    var mergedOptions = Object.assign({}, options);\n\n    var attributeOptions = getAttributesAsObject(\n      element.nodeName === 'FIELDSET'\n        ? element.querySelector('input[type=file]')\n        : element,\n      attributeMapping\n    );\n\n    // merge with options object\n    Object.keys(attributeOptions).forEach(function(key) {\n      if (isObject(attributeOptions[key])) {\n        if (!isObject(mergedOptions[key])) {\n          mergedOptions[key] = {};\n        }\n        Object.assign(mergedOptions[key], attributeOptions[key]);\n      } else {\n        mergedOptions[key] = attributeOptions[key];\n      }\n    });\n\n    // if parent is a fieldset, get files from parent by selecting all input fields that are not file upload fields\n    // these will then be automatically set to the initial files\n    mergedOptions.files = (options.files || []).concat(\n      Array.from(element.querySelectorAll('input:not([type=file])')).map(\n        function(input) {\n          return {\n            source: input.value,\n            options: {\n              type: input.dataset.type\n            }\n          };\n        }\n      )\n    );\n\n    // build plugin\n    var app = createAppObject(mergedOptions);\n\n    // add already selected files\n    if (element.files) {\n      Array.from(element.files).forEach(function(file) {\n        app.addFile(file);\n      });\n    }\n\n    // replace the target element\n    app.replaceElement(element);\n\n    // expose\n    return app;\n  };\n\n  // if an element is passed, we create the instance at that element, if not, we just create an up object\n  var createApp$1 = function createApp() {\n    return isNode(arguments.length <= 0 ? undefined : arguments[0])\n      ? createAppAtElement.apply(void 0, arguments)\n      : createAppObject.apply(void 0, arguments);\n  };\n\n  var PRIVATE_METHODS = ['fire', '_read', '_write'];\n\n  var createAppAPI = function createAppAPI(app) {\n    var api = {};\n\n    copyObjectPropertiesToObject(app, api, PRIVATE_METHODS);\n\n    return api;\n  };\n\n  /**\n   * Replaces placeholders in given string with replacements\n   * @param string - \"Foo {bar}\"\"\n   * @param replacements - { \"bar\": 10 }\n   */\n  var replaceInString = function replaceInString(string, replacements) {\n    return string.replace(/(?:{([a-zA-Z]+)})/g, function(match, group) {\n      return replacements[group];\n    });\n  };\n\n  var createWorker = function createWorker(fn) {\n    var workerBlob = new Blob(['(', fn.toString(), ')()'], {\n      type: 'application/javascript'\n    });\n\n    var workerURL = URL.createObjectURL(workerBlob);\n    var worker = new Worker(workerURL);\n\n    return {\n      transfer: function transfer(message, cb) {},\n      post: function post(message, cb, transferList) {\n        var id = getUniqueId();\n\n        worker.onmessage = function(e) {\n          if (e.data.id === id) {\n            cb(e.data.message);\n          }\n        };\n\n        worker.postMessage(\n          {\n            id: id,\n            message: message\n          },\n\n          transferList\n        );\n      },\n      terminate: function terminate() {\n        worker.terminate();\n        URL.revokeObjectURL(workerURL);\n      }\n    };\n  };\n\n  var loadImage = function loadImage(url) {\n    return new Promise(function(resolve, reject) {\n      var img = new Image();\n      img.onload = function() {\n        resolve(img);\n      };\n      img.onerror = function(e) {\n        reject(e);\n      };\n      img.src = url;\n    });\n  };\n\n  var renameFile = function renameFile(file, name) {\n    var renamedFile = file.slice(0, file.size, file.type);\n    renamedFile.lastModifiedDate = file.lastModifiedDate;\n    renamedFile.name = name;\n    return renamedFile;\n  };\n\n  var copyFile = function copyFile(file) {\n    return renameFile(file, file.name);\n  };\n\n  // already registered plugins (can't register twice)\n  var registeredPlugins = [];\n\n  // pass utils to plugin\n  var createAppPlugin = function createAppPlugin(plugin) {\n    // already registered\n    if (registeredPlugins.includes(plugin)) {\n      return;\n    }\n\n    // remember this plugin\n    registeredPlugins.push(plugin);\n\n    // setup!\n    var pluginOutline = plugin({\n      addFilter: addFilter,\n      utils: {\n        Type: Type,\n        forin: forin,\n        isString: isString,\n        isFile: isFile,\n        toNaturalFileSize: toNaturalFileSize,\n        replaceInString: replaceInString,\n        getExtensionFromFilename: getExtensionFromFilename,\n        getFilenameWithoutExtension: getFilenameWithoutExtension,\n        guesstimateMimeType: guesstimateMimeType,\n        getFileFromBlob: getFileFromBlob,\n        getFilenameFromURL: getFilenameFromURL,\n        createRoute: createRoute,\n        createWorker: createWorker,\n        createView: createView,\n        createItemAPI: createItemAPI,\n        loadImage: loadImage,\n        copyFile: copyFile,\n        renameFile: renameFile,\n        createBlob: createBlob,\n        applyFilterChain: applyFilterChain,\n        text: text,\n        getNumericAspectRatioFromString: getNumericAspectRatioFromString\n      },\n\n      views: {\n        fileActionButton: fileActionButton\n      }\n    });\n\n    // add plugin options to default options\n    extendDefaultOptions(pluginOutline.options);\n  };\n\n  // feature detection used by supported() method\n  var isOperaMini = function isOperaMini() {\n    return (\n      Object.prototype.toString.call(window.operamini) === '[object OperaMini]'\n    );\n  };\n  var hasPromises = function hasPromises() {\n    return 'Promise' in window;\n  };\n  var hasBlobSlice = function hasBlobSlice() {\n    return 'slice' in Blob.prototype;\n  };\n  var hasCreateObjectURL = function hasCreateObjectURL() {\n    return 'URL' in window && 'createObjectURL' in window.URL;\n  };\n  var hasVisibility = function hasVisibility() {\n    return 'visibilityState' in document;\n  };\n  var hasTiming = function hasTiming() {\n    return 'performance' in window;\n  }; // iOS 8.x\n  var isBrowser = function isBrowser() {\n    return (\n      typeof window !== 'undefined' && typeof window.document !== 'undefined'\n    );\n  };\n\n  var supported = (function() {\n    // Runs immidiately and then remembers result for subsequent calls\n    var isSupported =\n      // Has to be a browser\n      isBrowser() &&\n      // Can't run on Opera Mini due to lack of everything\n      !isOperaMini() &&\n      // Require these APIs to feature detect a modern browser\n      hasVisibility() &&\n      hasPromises() &&\n      hasBlobSlice() &&\n      hasCreateObjectURL() &&\n      hasTiming();\n\n    return function() {\n      return isSupported;\n    };\n  })();\n\n  /**\n   * Plugin internal state (over all instances)\n   */\n  var state = {\n    // active app instances, used to redraw the apps and to find the later\n    apps: []\n  };\n\n  // plugin name\n  var name = 'filepond';\n\n  /**\n   * Public Plugin methods\n   */\n  var fn = function fn() {};\n  exports.Status = {};\n  exports.FileStatus = {};\n  exports.FileOrigin = {};\n  exports.OptionTypes = {};\n  exports.create = fn;\n  exports.destroy = fn;\n  exports.parse = fn;\n  exports.find = fn;\n  exports.registerPlugin = fn;\n  exports.getOptions = fn;\n  exports.setOptions = fn;\n\n  // if not supported, no API\n  if (supported()) {\n    // start painter and fire load event\n    createPainter(\n      function() {\n        state.apps.forEach(function(app) {\n          return app._read();\n        });\n      },\n      function(ts) {\n        state.apps.forEach(function(app) {\n          return app._write(ts);\n        });\n      }\n    );\n\n    // fire loaded event so we know when FilePond is available\n    var dispatch = function dispatch() {\n      // let others know we have area ready\n      document.dispatchEvent(\n        new CustomEvent('FilePond:loaded', {\n          detail: {\n            supported: supported,\n            create: exports.create,\n            destroy: exports.destroy,\n            parse: exports.parse,\n            find: exports.find,\n            registerPlugin: exports.registerPlugin,\n            setOptions: exports.setOptions\n          }\n        })\n      );\n\n      // clean up event\n      document.removeEventListener('DOMContentLoaded', dispatch);\n    };\n\n    if (document.readyState !== 'loading') {\n      // move to back of execution queue, FilePond should have been exported by then\n      setTimeout(function() {\n        return dispatch();\n      }, 0);\n    } else {\n      document.addEventListener('DOMContentLoaded', dispatch);\n    }\n\n    // updates the OptionTypes object based on the current options\n    var updateOptionTypes = function updateOptionTypes() {\n      return forin(getOptions(), function(key, value) {\n        exports.OptionTypes[key] = value[1];\n      });\n    };\n\n    exports.Status = Object.assign({}, Status);\n    exports.FileOrigin = Object.assign({}, FileOrigin);\n    exports.FileStatus = Object.assign({}, ItemStatus);\n\n    exports.OptionTypes = {};\n    updateOptionTypes();\n\n    // create method, creates apps and adds them to the app array\n    exports.create = function create() {\n      var app = createApp$1.apply(void 0, arguments);\n      app.on('destroy', exports.destroy);\n      state.apps.push(app);\n      return createAppAPI(app);\n    };\n\n    // destroys apps and removes them from the app array\n    exports.destroy = function destroy(hook) {\n      // returns true if the app was destroyed successfully\n      var indexToRemove = state.apps.findIndex(function(app) {\n        return app.isAttachedTo(hook);\n      });\n      if (indexToRemove >= 0) {\n        // remove from apps\n        var app = state.apps.splice(indexToRemove, 1)[0];\n\n        // restore original dom element\n        app.restoreElement();\n\n        return true;\n      }\n\n      return false;\n    };\n\n    // parses the given context for plugins (does not include the context element itself)\n    exports.parse = function parse(context) {\n      // get all possible hooks\n      var matchedHooks = Array.from(context.querySelectorAll('.' + name));\n\n      // filter out already active hooks\n      var newHooks = matchedHooks.filter(function(newHook) {\n        return !state.apps.find(function(app) {\n          return app.isAttachedTo(newHook);\n        });\n      });\n\n      // create new instance for each hook\n      return newHooks.map(function(hook) {\n        return exports.create(hook);\n      });\n    };\n\n    // returns an app based on the given element hook\n    exports.find = function find(hook) {\n      var app = state.apps.find(function(app) {\n        return app.isAttachedTo(hook);\n      });\n      if (!app) {\n        return null;\n      }\n      return createAppAPI(app);\n    };\n\n    // adds a plugin extension\n    exports.registerPlugin = function registerPlugin() {\n      for (\n        var _len = arguments.length, plugins = new Array(_len), _key = 0;\n        _key < _len;\n        _key++\n      ) {\n        plugins[_key] = arguments[_key];\n      }\n\n      // register plugins\n      plugins.forEach(createAppPlugin);\n\n      // update OptionTypes, each plugin might have extended the default options\n      updateOptionTypes();\n    };\n\n    exports.getOptions = function getOptions$1() {\n      var opts = {};\n      forin(getOptions(), function(key, value) {\n        opts[key] = value[0];\n      });\n      return opts;\n    };\n\n    exports.setOptions = function setOptions$1(opts) {\n      if (isObject(opts)) {\n        // update existing plugins\n        state.apps.forEach(function(app) {\n          app.setOptions(opts);\n        });\n\n        // override defaults\n        setOptions(opts);\n      }\n\n      // return new options\n      return exports.getOptions();\n    };\n  }\n\n  exports.supported = supported;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n});\n"]},"metadata":{},"sourceType":"script"}