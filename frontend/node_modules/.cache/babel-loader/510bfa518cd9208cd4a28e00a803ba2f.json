{"ast":null,"code":"var _jsxFileName = \"C:\\\\Workspace\\\\pycharmprojects\\\\Bulkemails\\\\frontend\\\\src\\\\views\\\\Base\\\\MultiMediaMessages\\\\MultiMediaMessages.js\";\nimport React, { Component } from 'react';\nimport { Button, Card, CardBody, CardFooter, CardHeader, Col, Form, FormGroup, Input, Label, Row } from 'reactstrap'; // Import React FilePond\n\nimport { FilePond, registerPlugin } from 'react-filepond'; // Import FilePond styles\n\nimport 'filepond/dist/filepond.min.css'; // Import the Image EXIF Orientation and Image Preview plugins\n// Note: These need to be installed separately\n\nimport FilePondPluginImageExifOrientation from 'filepond-plugin-image-exif-orientation';\nimport FilePondPluginImagePreview from 'filepond-plugin-image-preview';\nimport 'filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css';\nimport toaster from \"toasted-notes\";\nimport \"toasted-notes/src/styles.css\";\nimport { setOptions } from \"filepond\";\nimport { BASEURL } from '../../../Constants';\nregisterPlugin(FilePondPluginImagePreview, FilePondPluginImageExifOrientation);\n\nclass MultiMediaMessages extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      from_who: localStorage.getItem('phone'),\n      to_who: '',\n      message_status: '',\n      message: '',\n      submitted: false,\n      loading: false,\n      error: '',\n      tmpArray: []\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.clearForm = this.clearForm.bind(this);\n    setOptions({\n      server: {\n        url: BASEURL,\n        timeout: 7000,\n        process: {\n          url: 'mediaupload/fileupload/',\n          method: 'POST',\n          headers: {},\n          withCredentials: false,\n          onload: response => {\n            this.state.tmpArray.push(response);\n            console.log(response);\n            console.log(this.state.tmpArray);\n            this.checkandsend();\n          },\n          onerror: response => console.log(response.data) // ondata: (formData) => {\n          //     formData.append('Hello', 'World');\n          //     return formData;\n          // }\n\n        } // revert: './revert',\n        // restore: './restore/',\n        // load: './load/',\n        // fetch: './fetch/'\n\n      }\n    });\n  }\n\n  checkandsend() {\n    console.log(this.state.tmpArray + 'inside check and send');\n\n    if (this.state.submitted) {\n      let arraydata = this.state.tmpArray;\n\n      for (var i = 0; i <= arraydata.length; i++) {\n        var json_oject = JSON.parse(arraydata[i]);\n        this.Apicalling(json_oject);\n      }\n    }\n  }\n\n  Apicalling(json_oject) {\n    const {\n      to_who,\n      message\n    } = this.state;\n    let url = BASEURL + 'mediaupload/multimediamessages/';\n    const inputFiles = document.querySelectorAll('input[type=\"file\"]');\n    console.log(json_oject);\n    let formData = new FormData();\n\n    for (const file of inputFiles) {\n      formData.append('vcardfile', file.files[0]);\n    }\n\n    var fileName = json_oject.filepond;\n    console.log(fileName);\n    var body_url = fileName.substr(fileName.indexOf('/') + 1);\n    console.log(body_url);\n    formData.append('from_who', localStorage.getItem('phone'));\n    formData.append('phone', '91' + to_who);\n    formData.append('body', BASEURL + body_url); // formData.append('body', 'https://i.ibb.co/5vv5V8s/asunabg.png');\n\n    formData.append('filename', json_oject.filepond.split('/').pop());\n    formData.append('caption', message);\n    formData.append('content_type', 'image');\n    formData.append('sent_status', 'true');\n    fetch(url, {\n      method: \"POST\",\n      headers: {},\n      body: formData\n    }).then(response => {\n      if (response.status === 200) {\n        console.log(response);\n        toaster.notify(\"Successfull message sent\", {\n          duration: 2000,\n          type: \"success\"\n        });\n        this.clearForm();\n        return response.json();\n      } else {\n        console.log(\"oh no!\", response.status === 404);\n      }\n    }).then(function (data) {\n      console.log('request succeeded with JSON response', data);\n    });\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    const {\n      from_who = ['9391007969'],\n      to_who,\n      message_status,\n      submitted,\n      message\n    } = this.state; // stop here if form is invalid\n\n    if (!message) {\n      return;\n    }\n\n    this.setState({\n      submitted: true\n    });\n    console.log(to_who, message);\n    this.checkandsend();\n  }\n\n  clearForm() {\n    this.setState({\n      submitted: false\n    });\n    this.setState({\n      to_who: '',\n      message: ''\n    }); // <= here\n  }\n\n  handleChange(e) {\n    const {\n      name,\n      value\n    } = e.target;\n    this.setState({\n      [name]: value\n    });\n  }\n\n  render() {\n    const {\n      from_who,\n      to_who,\n      message_status,\n      submitted,\n      message\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"animated fadeIn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      xs: \"12\",\n      md: \"12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(CardHeader, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 33\n      }\n    }, \"Multi Media Message\"), \" Whatsapp\"), /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(Form, {\n      action: \"\",\n      method: \"post\",\n      encType: \"multipart/form-data\",\n      className: \"form-horizontal\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      row: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 45\n      }\n    }, \"From \")), /*#__PURE__*/React.createElement(Col, {\n      xs: \"12\",\n      md: \"9\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"form-control-static\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 80\n      }\n    }, localStorage.getItem('phone'))))), /*#__PURE__*/React.createElement(FormGroup, {\n      row: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      htmlFor: \"file-input\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 45\n      }\n    }, \"Vcard \")), /*#__PURE__*/React.createElement(Col, {\n      xs: \"12\",\n      md: \"9\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(Input, {\n      type: \"file\",\n      id: \"file-input\",\n      accept: \".csv\",\n      name: \"vcardfile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 45\n      }\n    }), /*#__PURE__*/React.createElement(\"a\", {\n      href: BASEURL + 'media/samplecsv/excel.csv',\n      download: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 43\n      }\n    }, \"Click to download samplecsv\"))), /*#__PURE__*/React.createElement(FormGroup, {\n      row: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      htmlFor: \"file-multiple-input\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 45\n      }\n    }, \"Multiple File input\")), /*#__PURE__*/React.createElement(Col, {\n      xs: \"12\",\n      md: \"9\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(FilePond, {\n      allowMultiple: true,\n      maxFiles: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 45\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 45\n      }\n    }, \"Max Files:\", /*#__PURE__*/React.createElement(\"strong\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 58\n      }\n    }, \"3\")))), /*#__PURE__*/React.createElement(FormGroup, {\n      row: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(Label, {\n      htmlFor: \"textarea-input\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 45\n      }\n    }, \"Message\")), /*#__PURE__*/React.createElement(Col, {\n      xs: \"12\",\n      md: \"9\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(Input, {\n      type: \"textarea\",\n      name: \"message\",\n      id: \"textarea-input\",\n      rows: \"9\",\n      value: message,\n      onChange: this.handleChange,\n      placeholder: \"Message Content...\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 45\n      }\n    }), submitted && !message && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"help-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 45\n      }\n    }, \"Text under the file\"))))), /*#__PURE__*/React.createElement(CardFooter, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      type: \"submit\",\n      size: \"sm\",\n      color: \"primary\",\n      onClick: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fa fa-dot-circle-o\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 109\n      }\n    }), \" Submit\"), /*#__PURE__*/React.createElement(Button, {\n      type: \"reset\",\n      size: \"sm\",\n      color: \"danger\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fa fa-ban\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 79\n      }\n    }), \" Reset\"))))));\n  }\n\n}\n\nexport default MultiMediaMessages;","map":{"version":3,"sources":["C:/Workspace/pycharmprojects/Bulkemails/frontend/src/views/Base/MultiMediaMessages/MultiMediaMessages.js"],"names":["React","Component","Button","Card","CardBody","CardFooter","CardHeader","Col","Form","FormGroup","Input","Label","Row","FilePond","registerPlugin","FilePondPluginImageExifOrientation","FilePondPluginImagePreview","toaster","setOptions","BASEURL","MultiMediaMessages","constructor","props","state","from_who","localStorage","getItem","to_who","message_status","message","submitted","loading","error","tmpArray","handleChange","bind","handleSubmit","clearForm","server","url","timeout","process","method","headers","withCredentials","onload","response","push","console","log","checkandsend","onerror","data","arraydata","i","length","json_oject","JSON","parse","Apicalling","inputFiles","document","querySelectorAll","formData","FormData","file","append","files","fileName","filepond","body_url","substr","indexOf","split","pop","fetch","body","then","status","notify","duration","type","json","e","preventDefault","setState","name","value","target","render"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {\r\n    Button,\r\n    Card,\r\n    CardBody,\r\n    CardFooter,\r\n    CardHeader,\r\n    Col,\r\n    Form,\r\n    FormGroup,\r\n    Input,\r\n    Label,\r\n    Row,\r\n} from 'reactstrap';\r\n// Import React FilePond\r\nimport {FilePond, registerPlugin} from 'react-filepond';\r\n\r\n// Import FilePond styles\r\nimport 'filepond/dist/filepond.min.css';\r\n// Import the Image EXIF Orientation and Image Preview plugins\r\n// Note: These need to be installed separately\r\nimport FilePondPluginImageExifOrientation from 'filepond-plugin-image-exif-orientation';\r\nimport FilePondPluginImagePreview from 'filepond-plugin-image-preview';\r\nimport 'filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css';\r\n\r\nimport toaster from \"toasted-notes\";\r\nimport \"toasted-notes/src/styles.css\";\r\nimport {setOptions} from \"filepond\";\r\nimport {BASEURL} from '../../../Constants'\r\n\r\nregisterPlugin(FilePondPluginImagePreview, FilePondPluginImageExifOrientation);\r\n\r\nclass MultiMediaMessages extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            from_who: localStorage.getItem('phone'),\r\n            to_who: '',\r\n            message_status: '',\r\n            message: '',\r\n            submitted: false,\r\n            loading: false,\r\n            error: '',\r\n            tmpArray: []\r\n        };\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n        this.clearForm = this.clearForm.bind(this);\r\n        setOptions({\r\n            server: {\r\n                url: BASEURL,\r\n                timeout: 7000,\r\n                process: {\r\n                    url: 'mediaupload/fileupload/',\r\n                    method: 'POST',\r\n                    headers: {},\r\n                    withCredentials: false,\r\n                    onload: (response) => {\r\n                        this.state.tmpArray.push(response);\r\n                        console.log(response);\r\n                        console.log(this.state.tmpArray);\r\n                        this.checkandsend()\r\n                    },\r\n                    onerror: (response) => console.log(response.data),\r\n                    // ondata: (formData) => {\r\n                    //     formData.append('Hello', 'World');\r\n                    //     return formData;\r\n                    // }\r\n                },\r\n                // revert: './revert',\r\n                // restore: './restore/',\r\n                // load: './load/',\r\n                // fetch: './fetch/'\r\n            }\r\n        });\r\n    }\r\n\r\n    checkandsend() {\r\n        console.log(this.state.tmpArray + 'inside check and send');\r\n        if (this.state.submitted) {\r\n            let arraydata = this.state.tmpArray\r\n            for (var i = 0; i <= arraydata.length; i++) {\r\n                var json_oject = JSON.parse(arraydata[i])\r\n                this.Apicalling(json_oject);\r\n            }\r\n        }\r\n    }\r\n\r\n    Apicalling(json_oject) {\r\n        const {to_who, message} = this.state;\r\n\r\n        let url = BASEURL + 'mediaupload/multimediamessages/';\r\n        const inputFiles = document.querySelectorAll('input[type=\"file\"]');\r\n\r\n        console.log(json_oject)\r\n        let formData = new FormData();\r\n        for (const file of inputFiles) {\r\n            formData.append('vcardfile', file.files[0]);\r\n        }\r\n        var fileName = json_oject.filepond;\r\n        console.log(fileName);\r\n        var body_url = fileName.substr(fileName.indexOf('/') + 1);\r\n        console.log(body_url);\r\n        formData.append('from_who', localStorage.getItem('phone'));\r\n        formData.append('phone', '91' + to_who);\r\n        formData.append('body', BASEURL + body_url);\r\n        // formData.append('body', 'https://i.ibb.co/5vv5V8s/asunabg.png');\r\n        formData.append('filename', json_oject.filepond.split('/').pop());\r\n        formData.append('caption', message);\r\n        formData.append('content_type', 'image');\r\n        formData.append('sent_status', 'true');\r\n\r\n        fetch(url, {\r\n            method: \"POST\",\r\n            headers: ({}),\r\n            body: formData\r\n        }).then(response => {\r\n            if (response.status === 200) {\r\n                console.log(response);\r\n                toaster.notify(\"Successfull message sent\", {\r\n                    duration: 2000, type: \"success\"\r\n                });\r\n                this.clearForm();\r\n                return response.json()\r\n            } else {\r\n                console.log(\"oh no!\", response.status === 404)\r\n            }\r\n        }).then(function (data) {\r\n            console.log('request succeeded with JSON response', data)\r\n        })\r\n    }\r\n\r\n    handleSubmit(e) {\r\n        e.preventDefault();\r\n\t     const {from_who = ['9391007969'], to_who, message_status, submitted, message} = this.state;\r\n        // stop here if form is invalid\r\n        if (!(message)) {\r\n            return;\r\n        }\r\n        this.setState({submitted: true});\r\n        console.log(to_who, message);\r\n        this.checkandsend();\r\n    }\r\n\r\n    clearForm() {\r\n        this.setState({submitted: false});\r\n        this.setState({to_who: '', message: ''}) // <= here\r\n\r\n    }\r\n\r\n    handleChange(e) {\r\n        const {name, value} = e.target;\r\n        this.setState({[name]: value});\r\n    }\r\n\r\n    render() {\r\n        const {from_who, to_who, message_status, submitted, message} = this.state;\r\n        return (\r\n            <div className=\"animated fadeIn\">\r\n                <Row>\r\n                    <Col xs=\"12\" md=\"12\">\r\n                        <Card>\r\n                            <CardHeader>\r\n                                <strong>Multi Media Message</strong> Whatsapp\r\n                            </CardHeader>\r\n                            <CardBody>\r\n                                <Form action=\"\" method=\"post\" encType=\"multipart/form-data\" className=\"form-horizontal\">\r\n                                    <FormGroup row>\r\n                                        <Col md=\"3\">\r\n                                            <Label>From </Label>\r\n                                        </Col>\r\n                                        <Col xs=\"12\" md=\"9\">\r\n                                            <p className=\"form-control-static\"><strong>{localStorage.getItem('phone')}</strong></p>\r\n                                        </Col>\r\n                                    </FormGroup>\r\n                                    <FormGroup row>\r\n                                        <Col md=\"3\">\r\n                                            <Label htmlFor=\"file-input\">Vcard </Label>\r\n                                        </Col>\r\n                                        <Col xs=\"12\" md=\"9\">\r\n                                            <Input type=\"file\" id=\"file-input\" accept=\".csv\" name=\"vcardfile\"/>\r\n                                          <a href={BASEURL + 'media/samplecsv/excel.csv'} download>Click to download\r\n                                            samplecsv</a>\r\n                                        </Col>\r\n                                    </FormGroup>\r\n                                    <FormGroup row>\r\n                                        <Col md=\"3\">\r\n                                            <Label htmlFor=\"file-multiple-input\">Multiple File input</Label>\r\n                                        </Col>\r\n                                        <Col xs=\"12\" md=\"9\">\r\n                                            {/*<Input type=\"file\" id=\"file-multiple-input\" name=\"file-multiple-input\"*/}\r\n                                            {/*       multiple/>*/}\r\n                                            <FilePond allowMultiple={true} maxFiles={3}/>\r\n                                            <p>Max Files:<strong>3</strong></p>\r\n                                        </Col>\r\n                                    </FormGroup>\r\n                                    <FormGroup row>\r\n                                        <Col md=\"3\">\r\n                                            <Label htmlFor=\"textarea-input\">Message</Label>\r\n                                        </Col>\r\n                                        <Col xs=\"12\" md=\"9\">\r\n                                            <Input type=\"textarea\" name=\"message\" id=\"textarea-input\" rows=\"9\"\r\n                                                   value={message} onChange={this.handleChange}\r\n                                                   placeholder=\"Message Content...\"/>\r\n                                            {submitted && !message &&\r\n                                            <div className=\"help-block\">Text under the file</div>\r\n                                            }\r\n                                        </Col>\r\n                                    </FormGroup>\r\n\r\n\r\n                                </Form>\r\n                            </CardBody>\r\n                            <CardFooter>\r\n                                <Button type=\"submit\" size=\"sm\" color=\"primary\" onClick={this.handleSubmit}><i\r\n                                    className=\"fa fa-dot-circle-o\"></i> Submit</Button>\r\n                                <Button type=\"reset\" size=\"sm\" color=\"danger\"><i\r\n                                    className=\"fa fa-ban\"></i> Reset</Button>\r\n                            </CardFooter>\r\n                        </Card>\r\n                    </Col>\r\n                </Row>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default MultiMediaMessages;\r\n"]},"metadata":{},"sourceType":"module"}