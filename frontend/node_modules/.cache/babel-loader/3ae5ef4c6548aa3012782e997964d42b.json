{"ast":null,"code":"var _jsxFileName = \"C:\\\\Workspace\\\\pycharmprojects\\\\Bulkemails\\\\frontend\\\\src\\\\views\\\\Pages\\\\Login\\\\Login.js\";\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport toaster from \"toasted-notes\";\nimport \"toasted-notes/src/styles.css\";\nimport { Button, Card, CardBody, CardGroup, Col, Container, Form, Input, InputGroup, InputGroupAddon, InputGroupText, Row } from 'reactstrap';\nimport { BASEURL } from \"../../../Constants\";\n\nclass Login extends Component {\n  constructor() {\n    super();\n    this.state = {\n      username: '',\n      password: '',\n      submitted: false,\n      loading: false,\n      error: ''\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this); // this.userprofilesavingtolocalstorage = this.userprofilesavingtolocalstorage.bind(this);\n  }\n\n  handleChange(e) {\n    const {\n      name,\n      value\n    } = e.target;\n    this.setState({\n      [name]: value\n    });\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n    let currentComponent = this;\n    this.setState({\n      submitted: true\n    });\n    const {\n      username,\n      password,\n      returnUrl\n    } = this.state; // stop here if form is invalid\n\n    if (!(username && password)) {\n      return;\n    }\n\n    console.log(username, password);\n    this.setState({\n      loading: true\n    });\n    let url = BASEURL + 'api/signin/';\n    fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Accept\": \"application/json\",\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        email: username,\n        password: password\n      })\n    }).then(response => {\n      if (response.status === 200) {\n        toaster.notify(\"Sucessfull logged in\", {\n          duration: 2000,\n          type: \"success\"\n        });\n        this.props.history.push('/dashboard');\n        return response.json();\n      } else if (response.status === 400) {\n        toaster.notify(\"failed login\", {\n          duration: 2000,\n          type: \"error\"\n        });\n      } else {\n        toaster.notify(\"server error\", {\n          duration: 2000,\n          type: \"error\"\n        });\n      }\n    }).then(function (data) {\n      if (data != null) {\n        localStorage.setItem(\"token\", data.token);\n        currentComponent.userprofilesavingtolocalstorage(data.token);\n      }\n\n      console.log('request succeeded with JSON response', data);\n    });\n  }\n\n  userprofilesavingtolocalstorage(token) {\n    let currentComponent = this;\n    console.log(token);\n    let url = BASEURL + 'api/profile/';\n    fetch(url, {\n      method: \"GET\",\n      headers: {\n        \"Accept\": \"application/json\",\n        \"Authorization\": 'Bearer ' + token,\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(response => {\n      if (response.status === 200) {\n        // toaster.notify(\"Sucessfull logged in\", {\n        //     duration: 2000, type: \"success\"\n        // });\n        return response.json();\n      } else if (response.status === 400) {// toaster.notify(\"failed login\", {\n        //     duration: 2000, type: \"error\"\n        // });\n      } else {\n        toaster.notify(\"server error\", {\n          duration: 2000,\n          type: \"error\"\n        });\n      }\n    }).then(function (data) {\n      // if (data != null) {\n      //     localStorage.setItem(\"token\", data.token);\n      // }\n      if (data != null) {\n        // localStorage.setItem(\"fullname\", data.fullname);\n        // localStorage.setItem(\"username\", data.username);\n        // localStorage.setItem(\"email\", data.email);\n        // localStorage.setItem(\"phone\", data.phone);\n        // localStorage.setItem(\"lastlogin\", data.lastlogin);\n        localStorage.setItem(\"id\", data.data[0].id);\n        localStorage.setItem(\"gender\", data.data[0].gender);\n        localStorage.setItem(\"fullname\", data.data[0].first_name + data.data[0].last_name);\n        localStorage.setItem(\"username\", data.data[0].email);\n        localStorage.setItem(\"email\", data.data[0].email);\n        localStorage.setItem(\"phone\", data.data[0].phone_number);\n        localStorage.setItem(\"lastlogin\", data.data[0].last_login_date_time);\n      }\n\n      console.log('request succeeded with JSON response', data.data[0]);\n    });\n  }\n\n  render() {\n    const {\n      username,\n      password,\n      submitted,\n      loading,\n      error\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"app flex-row align-items-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Container, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      className: \"justify-content-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: \"8\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(CardGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      className: \"p-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(Form, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 45\n      }\n    }, \"Login\"), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"text-muted\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 45\n      }\n    }, \"Sign In to your account\"), /*#__PURE__*/React.createElement(InputGroup, {\n      className: \"mb-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(InputGroupAddon, {\n      addonType: \"prepend\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 49\n      }\n    }, /*#__PURE__*/React.createElement(InputGroupText, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 53\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"icon-user\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 57\n      }\n    }))), /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      placeholder: \"Email\",\n      autoComplete: \"username\",\n      name: \"username\",\n      value: username,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 49\n      }\n    }), submitted && !username && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"help-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 49\n      }\n    }, \"email is required\")), /*#__PURE__*/React.createElement(InputGroup, {\n      className: \"mb-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(InputGroupAddon, {\n      addonType: \"prepend\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 49\n      }\n    }, /*#__PURE__*/React.createElement(InputGroupText, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 53\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"icon-lock\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 57\n      }\n    }))), /*#__PURE__*/React.createElement(Input, {\n      type: \"password\",\n      placeholder: \"Password\",\n      autoComplete: \"current-password\",\n      name: \"password\",\n      value: password,\n      onChange: this.handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 49\n      }\n    }), submitted && !password && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"help-block\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 49\n      }\n    }, \"Password is required\")), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      xs: \"6\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 49\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      color: \"primary\",\n      className: \"px-4\",\n      onClick: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 53\n      }\n    }, \"Login\")))))), /*#__PURE__*/React.createElement(Card, {\n      className: \"text-white bg-primary py-5 d-md-down-none\",\n      style: {\n        width: '44%'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      className: \"text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 41\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 45\n      }\n    }, \"Register\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 45\n      }\n    }, \"Register the account with all details to get the server\"), /*#__PURE__*/React.createElement(Link, {\n      to: \"/register\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      color: \"primary\",\n      className: \"mt-3\",\n      active: true,\n      tabIndex: -1,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 49\n      }\n    }, \"Register Now!\"))))))))));\n  }\n\n}\n\nexport default Login;","map":{"version":3,"sources":["C:/Workspace/pycharmprojects/Bulkemails/frontend/src/views/Pages/Login/Login.js"],"names":["React","Component","Link","toaster","Button","Card","CardBody","CardGroup","Col","Container","Form","Input","InputGroup","InputGroupAddon","InputGroupText","Row","BASEURL","Login","constructor","state","username","password","submitted","loading","error","handleChange","bind","handleSubmit","e","name","value","target","setState","preventDefault","currentComponent","returnUrl","console","log","url","fetch","method","headers","body","JSON","stringify","email","then","response","status","notify","duration","type","props","history","push","json","data","localStorage","setItem","token","userprofilesavingtolocalstorage","id","gender","first_name","last_name","phone_number","last_login_date_time","render","width"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {Link} from 'react-router-dom';\r\nimport toaster from \"toasted-notes\";\r\nimport \"toasted-notes/src/styles.css\";\r\nimport {\r\n    Button,\r\n    Card,\r\n    CardBody,\r\n    CardGroup,\r\n    Col,\r\n    Container,\r\n    Form,\r\n    Input,\r\n    InputGroup,\r\n    InputGroupAddon,\r\n    InputGroupText,\r\n    Row\r\n} from 'reactstrap';\r\nimport {BASEURL} from \"../../../Constants\";\r\n\r\nclass Login extends Component {\r\n    constructor() {\r\n\r\n        super();\r\n        this.state = {\r\n            username: '',\r\n            password: '',\r\n            submitted: false,\r\n            loading: false,\r\n            error: ''\r\n        };\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n        // this.userprofilesavingtolocalstorage = this.userprofilesavingtolocalstorage.bind(this);\r\n    }\r\n\r\n\r\n    handleChange(e) {\r\n        const {name, value} = e.target;\r\n        this.setState({[name]: value});\r\n    }\r\n\r\n    handleSubmit(e) {\r\n        e.preventDefault();\r\n        let currentComponent = this;\r\n        this.setState({submitted: true});\r\n        const {username, password, returnUrl} = this.state;\r\n\r\n        // stop here if form is invalid\r\n        if (!(username && password)) {\r\n            return;\r\n        }\r\n        console.log(username, password);\r\n\r\n        this.setState({loading: true});\r\n\r\n        let url = BASEURL + 'api/signin/';\r\n\r\n        fetch(url, {\r\n            method: \"POST\",\r\n            headers: ({\r\n                \"Accept\": \"application/json\",\r\n                \"Content-Type\": \"application/json\"\r\n            }),\r\n            body: JSON.stringify({\r\n                email: username,\r\n                password: password\r\n            })\r\n        }).then(response => {\r\n            if (response.status === 200) {\r\n                toaster.notify(\"Sucessfull logged in\", {\r\n                    duration: 2000, type: \"success\"\r\n                });\r\n                this.props.history.push('/dashboard');\r\n                return response.json()\r\n            } else if (response.status === 400) {\r\n                toaster.notify(\"failed login\", {\r\n                    duration: 2000, type: \"error\"\r\n                });\r\n            } else {\r\n                toaster.notify(\"server error\", {\r\n                    duration: 2000, type: \"error\"\r\n                });\r\n            }\r\n        }).then(function (data) {\r\n            if (data != null) {\r\n                localStorage.setItem(\"token\", data.token);\r\n                currentComponent.userprofilesavingtolocalstorage(data.token);\r\n            }\r\n            console.log('request succeeded with JSON response', data)\r\n        })\r\n    }\r\n\r\n    userprofilesavingtolocalstorage(token) {\r\n        let currentComponent = this;\r\n        console.log(token);\r\n        let url = BASEURL + 'api/profile/';\r\n        fetch(url, {\r\n            method: \"GET\",\r\n            headers: ({\r\n                \"Accept\": \"application/json\",\r\n                \"Authorization\": 'Bearer ' + token,\r\n                \"Content-Type\": \"application/json\"\r\n            })\r\n        }).then(response => {\r\n            if (response.status === 200) {\r\n                // toaster.notify(\"Sucessfull logged in\", {\r\n                //     duration: 2000, type: \"success\"\r\n                // });\r\n                return response.json()\r\n            } else if (response.status === 400) {\r\n                // toaster.notify(\"failed login\", {\r\n                //     duration: 2000, type: \"error\"\r\n                // });\r\n            } else {\r\n                toaster.notify(\"server error\", {\r\n                    duration: 2000, type: \"error\"\r\n                });\r\n            }\r\n        }).then(function (data) {\r\n            // if (data != null) {\r\n            //     localStorage.setItem(\"token\", data.token);\r\n            // }\r\n            if (data != null) {\r\n                // localStorage.setItem(\"fullname\", data.fullname);\r\n                // localStorage.setItem(\"username\", data.username);\r\n                // localStorage.setItem(\"email\", data.email);\r\n                // localStorage.setItem(\"phone\", data.phone);\r\n                // localStorage.setItem(\"lastlogin\", data.lastlogin);\r\n\r\n                localStorage.setItem(\"id\", data.data[0].id);\r\n                localStorage.setItem(\"gender\", data.data[0].gender);\r\n                localStorage.setItem(\"fullname\", data.data[0].first_name + data.data[0].last_name);\r\n                localStorage.setItem(\"username\", data.data[0].email);\r\n                localStorage.setItem(\"email\", data.data[0].email);\r\n                localStorage.setItem(\"phone\", data.data[0].phone_number);\r\n                localStorage.setItem(\"lastlogin\", data.data[0].last_login_date_time);\r\n            }\r\n\r\n            console.log('request succeeded with JSON response', data.data[0])\r\n        })\r\n    }\r\n\r\n    render() {\r\n        const {username, password, submitted, loading, error} = this.state;\r\n        return (\r\n            <div className=\"app flex-row align-items-center\">\r\n                <Container>\r\n                    <Row className=\"justify-content-center\">\r\n                        <Col md=\"8\">\r\n                            <CardGroup>\r\n                                <Card className=\"p-4\">\r\n                                    <CardBody>\r\n                                        <Form>\r\n                                            <h1>Login</h1>\r\n                                            <p className=\"text-muted\">Sign In to your account</p>\r\n                                            <InputGroup className=\"mb-3\">\r\n                                                <InputGroupAddon addonType=\"prepend\">\r\n                                                    <InputGroupText>\r\n                                                        <i className=\"icon-user\"></i>\r\n                                                    </InputGroupText>\r\n                                                </InputGroupAddon>\r\n                                                <Input type=\"text\" placeholder=\"Email\" autoComplete=\"username\"\r\n                                                       name=\"username\" value={username} onChange={this.handleChange}/>\r\n                                                {submitted && !username &&\r\n                                                <div className=\"help-block\">email is required</div>\r\n                                                }\r\n                                            </InputGroup>\r\n                                            <InputGroup className=\"mb-4\">\r\n                                                <InputGroupAddon addonType=\"prepend\">\r\n                                                    <InputGroupText>\r\n                                                        <i className=\"icon-lock\"></i>\r\n                                                    </InputGroupText>\r\n                                                </InputGroupAddon>\r\n                                                <Input type=\"password\" placeholder=\"Password\"\r\n                                                       autoComplete=\"current-password\" name=\"password\" value={password}\r\n                                                       onChange={this.handleChange}/>\r\n                                                {submitted && !password &&\r\n                                                <div className=\"help-block\">Password is required</div>\r\n                                                }\r\n                                            </InputGroup>\r\n                                            <Row>\r\n                                                <Col xs=\"6\">\r\n                                                    <Button color=\"primary\" className=\"px-4\"\r\n                                                            onClick={this.handleSubmit}>Login</Button>\r\n                                                </Col>\r\n                                                {/*<Col xs=\"6\" className=\"text-right\">*/}\r\n                                                {/*    <Button color=\"link\" className=\"px-0\">Forgot password?</Button>*/}\r\n                                                {/*</Col>*/}\r\n                                            </Row>\r\n                                        </Form>\r\n                                    </CardBody>\r\n                                </Card>\r\n                                <Card className=\"text-white bg-primary py-5 d-md-down-none\" style={{width: '44%'}}>\r\n                                    <CardBody className=\"text-center\">\r\n                                        <div>\r\n                                            <h2>Register</h2>\r\n                                            <p>Register the account with all details to get the server</p>\r\n                                            <Link to=\"/register\">\r\n                                                <Button color=\"primary\" className=\"mt-3\" active tabIndex={-1}>Register\r\n                                                    Now!</Button>\r\n                                            </Link>\r\n                                        </div>\r\n                                    </CardBody>\r\n                                </Card>\r\n                            </CardGroup>\r\n                        </Col>\r\n                    </Row>\r\n                </Container>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}